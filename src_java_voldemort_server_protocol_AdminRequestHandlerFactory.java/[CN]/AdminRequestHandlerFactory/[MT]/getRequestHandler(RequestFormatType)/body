{
switch (type) {
case ADMIN_PROTOCOL_BUFFERS:
    return new ProtoBuffAdminServiceRequestHandler(new ErrorCodeMapper(),repository,metadata,voldemortConfig.getStreamMaxReadBytesPerSec(),voldemortConfig.getStreamMaxWriteBytesPerSec());
default :
  throw new VoldemortException("Unknown wire format " + type);
}
}
