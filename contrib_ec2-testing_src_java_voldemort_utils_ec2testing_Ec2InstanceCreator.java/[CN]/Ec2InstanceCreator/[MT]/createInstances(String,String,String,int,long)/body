{
  List<String> instanceIds=launch(ami,keypairId,instanceSize,instanceCount);
  Map<String,String> hostNameMap=new HashMap<String,String>();
  long startTime=System.currentTimeMillis();
  while (!instanceIds.isEmpty()) {
    waitForInstances(instanceIds,hostNameMap);
    if (instanceIds.isEmpty())     break;
    try {
      if (logger.isInfoEnabled())       logger.info("Sleeping for 30 seconds...");
      Thread.sleep(30000);
    }
 catch (    InterruptedException e) {
      break;
    }
    if (System.currentTimeMillis() > (startTime + timeout)) {
      throw new Error("Rollback creation NYI");
    }
  }
  return hostNameMap;
}
