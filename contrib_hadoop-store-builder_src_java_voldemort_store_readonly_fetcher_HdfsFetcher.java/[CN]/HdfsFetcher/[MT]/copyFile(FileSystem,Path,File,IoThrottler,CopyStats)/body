{
  logger.info("Starting copy of " + source + " to "+ dest);
  FSDataInputStream input=null;
  OutputStream output=null;
  try {
    input=fs.open(source);
    output=new FileOutputStream(dest);
    byte[] buffer=new byte[BUFFER_SIZE];
    while (true) {
      int read=input.read(buffer);
      if (read < 0)       break;
      output.write(buffer,0,read);
      if (throttler != null)       throttler.maybeThrottle(read);
      stats.recordBytes(read);
      if (stats.getBytesSinceLastReport() > REPORTING_INTERVAL_BYTES) {
        logger.info(stats.getBytesCopied() / (1024 * 1024) + " MB copied");
        stats.resetBytesSinceLastReport();
      }
    }
    logger.info("Completed copy of " + source + " to "+ dest);
  }
  finally {
    IOUtils.closeQuietly(output);
    IOUtils.closeQuietly(input);
  }
}
