{
  final Configuration config=getConfiguration(sourceFileUrl,hadoopConfigPath);
  final Path path=new Path(sourceFileUrl);
  FileSystem fs=null;
  for (int attempt=1; attempt <= maxAttempts; attempt++) {
    try {
      if (HdfsFetcher.keytabPath.length() > 0) {
synchronized (HdfsFetcher.class) {
          if (currentHadoopUser == null) {
            if (!new File(HdfsFetcher.keytabPath).exists()) {
              logger.error("Invalid keytab file path. Please provide a valid keytab path");
              throw new VoldemortException("Error in getting Hadoop filesystem. Invalid keytab file path.");
            }
            UserGroupInformation.setConfiguration(config);
            UserGroupInformation.loginUserFromKeytab(HdfsFetcher.kerberosPrincipal,HdfsFetcher.keytabPath);
            currentHadoopUser=UserGroupInformation.getCurrentUser();
            logger.info("I have logged in as " + currentHadoopUser.getUserName());
          }
 else {
            currentHadoopUser.reloginFromKeytab();
          }
        }
      }
      fs=path.getFileSystem(config);
      fs.exists(path);
      break;
    }
 catch (    VoldemortException e) {
      throw e;
    }
catch (    Exception e) {
      if (ExceptionUtils.recursiveClassEquals(e,AuthenticationException.class)) {
        logger.info("Got an AuthenticationException from HDFS. " + "Will retry to login from scratch, on next attempt.",e);
synchronized (HdfsFetcher.class) {
          currentHadoopUser=null;
        }
      }
      if (attempt < maxAttempts) {
        sleepForRetryDelayMs(attempt);
      }
 else {
        throw e;
      }
    }
  }
  return fs;
}
