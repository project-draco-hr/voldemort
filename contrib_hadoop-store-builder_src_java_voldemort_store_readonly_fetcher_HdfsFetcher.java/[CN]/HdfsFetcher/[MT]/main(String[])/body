{
  if (args.length != 1)   Utils.croak("USAGE: java " + HdfsFetcher.class.getName() + " url");
  String url=args[0];
  long maxBytesPerSec=1024 * 1024 * 1024;
  Path p=new Path(url);
  Configuration config=new Configuration();
  config.setInt("io.file.buffer.size",DEFAULT_BUFFER_SIZE);
  config.set("hadoop.rpc.socket.factory.class.ClientProtocol",ConfigurableSocketFactory.class.getName());
  config.setInt("io.socket.receive.buffer",1 * 1024 * 1024 - 10000);
  FileStatus status=p.getFileSystem(config).getFileStatus(p);
  long size=status.getLen();
  HdfsFetcher fetcher=new HdfsFetcher(maxBytesPerSec,REPORTING_INTERVAL_BYTES,DEFAULT_BUFFER_SIZE);
  long start=System.currentTimeMillis();
  File location=fetcher.fetch(url,System.getProperty("java.io.tmpdir") + File.separator + start);
  double rate=size * Time.MS_PER_SECOND / (double)(System.currentTimeMillis() - start);
  NumberFormat nf=NumberFormat.getInstance();
  nf.setMaximumFractionDigits(2);
  System.out.println("Fetch to " + location + " completed: "+ nf.format(rate / (1024.0 * 1024.0))+ " MB/sec.");
}
