{
  FetchStrategy fetchStrategy=new BasicFetchStrategy(this,fs,stats,status,bufferSize);
  if (!fs.isFile(source)) {
    Utils.mkdirs(dest);
    HdfsDirectory directory=new HdfsDirectory(fs,source);
    HdfsFile metadataFile=directory.getMetadataFile();
    if (metadataFile != null) {
      File copyLocation=new File(dest,metadataFile.getPath().getName());
      fetchStrategy.fetch(metadataFile,copyLocation,null);
      directory.initializeMetadata(copyLocation);
    }
    Map<HdfsFile,byte[]> fileCheckSumMap=fetchStrategy.fetch(directory,dest);
    return directory.validateCheckSum(fileCheckSumMap);
  }
 else   if (allowFetchOfFiles) {
    Utils.mkdirs(dest);
    HdfsFile file=new HdfsFile(fs.getFileStatus(source));
    String fileName=file.getDiskFileName();
    File copyLocation=new File(dest,fileName);
    fetchStrategy.fetch(file,copyLocation,CheckSumType.NONE);
    return true;
  }
  logger.error("Source " + source.toString() + " should be a directory");
  return false;
}
