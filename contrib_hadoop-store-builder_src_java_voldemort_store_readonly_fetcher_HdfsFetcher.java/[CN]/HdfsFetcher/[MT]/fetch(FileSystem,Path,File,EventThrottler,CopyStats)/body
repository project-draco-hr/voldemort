{
  if (!fs.isFile(source)) {
    dest.mkdirs();
    FileStatus[] statuses=fs.listStatus(source);
    if (statuses != null) {
      Arrays.sort(statuses,new IndexFileLastComparator());
      byte[] origMD5=new byte[16];
      boolean containsCheckSumFile=false;
      MessageDigest checkSumGenerator=null;
      try {
        checkSumGenerator=MessageDigest.getInstance("md5");
      }
 catch (      NoSuchAlgorithmException e) {
        return false;
      }
      for (      FileStatus status : statuses) {
        if (status.getPath().getName().contains("checkSum.txt")) {
          containsCheckSumFile=true;
          FSDataInputStream input=fs.open(status.getPath());
          input.read(origMD5);
          input.close();
          continue;
        }
        if (!status.getPath().getName().startsWith(".")) {
          File copyLocation=new File(dest,status.getPath().getName());
          copyFile(fs,status.getPath(),copyLocation,throttler,stats,checkSumGenerator);
        }
      }
      if (containsCheckSumFile) {
        byte[] newMD5=checkSumGenerator.digest();
        return (ByteUtils.compare(newMD5,origMD5) == 0);
      }
 else {
        return true;
      }
    }
  }
  return false;
}
