{
  if (!Utils.isReadableDir(dir))   throw new IllegalArgumentException("Metadata directory " + dir.getAbsolutePath() + " does not exist or can not be read.");
  if (dir.listFiles() == null)   throw new IllegalArgumentException("No configuration found in " + dir.getAbsolutePath() + ".");
  Store<String,String,String> innerStore=new ConfigurationStorageEngine(MetadataStore.METADATA_STORE_NAME,dir.getAbsolutePath());
  return new MetadataStore(innerStore,nodeId);
}
