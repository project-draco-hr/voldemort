{
  String keyStr=ByteUtils.getString(key.get(),"UTF-8");
  String valueStr=ByteUtils.getString(value.getValue(),"UTF-8");
  Version version=value.getVersion();
  if (KNOWN_KEYS.contains(keyStr)) {
    if (CLUSTER_KEY.equals(keyStr)) {
      metadataCache.put(keyStr,new Versioned<Object>(clusterMapper.readCluster(new StringReader(valueStr)),version));
    }
 else     if (STORES_KEY.equals(keyStr)) {
      metadataCache.put(keyStr,new Versioned<Object>(storeMapper.readStoreList(new StringReader(valueStr)),version));
    }
 else     if (SERVER_STATE_KEY.equals(keyStr) || REBALANCING_PROXY_DEST.equals(keyStr)) {
      metadataCache.put(keyStr,new Versioned<Object>(valueStr,version));
    }
 else {
      throw new VoldemortException("Unhandled Key:" + keyStr + " for MetadataStore put()");
    }
  }
}
