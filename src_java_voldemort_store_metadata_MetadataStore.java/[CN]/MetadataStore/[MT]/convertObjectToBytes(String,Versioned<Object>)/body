{
  String valueStr=value.getValue().toString();
  if (CLUSTER_KEY.equals(key)) {
    valueStr=clusterMapper.writeCluster((Cluster)value.getValue());
  }
 else   if (STORES_KEY.equals(key)) {
    valueStr=storeMapper.writeStoreList((List<StoreDefinition>)value.getValue());
  }
 else   if (REBALANCING_PARTITIONS_LIST.equals(key)) {
    StringBuilder builder=new StringBuilder();
    List<Integer> list=(List<Integer>)value.getValue();
    for (int i=0; i < list.size(); i++) {
      Integer partition=list.get(i);
      builder.append(partition);
      if (i < list.size() - 1) {
        builder.append(",");
      }
    }
    valueStr=builder.toString();
  }
  return new Versioned<byte[]>(ByteUtils.getBytes(valueStr,"UTF-8"),value.getVersion());
}
