{
  logger.info("metadata init().");
  initCache(CLUSTER_KEY);
  initCache(STORES_KEY);
  initCache(NODE_ID_KEY,nodeId);
  if (getNodeId() != nodeId)   throw new RuntimeException("Attempt to start previous node:" + getNodeId() + " as node:"+ nodeId+ " (Did you copy config directory ? try deleting .temp .version in config dir to force clean) aborting ...");
  initCache(REBALANCING_STEAL_INFO,new RebalancePartitionsInfo(-1,-1,new ArrayList<Integer>(0),Arrays.asList(""),false,0));
  initCache(SERVER_STATE_KEY,VoldemortState.NORMAL_SERVER.toString());
  initCache(CLUSTER_STATE_KEY,VoldemortState.NORMAL_CLUSTER.toString());
  updateRoutingStrategies(getCluster(),getStoreDefList());
}
