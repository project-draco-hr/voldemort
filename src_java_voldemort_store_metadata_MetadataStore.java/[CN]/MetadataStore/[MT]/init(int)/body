{
  logger.info("metadata init().");
  writeLock.lock();
  initCache(CLUSTER_KEY);
  if (this.storeDefinitionsStorageEngine != null) {
    initStoreDefinitions(null);
  }
 else {
    initCache(STORES_KEY);
  }
  initSystemCache();
  initSystemRoutingStrategies(getCluster());
  initCache(NODE_ID_KEY,nodeId);
  if (getNodeId() != nodeId)   throw new RuntimeException("Attempt to start previous node:" + getNodeId() + " as node:"+ nodeId+ " (Did you copy config directory ? try deleting .temp .version in config dir to force clean) aborting ...");
  initCache(SLOP_STREAMING_ENABLED_KEY,true);
  initCache(PARTITION_STREAMING_ENABLED_KEY,true);
  initCache(READONLY_FETCH_ENABLED_KEY,true);
  initCache(REBALANCING_STEAL_INFO,new RebalancerState(new ArrayList<RebalanceTaskInfo>()));
  initCache(SERVER_STATE_KEY,VoldemortState.NORMAL_SERVER.toString());
  initCache(REBALANCING_SOURCE_CLUSTER_XML,null);
  initCache(REBALANCING_SOURCE_STORES_XML,null);
  updateRoutingStrategies(getCluster(),getStoreDefList());
  writeLock.unlock();
}
