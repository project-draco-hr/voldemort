{
  logger.info("metadata init().");
  initCache(CLUSTER_KEY);
  initCache(STORES_KEY);
  initSystemCache();
  initSystemRoutingStrategies(getCluster());
  initCache(NODE_ID_KEY,nodeId);
  if (getNodeId() != nodeId)   throw new RuntimeException("Attempt to start previous node:" + getNodeId() + " as node:"+ nodeId+ " (Did you copy config directory ? try deleting .temp .version in config dir to force clean) aborting ...");
  initCache(REBALANCING_STEAL_INFO,new RebalancerState(new ArrayList<RebalancePartitionsInfo>()));
  initCache(SERVER_STATE_KEY,VoldemortState.NORMAL_SERVER.toString());
  updateRoutingStrategies(getCluster(),getStoreDefList());
}
