{
  VectorClock clock=new VectorClock();
  if (metadataCache.containsKey(ROUTING_STRATEGY_KEY))   clock=(VectorClock)metadataCache.get(ROUTING_STRATEGY_KEY).getVersion();
  HashMap<String,RoutingStrategy> routingStrategyMap=createRoutingStrategyMap(cluster,storeDefs);
  this.metadataCache.put(ROUTING_STRATEGY_KEY,new Versioned<Object>(routingStrategyMap,clock.incremented(getNodeId(),System.currentTimeMillis())));
  for (  MetadataStoreListener listener : listeners.elementSet()) {
    try {
      listener.updateRoutingStrategy(routingStrategyMap);
    }
 catch (    Exception e) {
      if (logger.isEnabledFor(Level.WARN))       logger.warn(e,e);
    }
  }
}
