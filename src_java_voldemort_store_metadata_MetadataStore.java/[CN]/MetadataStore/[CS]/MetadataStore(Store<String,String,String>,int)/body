{
  super(innerStore.getName());
  this.innerStore=innerStore;
  this.metadataCache=new HashMap<String,Versioned<Object>>();
  this.storeNameTolisteners=new ConcurrentHashMap<String,List<MetadataStoreListener>>();
  this.storeNames=new ArrayList<String>();
  StorageEngine<String,String,String> storesRepo=new InMemoryStorageEngine<String,String,String>("stores-repo");
  List<Versioned<String>> versionedStoreList=innerStore.get(STORES_KEY,"");
  if (versionedStoreList != null) {
    String stores=versionedStoreList.get(0).getValue();
    StoreDefinitionsMapper mapper=new StoreDefinitionsMapper();
    List<StoreDefinition> storeDefinitions=mapper.readStoreList(new StringReader(stores));
    for (    StoreDefinition storeDef : storeDefinitions) {
      Versioned<String> versionedStoreValue=new Versioned<String>(mapper.writeStore(storeDef));
      storesRepo.put(storeDef.getName(),versionedStoreValue,null);
    }
  }
  this.storeDefinitionsStorageEngine=storesRepo;
  init(nodeId);
}
