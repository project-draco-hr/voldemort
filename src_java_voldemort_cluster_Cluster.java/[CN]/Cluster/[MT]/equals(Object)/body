{
  Cluster secondCluster=(Cluster)second;
  if (this.getNodes().size() != secondCluster.getNodes().size()) {
    return false;
  }
  ArrayList<Node> nodeAList=new ArrayList<Node>(this.getNodes());
  for (int i=0; i < this.getNodes().size(); i++) {
    Node nodeA=nodeAList.get(i);
    Node nodeB=secondCluster.getNodeById(nodeA.getId());
    if (nodeA.getNumberOfPartitions() != nodeB.getNumberOfPartitions()) {
      return false;
    }
    for (int j=0; j < nodeA.getNumberOfPartitions(); j++) {
      if (nodeA.getPartitionIds() != nodeB.getPartitionIds()) {
        return false;
      }
    }
  }
  return true;
}
