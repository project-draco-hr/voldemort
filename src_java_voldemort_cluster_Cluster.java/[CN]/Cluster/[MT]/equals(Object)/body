{
  Cluster secondCluster=(Cluster)second;
  if (this.getNodes().size() != secondCluster.getNodes().size()) {
    return false;
  }
  for (  Node nodeA : this.getNodes()) {
    Node nodeB=secondCluster.getNodeById(nodeA.getId());
    if (nodeA.getNumberOfPartitions() != nodeB.getNumberOfPartitions()) {
      return false;
    }
    for (    int partitionId : nodeA.getPartitionIds()) {
      if (!nodeB.getPartitionIds().contains(partitionId)) {
        return false;
      }
    }
  }
  return true;
}
