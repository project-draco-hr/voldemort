{
  List<Integer> tags=new ArrayList<Integer>();
  for (  Node node : nodes)   tags.addAll(node.getPartitionIds());
  Collections.sort(tags);
  for (int i=0; i < numberOfTags; i++) {
    if (tags.get(i).longValue() != i)     throw new IllegalArgumentException("Invalid tag assignment.");
  }
  return tags.size();
}
