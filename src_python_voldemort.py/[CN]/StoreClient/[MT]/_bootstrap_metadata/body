def _bootstrap_metadata(self, bootstrap_urls):
    random.shuffle(bootstrap_urls)
    for (host, port) in bootstrap_urls:
        logging.debug(((('Attempting to bootstrap metadata from ' + host) + ':') + str(port)))
        connection = socket.socket()
        connection.connect((host, port))
        try:
            cluster_xmls = self._get_with_connection(connection, 'metadata', 'cluster.xml', should_route=False)
            if (len(cluster_xmls) != 1):
                raise Exception, ('Expected exactly one version of the metadata but found ' + str(cluster_xmls))
            logging.debug('Bootstrap succeeded')
            return Node.parse_cluster(cluster_xmls[0][0])
        except Exception as exp:
            logging.warn(((((('Metadata bootstrap from ' + host) + ':') + str(port)) + ' failed: ') + str(exp)))
        self._close_socket(connection)
    raise VoldemortException('All bootstrap attempts failed')
