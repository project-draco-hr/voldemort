def _bootstrap_metadata(self, bootstrap_urls):
    random.shuffle(bootstrap_urls)
    for (host, port) in bootstrap_urls:
        connection = socket.socket()
        connection.connect((host, port))
        try:
            cluster_xmls = self._get(connection, 'metadata', 'cluster.xml', should_route=False)
            if (len(cluster_xmls) != 1):
                raise ('Expected exactly one version of the metadata but found ' + str(cluster_xmls))
            return node.parse_cluster(cluster_xmls[0][0])
        except ValueError:
            logging.warn((((('Metadata bootstrap from ' + host) + ':') + str(port)) + ' failed'))
        if connection:
            connection.close()
    raise 'All bootstrap attempts failed'
