{
  super(ServiceType.VOLDEMORT);
  this.voldemortConfig=config;
  this.identityNode=cluster.getNodeById(voldemortConfig.getNodeId());
  this.storeRepository=new StoreRepository();
  ConfigurationStorageEngine metadataInnerEngine=new ConfigurationStorageEngine("metadata-config-store",voldemortConfig.getMetadataDirectory());
  metadataInnerEngine.put(MetadataStore.CLUSTER_KEY,new Versioned<String>(new ClusterMapper().writeCluster(cluster)));
  this.metadata=new MetadataStore(metadataInnerEngine,voldemortConfig.getNodeId());
  this.services=createServices();
}
