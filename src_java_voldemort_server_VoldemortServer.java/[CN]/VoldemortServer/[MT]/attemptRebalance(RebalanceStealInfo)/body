{
  logger.info("Restarting rebalance for rebalanceSubTask:" + stealInfo);
  AdminClient adminClient=RebalanceUtils.createTempAdminClient(voldemortConfig,metadata.getCluster());
  Rebalancer rebalancer=new Rebalancer();
  stealInfo.setAttempt(stealInfo.getAttempt() + 1);
  List<String> unbalanceStoreList=ImmutableList.copyOf(stealInfo.getUnbalancedStoreList());
  for (  String storeName : unbalanceStoreList) {
    try {
      int rebalanceAsyncId=rebalancer.rebalanceLocalNode(metadata,storeName,stealInfo,asyncRunner,adminClient);
      adminClient.waitForCompletion(stealInfo.getStealerId(),rebalanceAsyncId,24 * 60 * 60,TimeUnit.SECONDS);
      stealInfo.getUnbalancedStoreList().remove(storeName);
    }
 catch (    Exception e) {
      logger.warn("rebalanceSubTask:" + stealInfo + " failed for store:"+ storeName,e);
    }
  }
}
