{
  if (exception instanceof InvalidMetadataException) {
    logger.error("Exception when doing get version. The requested key does not exist in this partition.",exception);
    writeErrorResponse(messageEvent,HttpResponseStatus.REQUESTED_RANGE_NOT_SATISFIABLE,"The requested key does not exist in this partition");
  }
 else   if (exception instanceof PersistenceFailureException) {
    logger.error("Exception when doing get version. Operation failed.",exception);
    writeErrorResponse(messageEvent,HttpResponseStatus.INTERNAL_SERVER_ERROR,"Operation failed");
  }
 else   if (exception instanceof ProxyUnreachableException) {
    logger.error("Exception when doing get version. The proxy is unreachable.",exception);
    writeErrorResponse(messageEvent,HttpResponseStatus.SERVICE_UNAVAILABLE,"The proxy is unreachable");
  }
 else {
    super.handleExceptions(messageEvent,exception);
  }
}
