{
  Exception exception=null;
  for (  Node node : cluster.getNodes()) {
    HttpResponse httpResponse=null;
    try {
      logger.info("Attempting rollback for node " + node.getId() + " storeName = "+ storeName);
      String url=node.getHttpUrl() + "/" + readOnlyMgmtPath;
      HttpPost post=new HttpPost(url);
      HttpParams params=post.getParams();
      params.setParameter("operation","rollback");
      params.setParameter("store",storeName);
      params.setParameter("pushVersion",Long.toString(pushVersion));
      httpResponse=httpClient.execute(post);
      int responseCode=httpResponse.getStatusLine().getStatusCode();
      String response=httpResponse.getStatusLine().getReasonPhrase();
      if (responseCode == 200) {
        logger.info("Rollback succeeded for node " + node.getId());
      }
 else {
        throw new VoldemortException(response);
      }
    }
 catch (    Exception e) {
      exception=e;
      logger.error("Exception thrown during rollback operation on node " + node.getId() + ": ",e);
    }
 finally {
      VoldemortIOUtils.closeQuietly(httpResponse,String.valueOf(node));
    }
  }
  if (exception != null)   throw new VoldemortException(exception);
}
