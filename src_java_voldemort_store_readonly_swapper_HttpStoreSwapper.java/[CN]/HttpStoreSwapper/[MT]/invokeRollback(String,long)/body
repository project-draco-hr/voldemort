{
  Exception exception=null;
  for (  Node node : cluster.getNodes()) {
    try {
      logger.info("Attempting rollback for node " + node.getId() + " storeName = "+ storeName);
      String url=node.getHttpUrl() + "/" + readOnlyMgmtPath;
      PostMethod post=new PostMethod(url);
      post.addParameter("operation","rollback");
      post.addParameter("store",storeName);
      if (pushVersion > 0)       post.addParameter("pushVersion",Long.toString(pushVersion));
      int responseCode=httpClient.executeMethod(post);
      String response=post.getStatusText();
      if (responseCode == 200) {
        logger.info("Rollback succeeded for node " + node.getId());
      }
 else {
        throw new VoldemortException(response);
      }
    }
 catch (    Exception e) {
      exception=e;
      logger.error("Exception thrown during rollback operation on node " + node.getId() + ": ",e);
    }
  }
  if (exception != null)   throw new VoldemortException(exception);
}
