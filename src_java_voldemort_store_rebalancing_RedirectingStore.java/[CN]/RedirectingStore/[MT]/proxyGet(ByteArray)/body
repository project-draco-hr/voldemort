{
  RebalancePartitionsInfo rebalancePartitionsInfo=null;
  List<Integer> partitionIds=metadata.getRoutingStrategy(getName()).getPartitionList(key.get());
  for (  int partitionId : partitionIds) {
    for (    RebalancePartitionsInfo candidate : metadata.getRebalancingStealInfo()) {
      if (candidate.getPartitionList().contains(partitionId)) {
        rebalancePartitionsInfo=candidate;
      }
    }
  }
  if (rebalancePartitionsInfo == null) {
    throw new IllegalStateException("No steal operation in progress for key " + key + " partitions("+ Joiner.on(", ").join(partitionIds)+ ")");
  }
  Node donorNode=metadata.getCluster().getNodeById(rebalancePartitionsInfo.getDonorId());
  checkNodeAvailable(donorNode);
  long startNs=System.nanoTime();
  try {
    List<Versioned<byte[]>> values=getRedirectingSocketStore(getName(),rebalancePartitionsInfo.getDonorId()).get(key);
    recordSuccess(donorNode,startNs);
    return values;
  }
 catch (  UnreachableStoreException e) {
    recordException(donorNode,startNs,e);
    throw new ProxyUnreachableException("Failed to reach proxy node " + donorNode,e);
  }
}
