{
  metadata.readLock.lock();
  List<ByteArray> redirectingKeys=new ArrayList<ByteArray>();
  List<RebalancePartitionsInfo> rebalancePartitionsInfos=new ArrayList<RebalancePartitionsInfo>();
  try {
    for (    ByteArray key : keys) {
      RebalancePartitionsInfo info;
      info=redirectingKey(key);
      if (info != null) {
        redirectingKeys.add(key);
        rebalancePartitionsInfos.add(info);
      }
    }
  }
  finally {
    metadata.readLock.unlock();
  }
  if (!redirectingKeys.isEmpty())   proxyGetAllAndLocalPut(redirectingKeys,rebalancePartitionsInfos);
  return getInnerStore().getAll(keys);
}
