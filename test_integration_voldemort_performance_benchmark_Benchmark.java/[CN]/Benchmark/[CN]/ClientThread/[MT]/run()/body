{
  long startTime=System.currentTimeMillis();
  while (opsDone < this.operationsCount) {
    try {
      if (runBenchmark) {
        if (!clientWorkLoad.doTransaction(this.db,plugin)) {
          break;
        }
      }
 else {
        if (!clientWorkLoad.doWrite(this.db,plugin)) {
          break;
        }
      }
      opsDone++;
    }
 catch (    Exception e) {
      e.printStackTrace();
      failureCount++;
      System.err.println("Increasing failure count " + failureCount);
    }
    if (targetThroughputPerMs > 0) {
      double timePerOp=((double)opsDone) / targetThroughputPerMs;
      while (System.currentTimeMillis() - startTime < timePerOp) {
        try {
          sleep(1);
        }
 catch (        InterruptedException e) {
        }
      }
    }
  }
}
