{
  cluster=getNineNodeCluster();
  RoutableStore routableStore=getStore(cluster,cluster.getNumberOfNodes() - 1,cluster.getNumberOfNodes() - 1,1,0);
  recordException(failureDetector,Iterables.get(cluster.getNodes(),1));
  Store<ByteArray,byte[]> store=new InconsistencyResolvingStore<ByteArray,byte[]>(routableStore,new VectorClockInconsistencyResolver<byte[]>());
  store.put(aKey,new Versioned<byte[]>(aValue));
  byte[] anotherValue="john".getBytes();
  recordException(failureDetector,Iterables.getLast(cluster.getNodes()));
  recordSuccess(failureDetector,Iterables.get(cluster.getNodes(),1));
  VectorClock clock=getClock(1);
  store.put(aKey,new Versioned<byte[]>(anotherValue,clock));
  recordException(failureDetector,Iterables.get(cluster.getNodes(),1));
  recordSuccess(failureDetector,Iterables.getLast(cluster.getNodes()));
  List<Versioned<byte[]>> versioneds=store.get(aKey);
  assertEquals(1,versioneds.size());
  assertEquals(new ByteArray(anotherValue),new ByteArray(versioneds.get(0).getValue()));
  Thread.sleep(100);
  for (  Store<ByteArray,byte[]> innerStore : routableStore.getInnerStores().values()) {
    List<Versioned<byte[]>> innerVersioneds=innerStore.get(aKey);
    assertEquals(1,versioneds.size());
    assertEquals(new ByteArray(anotherValue),new ByteArray(innerVersioneds.get(0).getValue()));
  }
}
