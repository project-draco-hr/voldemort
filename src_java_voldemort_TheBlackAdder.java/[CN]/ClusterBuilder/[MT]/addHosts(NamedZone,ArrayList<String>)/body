{
  LinkedList<Node> newNodes=new LinkedList<Node>();
  int maxId=-1;
  int httpPort=-1;
  int adminPort=-1;
  int socketPort=-1;
  int restPort=-1;
  for (  Node node : cluster.getNodes()) {
    if (node.getId() > maxId)     maxId=node.getId();
    if (httpPort < 0)     httpPort=node.getHttpPort();
    if (adminPort < 0)     adminPort=node.getAdminPort();
    if (socketPort < 0)     socketPort=node.getSocketPort();
    if (restPort < 0)     restPort=node.getRestPort();
    newNodes.add(node);
  }
  for (  String host : hosts) {
    String x=host.substring(0,host.indexOf('-'));
    if (!x.equals(nz.prefix))     throw new Exception("Hostname " + host + " does not begin with prefix "+ nz.prefix);
    newNodes.add(new Node(++maxId,host,httpPort,socketPort,adminPort,nz.id,new LinkedList<Integer>(),restPort));
  }
  cluster=new Cluster(cluster.getName(),newNodes,new LinkedList<Zone>(cluster.getZones()));
  return this;
}
