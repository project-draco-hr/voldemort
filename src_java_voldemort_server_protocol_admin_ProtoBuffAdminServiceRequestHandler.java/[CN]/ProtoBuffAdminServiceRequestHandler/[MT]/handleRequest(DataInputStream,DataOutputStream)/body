{
  final VoldemortAdminRequest.Builder request=ProtoUtils.readToBuilder(inputStream,VoldemortAdminRequest.newBuilder());
switch (request.getType()) {
case GET_METADATA:
    ProtoUtils.writeMessage(outputStream,handleGetMetadata(request.getGetMetadata()));
  break;
case UPDATE_METADATA:
ProtoUtils.writeMessage(outputStream,handleUpdateMetadata(request.getUpdateMetadata()));
break;
case DELETE_PARTITION_ENTRIES:
ProtoUtils.writeMessage(outputStream,handleDeletePartitionEntries(request.getDeletePartitionEntries()));
break;
case FETCH_PARTITION_ENTRIES:
handleFetchPartitionEntries(request.getFetchPartitionEntries(),outputStream);
break;
case REDIRECT_GET:
ProtoUtils.writeMessage(outputStream,handleRedirectGet(request.getRedirectGet()));
break;
case UPDATE_PARTITION_ENTRIES:
handleUpdatePartitionEntries(request.getUpdatePartitionEntries(),inputStream,outputStream);
break;
default :
throw new VoldemortException("Unkown operation " + request.getType());
}
}
