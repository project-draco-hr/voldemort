{
  List<Node> replicatingNodes=this.routingStrategy.routeRequest(key);
  int zoneReplicaTypeCounter=-1;
  for (  Node node : replicatingNodes) {
    if (node.getZoneId() == zoneId) {
      zoneReplicaTypeCounter++;
    }
    if (zoneReplicaTypeCounter == zoneReplicaType) {
      return node.getId();
    }
  }
  if (zoneReplicaTypeCounter == -1) {
    throw new VoldemortException("Could not find any replicas for the key " + ByteUtils.toHexString(key) + " in given zone "+ zoneId);
  }
 else {
    throw new VoldemortException("Could not find " + (zoneReplicaType + 1) + " replicas for the key "+ ByteUtils.toHexString(key)+ " in given zone "+ zoneId+ ". Only found "+ (zoneReplicaTypeCounter + 1));
  }
}
