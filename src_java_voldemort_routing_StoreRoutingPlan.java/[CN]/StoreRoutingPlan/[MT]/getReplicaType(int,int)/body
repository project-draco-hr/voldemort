{
  List<Integer> replicatingNodeIds=getReplicationNodeList(partitionId);
  int replicaType=-1;
  for (  int replicatingNodeId : replicatingNodeIds) {
    Node replicatingNode=cluster.getNodeById(replicatingNodeId);
    replicaType++;
    if (replicatingNode.getId() == nodeId) {
      return replicaType;
    }
  }
  if (replicaType > 0) {
    throw new VoldemortException("Node " + nodeId + " not a replica for partition "+ partitionId);
  }
 else {
    throw new VoldemortException("Could not find any replicas for partition Id " + partitionId);
  }
}
