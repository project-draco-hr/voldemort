{
  Store<ByteArray,byte[]> store=server.getStoreRepository().getStorageEngine(storeName);
  assertNotSame("Store '" + storeName + "' should not be null",null,store);
  for (  Pair<ByteArray,Versioned<byte[]>> entry : createEntries()) {
    store.put(entry.getFirst(),entry.getSecond());
  }
  Iterator<Pair<ByteArray,Versioned<byte[]>>> entryIterator=getAdminClient().doFetchPartitionEntries(0,storeName,Arrays.asList(new Integer[]{0}),null);
  RoutingStrategy routingStrategy=server.getMetadataStore().getRoutingStrategy(storeName);
  while (entryIterator.hasNext()) {
    Pair<ByteArray,Versioned<byte[]>> entry=entryIterator.next();
    checkEntriesForPartitions(entry.getFirst().get(),new int[]{0},routingStrategy);
  }
  entryIterator=getAdminClient().doFetchPartitionEntries(0,storeName,Arrays.asList(new Integer[]{0,1}),null);
  Set<Integer> partitionSet2=new HashSet<Integer>();
  while (entryIterator.hasNext()) {
    Pair<ByteArray,Versioned<byte[]>> entry=entryIterator.next();
    checkEntriesForPartitions(entry.getFirst().get(),new int[]{0,1},routingStrategy);
    partitionSet2.add(routingStrategy.getPartitionList(entry.getFirst().get()).get(0));
  }
  assertEquals("GetPartitionsAsStream should return 2 partitions",2,partitionSet2.size());
  assertEquals("GetPartitionsAsStream should return {0,1} partitions",true,partitionSet2.contains(new Integer(0)) && partitionSet2.contains(new Integer(1)));
}
