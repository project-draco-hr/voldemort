{
  Store<ByteArray,byte[]> store=server.getStoreRepository().getStorageEngine(storeName);
  assertNotSame("Store '" + storeName + "' should not be null",null,store);
  Set<Pair<ByteArray,Versioned<byte[]>>> entrySet=createEntries();
  for (  Pair<ByteArray,Versioned<byte[]>> entry : entrySet) {
    store.put(entry.getFirst(),entry.getSecond());
  }
  getAdminClient().deletePartitions(0,storeName,Arrays.asList(0,2),null);
  RoutingStrategy routingStrategy=server.getMetadataStore().getRoutingStrategy(storeName);
  for (  Pair<ByteArray,Versioned<byte[]>> entry : entrySet) {
    if (routingStrategy.getPartitionList(entry.getFirst().get()).contains(0) || routingStrategy.getPartitionList(entry.getFirst().get()).contains(2)) {
      assertEquals("store should be missing all 0,2 entries",0,store.get(entry.getFirst()).size());
    }
 else {
      assertEquals("store should have all 1,3 entries",1,store.get(entry.getFirst()).size());
      assertEquals("entry should match",entry.getSecond().getValue(),store.get(entry.getFirst()).get(0).getValue());
    }
  }
}
