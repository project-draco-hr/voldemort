{
  List<Pair<Integer,Integer>> filteredBuckets=Lists.newArrayList();
  for (  Pair<Integer,Integer> bucket : buckets) {
    if (primaryPartitions.contains(bucket.getFirst()) == primaryOnly) {
      filteredBuckets.add(bucket);
    }
  }
  return filteredBuckets;
}
