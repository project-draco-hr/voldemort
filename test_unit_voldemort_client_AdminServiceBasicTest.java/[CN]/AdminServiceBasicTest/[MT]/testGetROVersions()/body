{
  Map<String,Long> storesToVersions=getAdminClient().getROCurrentVersion(0,Lists.newArrayList("test-readonly-fetchfiles","test-readonly-versions"));
  assertEquals(storesToVersions.size(),2);
  assertEquals(storesToVersions.get("test-readonly-fetchfiles").longValue(),0);
  assertEquals(storesToVersions.get("test-readonly-versions").longValue(),0);
  storesToVersions=getAdminClient().getROMaxVersion(0,Lists.newArrayList("test-readonly-fetchfiles","test-readonly-versions"));
  assertEquals(storesToVersions.size(),2);
  assertEquals(storesToVersions.get("test-readonly-fetchfiles").longValue(),0);
  assertEquals(storesToVersions.get("test-readonly-versions").longValue(),0);
  storesToVersions=getAdminClient().getROMaxVersion(Lists.newArrayList("test-readonly-fetchfiles","test-readonly-versions"));
  assertEquals(storesToVersions.size(),2);
  assertEquals(storesToVersions.get("test-readonly-fetchfiles").longValue(),0);
  assertEquals(storesToVersions.get("test-readonly-versions").longValue(),0);
  ReadOnlyStorageEngine storeNode0=(ReadOnlyStorageEngine)getStore(0,"test-readonly-fetchfiles");
  ReadOnlyStorageEngine storeNode1=(ReadOnlyStorageEngine)getStore(1,"test-readonly-fetchfiles");
  Utils.mkdirs(new File(storeNode0.getStoreDirPath(),"version-10"));
  File newVersionNode1=new File(storeNode1.getStoreDirPath(),"version-11");
  Utils.mkdirs(newVersionNode1);
  generateFiles(10,20,20,cluster.getNodeById(1).getPartitionIds(),newVersionNode1);
  storeNode1.swapFiles(newVersionNode1.getAbsolutePath());
  storesToVersions=getAdminClient().getROCurrentVersion(0,Lists.newArrayList("test-readonly-fetchfiles"));
  assertEquals(storesToVersions.get("test-readonly-fetchfiles").longValue(),0);
  storesToVersions=getAdminClient().getROMaxVersion(0,Lists.newArrayList("test-readonly-fetchfiles"));
  assertEquals(storesToVersions.get("test-readonly-fetchfiles").longValue(),10);
  storesToVersions=getAdminClient().getROCurrentVersion(1,Lists.newArrayList("test-readonly-fetchfiles"));
  assertEquals(storesToVersions.get("test-readonly-fetchfiles").longValue(),11);
  storesToVersions=getAdminClient().getROMaxVersion(1,Lists.newArrayList("test-readonly-fetchfiles"));
  assertEquals(storesToVersions.get("test-readonly-fetchfiles").longValue(),11);
  storesToVersions=getAdminClient().getROMaxVersion(Lists.newArrayList("test-readonly-fetchfiles","test-readonly-versions"));
  assertEquals(storesToVersions.get("test-readonly-fetchfiles").longValue(),11);
  assertEquals(storesToVersions.get("test-readonly-versions").longValue(),0);
}
