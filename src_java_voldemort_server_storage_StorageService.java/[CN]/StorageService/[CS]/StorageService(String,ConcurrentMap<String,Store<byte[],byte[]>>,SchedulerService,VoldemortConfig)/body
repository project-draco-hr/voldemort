{
  super(name);
  this.voldemortConfig=config;
  this.storeMapper=new StoreDefinitionsMapper();
  this.localStoreMap=storeMap;
  this.rawEngines=new ConcurrentHashMap<String,StorageEngine<byte[],byte[]>>();
  this.scheduler=scheduler;
  this.storageConfigurations=initStorageConfigurations(config);
  this.metadataStore=new MetadataStore(new FilesystemStorageEngine(MetadataStore.METADATA_STORE_NAME,config.getMetadataDirectory()),storeMap);
  this.readOnlyStores=new ConcurrentHashMap<String,RandomAccessFileStore>();
}
