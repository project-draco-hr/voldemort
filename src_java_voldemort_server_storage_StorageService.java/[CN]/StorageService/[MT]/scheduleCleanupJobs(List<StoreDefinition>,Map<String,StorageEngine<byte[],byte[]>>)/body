{
  GregorianCalendar cal=new GregorianCalendar();
  cal.add(Calendar.DAY_OF_YEAR,1);
  cal.set(Calendar.HOUR,0);
  cal.set(Calendar.MINUTE,0);
  cal.set(Calendar.SECOND,0);
  cal.set(Calendar.MILLISECOND,0);
  Date startTime=cal.getTime();
  Semaphore cleanupPermits=new Semaphore(1);
  for (  StoreDefinition storeDef : storeDefs) {
    if (storeDef.hasRetentionPeriod()) {
      logger.info("Scheduling data retention cleanup job for store '" + storeDef.getName() + "' at "+ startTime+ ".");
      StorageEngine<byte[],byte[]> engine=engines.get(storeDef.getName());
      Runnable cleanupJob=new DataCleanupJob<byte[],byte[]>(engine,cleanupPermits,storeDef.getRetentionDays() * Time.MS_PER_DAY,SystemTime.INSTANCE);
      this.scheduler.schedule(cleanupJob,startTime,Time.MS_PER_DAY);
    }
  }
}
