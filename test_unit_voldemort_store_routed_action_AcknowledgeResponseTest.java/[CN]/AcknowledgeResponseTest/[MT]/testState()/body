{
  BasicPipelineData<byte[]> pipelineData=new BasicPipelineData<byte[]>();
  pipelineData.setAttempts(2);
  AcknowledgeResponse<byte[],BasicPipelineData<byte[]>> action=new AcknowledgeResponse<byte[],BasicPipelineData<byte[]>>(pipelineData,Event.COMPLETED,failureDetector,1,1,null);
  Node node1=cluster.getNodeById(0);
  Node node2=cluster.getNodeById(1);
  UnreachableStoreException node1Error=new UnreachableStoreException("testing failures in " + getClass().getSimpleName());
  Response<ByteArray,Object> response1=new Response<ByteArray,Object>(node1,aKey,node1Error,777);
  Response<ByteArray,Object> response2=new Response<ByteArray,Object>(node2,aKey,new byte[8],777);
  Pipeline pipeline=new Pipeline(Operation.GET,10000,TimeUnit.MILLISECONDS);
  action.execute(pipeline,response1);
  action.execute(pipeline,response2);
  if (pipelineData.getFatalError() != null)   throw pipelineData.getFatalError();
  assertEquals(1,pipelineData.getSuccesses());
  assertEquals(1,pipelineData.getResponses().size());
  assertEquals(response2,pipelineData.getResponses().get(0));
  assertEquals(1,pipelineData.getFailures().size());
  assertEquals(node1Error,pipelineData.getFailures().get(0));
  assertTrue(!failureDetector.isAvailable(node1));
  assertTrue(failureDetector.isAvailable(node2));
}
