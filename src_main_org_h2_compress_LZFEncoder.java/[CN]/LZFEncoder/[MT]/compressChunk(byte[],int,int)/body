{
  if (len < MIN_BLOCK_TO_COMPRESS) {
    return LZFChunk.createNonCompressed(data,offset,len);
  }
  int bufferLen=len + ((len + 31) >> 5);
  if (_encodeBuffer == null || _encodeBuffer.length < bufferLen) {
    _encodeBuffer=new byte[bufferLen];
  }
  if (_hashTable == null) {
    initHashTable(len);
  }
  int compLen=tryCompress(data,offset,offset + len,_encodeBuffer,0);
  if (compLen > (len - 2)) {
    return LZFChunk.createNonCompressed(data,offset,len);
  }
  return LZFChunk.createCompressed(len,_encodeBuffer,0,compLen);
}
