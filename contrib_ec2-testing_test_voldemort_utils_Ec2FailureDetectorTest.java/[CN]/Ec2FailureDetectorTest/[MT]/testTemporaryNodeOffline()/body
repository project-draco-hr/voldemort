{
  HostNamePair offlineHost=hostNamePairs.get(0);
  Integer nodeId=nodeIds.get(offlineHost.getExternalHostName());
  Node node=new Node(nodeId,offlineHost.getInternalHostName(),8081,6666,6667,Collections.<Integer>emptyList());
  StoreClientFactory scf=new SocketStoreClientFactory(new ClientConfig().setBootstrapUrls("tcp://" + offlineHost.getInternalHostName() + ":6666"));
  FailureDetector failureDetector=scf.getFailureDetector();
  Store<String,String> store=scf.getRawStore("test",null);
  System.out.println("------------------- ENSURING STORE IS AVAILABLE -------------------");
  test(store);
  System.out.println("------------------- ASSERTING NODE IS AVAILABLE -------------------");
  Assert.assertEquals(hostNamePairs.size(),failureDetector.getAvailableNodeCount());
  System.out.println("------------------- STOPPING NODE -------------------");
  stopClusterNode(offlineHost.getExternalHostName(),ec2RemoteTestConfig);
  System.out.println("------------------- NODE STOPPED -------------------");
  System.out.println("------------------- TESTING STORE HOPING TO KNOCK IT UNAVAILABLE -------------------");
  test(store);
  System.out.println("------------------- ASSERTING NODE IS UNAVAILABLE -------------------");
  Assert.assertEquals(hostNamePairs.size() - 1,failureDetector.getAvailableNodeCount());
  System.out.println("------------------- STARTING NODE -------------------");
  startClusterNode(offlineHost.getExternalHostName(),ec2RemoteTestConfig,nodeId);
  System.out.println("------------------- WAITING FOR NODE TO BECOME AVAILABLE -------------------");
  failureDetector.waitForAvailability(node);
  System.out.println("------------------- TESTING STORE JUST TO ENSURE IT'S AVAILABLE -------------------");
  test(store);
  System.out.println("------------------- ASSERTING NODE IS AVAILABLE AGAIN -------------------");
  Assert.assertEquals(hostNamePairs.size(),failureDetector.getAvailableNodeCount());
}
