{
  if (args.length != 5)   Utils.croak("Expected arguments store_name config_dir temp_dir input_path output_path");
  String storeName=args[0];
  String configDir=args[1];
  String tempDir=args[2];
  String inputDir=args[3];
  String outputDir=args[4];
  List<StoreDefinition> storeDefs=new StoreDefinitionsMapper().readStoreList(new File(configDir,"stores.xml"));
  StoreDefinition def=null;
  for (  StoreDefinition d : storeDefs)   if (d.getName().equals(storeName))   def=d;
  Cluster cluster=new ClusterMapper().readCluster(new File(configDir,"cluster.xml"));
  Configuration config=this.getConf();
  config.set("mapred.job.name","test-store-builder");
  HadoopStoreBuilder builder=new HadoopStoreBuilder(config,BuildTestStoreMapper.class,SequenceFileInputFormat.class,cluster,def,(long)(1.5 * 1024 * 1024* 1024),new Path(tempDir),new Path(outputDir),new Path(inputDir));
  builder.build();
  return 0;
}
