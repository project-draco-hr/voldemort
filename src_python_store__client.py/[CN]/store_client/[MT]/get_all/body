def get_all(self, keys):
    'Execute get request for multiple keys. Returns a list of (value, version) pairs.'
    req = self._create_request()
    req.type = protocol.GET_ALL
    get_req = protocol.GetAllRequest()
    get_req.keys = keys
    req.get_all = get_req
    self._send_req(req.SerializeToString())
    resp_str = self._receive_resp()
    resp = protocol.GetAllResponse.ParseFromString(resp_str)
    self._check_error(resp)
    values = {}
    for key_val in resp.values:
        values[key_val.key] = key_val.values
    return values
