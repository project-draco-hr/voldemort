{
  byte[] keyBytes=ByteUtils.copy(key.get(),0,key.getSize());
  while (values.hasNext()) {
    BytesWritable writable=values.next();
    byte[] valueBytes=writable.get();
    if (this.nodeId == -1)     this.nodeId=ByteUtils.readInt(valueBytes,0);
    if (this.chunkId == -1)     this.chunkId=ReadOnlyUtils.chunk(keyBytes,this.numChunks);
    this.indexFileStream.write(keyBytes);
    this.indexFileStream.writeInt(this.position);
    int valueLength=writable.getSize() - 4;
    this.valueFileStream.writeInt(valueLength);
    this.valueFileStream.write(valueBytes,4,valueLength);
    this.position+=4 + valueLength;
    if (this.position < 0)     throw new VoldemortException("Chunk overflow exception: chunk " + chunkId + " has exceeded "+ Integer.MAX_VALUE+ " bytes.");
  }
}
