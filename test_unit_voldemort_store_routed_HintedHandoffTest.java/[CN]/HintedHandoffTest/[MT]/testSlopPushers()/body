{
  Set<Integer> failedNodes=getFailedNodes();
  Set<ByteArray> failedKeys=populateStore(failedNodes);
  for (  int node : failedNodes) {
    ForceFailStore forceFailStore=getForceFailStore(node);
    forceFailStore.setFail(false);
    if (logger.isTraceEnabled())     logger.trace("Stopped failing requests to " + node);
  }
  while (!failedNodes.isEmpty())   for (  int node : failedNodes)   if (failureDetector.isAvailable(cluster.getNodeById(node)))   failedNodes.remove(node);
  for (  SlopPusherJob job : slopPusherJobs) {
    if (logger.isTraceEnabled())     logger.trace("Started slop pusher job " + job);
    job.run();
    if (logger.isTraceEnabled())     logger.trace("Finished slop pusher job " + job);
  }
  for (  ByteArray key : keyValues.keySet()) {
    List<Versioned<byte[]>> values=store.get(key);
    assertTrue("slop entry should be pushed for " + key + ", preflist "+ keysToNodes.get(key),values.size() > 0);
    assertEquals("slop entry should be correct for " + key,keyValues.get(key),new ByteArray(values.get(0).getValue()));
  }
}
