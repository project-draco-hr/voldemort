{
  byte opCode=inputStream.readByte();
  String storeName=inputStream.readUTF();
  int keySize=inputStream.readInt();
  ByteArray key=new ByteArray(new byte[keySize]);
  ByteUtils.read(inputStream,key.get());
  Store<ByteArray,byte[]> store=storeMap.get(storeName);
  if (store == null) {
    writeException(outputStream,new VoldemortException("No store named '" + storeName + "'."));
  }
 else {
switch (opCode) {
case VoldemortOpCode.GET_OP_CODE:
      handleGet(store,key);
    break;
case VoldemortOpCode.PUT_OP_CODE:
  handlePut(store,key);
break;
case VoldemortOpCode.DELETE_OP_CODE:
handleDelete(store,key);
break;
default :
throw new IOException("Unknown op code: " + opCode);
}
}
outputStream.flush();
}
