{
  super(stealInfoList);
  for (  RebalancePartitionsInfo info : stealInfoList) {
    for (    int partition : info.getPartitionList()) {
      Set<Integer> nodeIds=partitionToNodeIds.get(partition);
      if (nodeIds == null) {
        nodeIds=Sets.newHashSet();
        partitionToNodeIds.putAll(partition,nodeIds);
      }
      nodeIds.add(info.getStealerId());
    }
  }
  this.storeDefs=storeDefs;
  this.cluster=cluster;
  if (storeDefs != null && cluster != null) {
    for (    StoreDefinition storeDef : storeDefs) {
      this.routingMap.put(storeDef.getName(),routingFactory.updateRoutingStrategy(storeDef,cluster));
    }
  }
}
