{
  try {
    Properties versionProps=MetadataVersionStoreUtils.getProperties(this.systemStoreRepository.getMetadataVersionStore());
    Long newClusterVersion=fetchNewVersion(CLUSTER_VERSION_KEY,this.currentClusterVersion,versionProps);
    Long newStoreVersion=fetchNewVersion(STORES_VERSION_KEY,this.currentStoreVersion,versionProps);
    if ((newClusterVersion != null) || (newStoreVersion != null)) {
      logger.info("Metadata version mismatch detected. Re-bootstrapping!");
      try {
        if (newClusterVersion != null) {
          logger.info("Updating cluster version");
          currentClusterVersion=newClusterVersion;
        }
        if (newStoreVersion != null) {
          logger.info("Updating store : '" + STORES_VERSION_KEY + "' version");
          this.currentStoreVersion=newStoreVersion;
        }
        this.storeClientThunk.call();
      }
 catch (      Exception e) {
        if (logger.isDebugEnabled()) {
          e.printStackTrace();
          logger.debug(e.getMessage());
        }
      }
    }
  }
 catch (  Exception e) {
    logger.debug("Could not retrieve metadata versions from the server.");
  }
}
