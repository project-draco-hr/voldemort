{
  Properties versionProps=MetadataVersionStoreUtils.getProperties(this.sysRepository.getMetadataVersionStore());
  Long newClusterVersion=fetchNewVersion(CLUSTER_VERSION_KEY,currentClusterVersion,versionProps);
  if (newClusterVersion != null) {
    logger.info("Metadata version mismatch detected.");
    int delta=randomGenerator.nextInt(DELTA_MAX);
    try {
      logger.info("Sleeping for delta : " + delta + " (ms) before re-bootstrapping.");
      Thread.sleep(delta);
    }
 catch (    InterruptedException e) {
    }
    if (!newClusterVersion.equals(currentClusterVersion)) {
      try {
        logger.info("Updating cluster version");
        currentClusterVersion=newClusterVersion;
        this.storeClientThunk.call();
      }
 catch (      Exception e) {
        e.printStackTrace();
        logger.info(e.getMessage());
      }
    }
  }
}
