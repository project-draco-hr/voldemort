{
switch (type) {
case VOLDEMORT_V0:
    return new VoldemortNativeRequestHandler(new ErrorCodeMapper(),repository,0);
case VOLDEMORT_V1:
  return new VoldemortNativeRequestHandler(new ErrorCodeMapper(),repository,1);
case PROTOCOL_BUFFERS:
return new ProtoBuffRequestHandler(new ErrorCodeMapper(),repository);
case ADMIN:
return new AdminServiceRequestHandler(new ErrorCodeMapper(),repository,metadata,voldemortConfig.getMetadataDirectory(),voldemortConfig.getStreamMaxReadBytesPerSec(),voldemortConfig.getStreamMaxWriteBytesPerSec());
default :
throw new VoldemortException("Unknown wire format " + type);
}
}
