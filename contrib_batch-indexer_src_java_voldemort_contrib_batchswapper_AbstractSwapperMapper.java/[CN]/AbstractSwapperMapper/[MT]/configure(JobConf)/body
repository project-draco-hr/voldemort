{
  conf=job;
  sourcefileName=new Path(conf.get("map.input.file")).toUri().getPath();
  if (sourcefileName.contains("index") || sourcefileName.contains("data")) {
    System.out.println("mapper got file:" + sourcefileName);
    isIndexFile=new Path(sourcefileName).getName().contains("index");
    String storeName=conf.get("voldemort.store.name");
    String[] tempSplits=new Path(sourcefileName).getName().split("\\.");
    int fileNodeId=Integer.parseInt(tempSplits[0]);
    try {
      String clusterFilePath=ContribUtils.getFileFromCache(conf,"cluster.xml");
      if (null == clusterFilePath) {
        throw new RuntimeException("Mapper expects cluster.xml / stores.xml passed through Distributed cache.");
      }
      Cluster cluster=ContribUtils.getVoldemortClusterDetails(clusterFilePath);
      node=cluster.getNodeById(fileNodeId);
    }
 catch (    Exception e) {
      throw new RuntimeException(e);
    }
  }
}
