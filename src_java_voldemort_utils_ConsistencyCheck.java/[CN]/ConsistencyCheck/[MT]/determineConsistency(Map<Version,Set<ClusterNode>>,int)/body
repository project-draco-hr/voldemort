{
  boolean fullyConsistent=true;
  Version latestVersion=null;
  for (  Map.Entry<Version,Set<ClusterNode>> versionNodeSetEntry : versionNodeSetMap.entrySet()) {
    Version version=versionNodeSetEntry.getKey();
    if (version instanceof VectorClock) {
      if (latestVersion == null || ((VectorClock)latestVersion).getTimestamp() < ((VectorClock)version).getTimestamp()) {
        latestVersion=version;
      }
    }
    Set<ClusterNode> nodeSet=versionNodeSetEntry.getValue();
    fullyConsistent=fullyConsistent && (nodeSet.size() == replicationFactor);
  }
  if (fullyConsistent) {
    return ConsistencyLevel.FULL;
  }
 else {
    if (latestVersion != null && versionNodeSetMap.get(latestVersion).size() == replicationFactor) {
      return ConsistencyLevel.LATEST_CONSISTENT;
    }
    return ConsistencyLevel.INCONSISTENT;
  }
}
