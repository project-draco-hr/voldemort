{
  MetadataStore metadataStore=MetadataStore.readFromDirectory(new File(metadataDir));
  this.currentCluster=metadataStore.getCluster();
  this.rollbackCluster=metadataStore.getRollBackCluster();
  this.storeDefMap=new HashMap<String,StoreDefinition>();
  for (  StoreDefinition storeDef : metadataStore.getStores()) {
    this.storeDefMap.put(storeDef.getName(),storeDef);
  }
  this.serverState=VoldemortMetadata.ServerState.NORMAL_STATE;
  this.node=currentCluster.getNodeById(nodeId);
  this.routingStrategyByStoreName=new HashMap<String,RoutingStrategy>();
  reinitRoutingStrategies();
}
