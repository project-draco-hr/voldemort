{
  if (cluster.getNumberOfNodes() > hostNames.size())   throw new IllegalStateException("cluster size exceeds the number of available instances");
  List<ClusterNodeDescriptor> list=new ArrayList<ClusterNodeDescriptor>();
  for (int i=0; i < cluster.getNumberOfNodes(); i++) {
    Node node=cluster.getNodeById(i);
    String hostName=hostNames.get(i);
    List<Integer> partitions=node.getPartitionIds();
    ClusterNodeDescriptor cnd=new ClusterNodeDescriptor();
    cnd.setHostName(hostName);
    cnd.setId(i);
    cnd.setSocketPort(node.getSocketPort());
    cnd.setHttpPort(node.getHttpPort());
    cnd.setAdminPort(node.getAdminPort());
    cnd.setPartitions(partitions);
    list.add(cnd);
  }
  return list;
}
