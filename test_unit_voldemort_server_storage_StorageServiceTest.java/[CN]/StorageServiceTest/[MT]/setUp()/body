{
  File temp=TestUtils.createTempDir();
  VoldemortConfig config=new VoldemortConfig(0,temp.getAbsolutePath());
  config.setEnableServerRouting(true);
  new File(config.getMetadataDirectory()).mkdir();
  config.setBdbCacheSize(100000);
  this.scheduler=new SchedulerService(1,new MockTime());
  this.cluster=ServerTestUtils.getLocalCluster(1);
  this.storeDefs=ServerTestUtils.getStoreDefs(2);
  this.storeRepository=new StoreRepository();
  MetadataStore mdStore=ServerTestUtils.createMetadataStore(cluster,storeDefs);
  storage=new StorageService(storeRepository,mdStore,scheduler,config);
  storage.start();
}
