{
  ArrayList<Node> nodes=new ArrayList<Node>();
  for (  Node node : currentCluster.getNodes()) {
    if (fromNode.getId() == node.getId()) {
      List<Integer> partitionList=new ArrayList<Integer>(node.getPartitionIds());
      partitionList.removeAll(stealList);
      nodes.add(new Node(node.getId(),node.getHost(),node.getHttpPort(),node.getSocketPort(),node.getAdminPort(),partitionList,node.getStatus()));
    }
 else     if (toNode.getId() == node.getId()) {
      stealList.addAll(node.getPartitionIds());
      nodes.add(new Node(node.getId(),node.getHost(),node.getHttpPort(),node.getSocketPort(),node.getAdminPort(),stealList,node.getStatus()));
    }
 else {
      nodes.add(node);
    }
  }
  return new Cluster(currentCluster.getName(),nodes);
}
