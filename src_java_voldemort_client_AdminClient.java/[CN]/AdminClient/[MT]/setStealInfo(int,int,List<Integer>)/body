{
  Cluster currentCluster=metadata.getCurrentCluster();
  Node node=currentCluster.getNodeById(stealerNodeId);
  SocketDestination destination=new SocketDestination(node.getHost(),node.getAdminPort());
  SocketAndStreams sands=pool.checkout(destination);
  try {
    DataOutputStream outputStream=sands.getOutputStream();
    outputStream.writeByte(VoldemortOpCode.SET_STEAL_INFO_OP_CODE);
    outputStream.writeInt(donorNodeId);
    outputStream.writeInt(stealPartitionList.size());
    for (    Integer partition : stealPartitionList) {
      outputStream.writeInt(partition);
    }
    outputStream.flush();
    DataInputStream inputStream=sands.getInputStream();
    checkException(inputStream);
  }
 catch (  IOException e) {
    close(sands.getSocket());
    throw new VoldemortException(e);
  }
 finally {
    pool.checkin(destination,sands);
  }
}
