{
  if (logger.isInfoEnabled())   logger.info("Server now listening for connections");
  AtomicInteger counter=new AtomicInteger();
  while (true) {
    if (Thread.currentThread().isInterrupted()) {
      if (logger.isInfoEnabled())       logger.info("Thread interrupted");
      break;
    }
    try {
      SocketChannel socketChannel=serverSocketChannel.accept();
      if (socketChannel == null) {
        if (logger.isEnabledFor(Level.WARN))         logger.warn("Claimed accept but nothing to select");
        continue;
      }
      SelectorManager selectorManager=selectorManagers[counter.getAndIncrement() % selectorManagers.length];
      selectorManager.accept(socketChannel);
    }
 catch (    ClosedByInterruptException e) {
      if (logger.isTraceEnabled())       logger.trace("Interrupted, closing");
      break;
    }
catch (    Exception e) {
      if (logger.isEnabledFor(Level.WARN))       logger.warn(e.getMessage(),e);
    }
  }
  if (logger.isInfoEnabled())   logger.info("Server has stopped listening for connections");
}
