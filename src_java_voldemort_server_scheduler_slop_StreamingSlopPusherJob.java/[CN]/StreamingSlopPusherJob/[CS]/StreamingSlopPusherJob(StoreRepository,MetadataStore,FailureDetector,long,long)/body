{
  this.storeRepo=storeRepo;
  this.metadataStore=metadataStore;
  this.failureDetector=failureDetector;
  Cluster cluster=metadataStore.getCluster();
  this.slopQueues=Maps.newHashMapWithExpectedSize(cluster.getNumberOfNodes());
  this.consumerExecutor=Executors.newFixedThreadPool(cluster.getNumberOfNodes());
  this.writeThrottler=new EventThrottler(maxWriteBytesPerSec);
  this.readThrottler=new EventThrottler(maxReadBytesPerSec);
  this.adminClient=new AdminClient(cluster,new AdminClientConfig().setMaxThreads(cluster.getNumberOfNodes()).setMaxConnectionsPerNode(1));
}
