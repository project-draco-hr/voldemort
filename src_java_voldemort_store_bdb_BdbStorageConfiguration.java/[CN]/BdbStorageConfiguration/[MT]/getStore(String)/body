{
synchronized (lock) {
    BdbStorageEngine store=stores.get(storeName);
    if (store != null)     return stores.get(storeName);
    try {
      Environment environment=getEnvironment(storeName);
      Database db=environment.openDatabase(null,storeName,databaseConfig);
      BdbStorageEngine engine=new BdbStorageEngine(storeName,environment,db);
      stores.put(storeName,engine);
      return engine;
    }
 catch (    DatabaseException d) {
      throw new StorageInitializationException(d);
    }
  }
}
