{
synchronized (lock) {
    try {
      LockMode readLockMode=getLockMode();
      Environment environment=getEnvironment(storeName);
      Database db=environment.openDatabase(null,storeName,databaseConfig);
      if (voldemortConfig.getBdbCursorPreload()) {
        PreloadConfig preloadConfig=new PreloadConfig();
        preloadConfig.setLoadLNs(true);
        db.preload(preloadConfig);
      }
      BdbStorageEngine engine=new BdbStorageEngine(storeName,environment,db,readLockMode,voldemortConfig.getBdbCursorPreload());
      return engine;
    }
 catch (    DatabaseException d) {
      throw new StorageInitializationException(d);
    }
  }
}
