{
  if (fs1.isDir())   return fs2.isDir() ? 0 : -1;
  if (fs2.isDir())   return fs1.isDir() ? 0 : 1;
  String f1=fs1.getPathSuffix(), f2=fs2.getPathSuffix();
  if (f1.endsWith("metadata"))   return -1;
  if (f2.endsWith("metadata"))   return 1;
  if ((f1.endsWith(".index") && f2.endsWith(".index")) || (f1.endsWith(".data") && f2.endsWith(".data"))) {
    return f1.compareToIgnoreCase(f2);
  }
  if (f1.endsWith(".index")) {
    return 1;
  }
 else {
    return -1;
  }
}
