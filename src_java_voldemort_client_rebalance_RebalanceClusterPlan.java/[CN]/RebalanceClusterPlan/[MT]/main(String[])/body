{
  OptionParser parser=new OptionParser();
  parser.accepts("help","print help information");
  parser.accepts("cluster-xml","[REQUIRED] old cluster xml file location").withRequiredArg().describedAs("path");
  parser.accepts("stores-xml","[REQUIRED] stores xml file location").withRequiredArg().describedAs("path");
  parser.accepts("target-stores-xml","new stores xml file location").withRequiredArg().describedAs("path");
  parser.accepts("target-cluster-xml","[REQUIRED] new cluster xml file location").withRequiredArg().describedAs("path");
  OptionSet options=parser.parse(args);
  if (options.has("help")) {
    parser.printHelpOn(System.out);
    System.exit(0);
  }
  Set<String> missing=CmdUtils.missing(options,"cluster-xml","stores-xml","target-cluster-xml");
  if (missing.size() > 0) {
    System.err.println("Missing required arguments: " + Joiner.on(", ").join(missing));
    parser.printHelpOn(System.err);
    System.exit(1);
  }
  String newClusterXml=(String)options.valueOf("target-cluster-xml");
  String oldClusterXml=(String)options.valueOf("cluster-xml");
  String oldStoresXml=(String)options.valueOf("stores-xml");
  String newStoresXml=oldStoresXml;
  if (options.has("target-stores-xml")) {
    newStoresXml=(String)options.valueOf("target-stores-xml");
  }
  if (!Utils.isReadableFile(newClusterXml) || !Utils.isReadableFile(oldClusterXml) || !Utils.isReadableFile(oldStoresXml)|| !Utils.isReadableFile(newStoresXml)) {
    System.err.println("Could not read metadata files from path provided");
    parser.printHelpOn(System.err);
    System.exit(1);
  }
  ClusterMapper clusterMapper=new ClusterMapper();
  StoreDefinitionsMapper storeDefMapper=new StoreDefinitionsMapper();
  RebalanceClusterPlan plan=new RebalanceClusterPlan(clusterMapper.readCluster(new File(oldClusterXml)),clusterMapper.readCluster(new File(newClusterXml)),storeDefMapper.readStoreList(new File(oldStoresXml)),storeDefMapper.readStoreList(new File(newStoresXml)),false,null);
  System.out.println(plan);
}
