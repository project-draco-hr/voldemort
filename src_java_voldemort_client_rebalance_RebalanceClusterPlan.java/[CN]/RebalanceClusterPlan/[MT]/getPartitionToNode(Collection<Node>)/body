{
  final Map<Integer,Integer> partitionToNodeIdMap=new LinkedHashMap<Integer,Integer>();
  for (  Node node : nodes) {
    for (    Integer partitionId : node.getPartitionIds()) {
      Integer previousRegisteredNodeId=partitionToNodeIdMap.get(partitionId);
      if (previousRegisteredNodeId != null) {
        throw new IllegalArgumentException("Partition id " + partitionId + " found in 2 nodes ID's: "+ node.getId()+ " and "+ previousRegisteredNodeId);
      }
      partitionToNodeIdMap.put(partitionId,node.getId());
    }
  }
  return partitionToNodeIdMap;
}
