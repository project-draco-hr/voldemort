{
  Map<Integer,Set<Integer>> clusterNodeIdToReplicas=getNodeIdToReplicas(cluster);
  Map<Integer,Set<Integer>> targetNodeIdToReplicas=getNodeIdToReplicas(target);
  Set<Integer> clusterStealerReplicas=clusterNodeIdToReplicas.get(stealerId);
  Set<Integer> targetStealerReplicas=targetNodeIdToReplicas.get(stealerId);
  Set<Integer> replicasAddedInTarget=getAddedInTarget(clusterStealerReplicas,targetStealerReplicas);
  if (RebalanceUtils.containsNode(cluster,stealerId)) {
    replicasAddedInTarget.removeAll(cluster.getNodeById(stealerId).getPartitionIds());
  }
  return replicasAddedInTarget;
}
