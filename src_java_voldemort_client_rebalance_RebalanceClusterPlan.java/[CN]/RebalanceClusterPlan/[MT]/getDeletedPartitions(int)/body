{
  Set<Integer> delPartitions=new TreeSet<Integer>();
  if (targetNodeIdToAllDeletedPartitions.get(nodeId) != null && targetNodeIdToAllDeletedPartitions.get(nodeId).size() > 0) {
    delPartitions=new TreeSet<Integer>(targetNodeIdToAllDeletedPartitions.get(nodeId));
    Set<Integer> alreadyDeletedPartitions=alreadyDeletedNodeIdToPartions.get(nodeId);
    if (alreadyDeletedPartitions != null)     delPartitions.removeAll(alreadyDeletedPartitions);
  }
  return delPartitions;
}
