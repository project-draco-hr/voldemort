{
  Set<Pair<Integer,Integer>> delPartitions=new HashSet<Pair<Integer,Integer>>();
  if (targetNodeIdToAllDeletedPartitions.get(nodeId) != null && targetNodeIdToAllDeletedPartitions.get(nodeId).size() > 0) {
    delPartitions.addAll(targetNodeIdToAllDeletedPartitions.get(nodeId));
    Set<Pair<Integer,Integer>> alreadyDeletedPartitions=alreadyDeletedNodeIdToPartions.get(nodeId);
    if (alreadyDeletedPartitions != null)     delPartitions.removeAll(alreadyDeletedPartitions);
  }
  return delPartitions;
}
