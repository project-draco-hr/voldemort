{
  final Map<Integer,Set<Integer>> map=new TreeMap<Integer,Set<Integer>>();
  for (  Integer stealNodeId : targetNodeIdToAllPartitions.keySet()) {
    Set<Integer> donatedPartitions=getStealPrimaries(currentCluster,targetCluster,stealNodeId);
    donatedPartitions.addAll(getStealReplicas(currentCluster,targetCluster,stealNodeId));
    map.put(stealNodeId,donatedPartitions);
  }
  return map;
}
