{
  final int donorId=donor.getId();
  if (enabledDeletePartition) {
    if (targetNodeIdToAllDeletedPartitions.get(donorId) != null && targetNodeIdToAllDeletedPartitions.get(donorId).size() > 0) {
      Set<Integer> delPartitions=new TreeSet<Integer>(targetNodeIdToAllDeletedPartitions.get(donorId));
      final Cluster sortedTargetCluster=sortCluster(targetCluster);
      for (      Node targetNode : sortedTargetCluster.getNodes()) {
        if (targetNode.getId() == donorId || targetNode.getId() <= stealerId)         continue;
        Set<Integer> stolenPartitions=targetNodeIdToAllStolenPartitions.get(targetNode.getId());
        Iterator<Integer> iterator=delPartitions.iterator();
        while (iterator.hasNext()) {
          Integer delPartition=iterator.next();
          if (stolenPartitions != null && stolenPartitions.contains(delPartition)) {
            iterator.remove();
          }
        }
      }
      Set<Integer> alreadyDeletedPartitions=alreadyDeletedNodeIdToPartions.get(donorId);
      if (alreadyDeletedPartitions != null) {
        delPartitions.removeAll(alreadyDeletedPartitions);
      }
      trackDeletePartitions.addAll(delPartitions);
      for (      int delPartition : delPartitions) {
        if (alreadyDeletedNodeIdToPartions.containsKey(donorId)) {
          alreadyDeletedNodeIdToPartions.get(donorId).add(delPartition);
        }
 else {
          Set<Integer> set=new TreeSet<Integer>();
          set.add(delPartition);
          alreadyDeletedNodeIdToPartions.put(donorId,set);
        }
      }
    }
  }
}
