{
  final Map<Integer,Set<Pair<Integer,Integer>>> map=new TreeMap<Integer,Set<Pair<Integer,Integer>>>();
  for (  int stealNodeId : targetNodeIdToAllPartitions.keySet()) {
    Set<Pair<Integer,Integer>> donatedPartitions=RebalanceUtils.getStolenPrimaryPartitionTuples(currentCluster,targetCluster,stealNodeId);
    donatedPartitions.addAll(RebalanceUtils.getStolenReplicaPartitionTuples(currentCluster,targetCluster,storeDefs,stealNodeId));
    map.put(stealNodeId,donatedPartitions);
  }
  return map;
}
