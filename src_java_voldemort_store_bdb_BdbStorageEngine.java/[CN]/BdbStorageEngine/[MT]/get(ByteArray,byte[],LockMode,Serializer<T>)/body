{
  StoreUtils.assertValidKey(key);
  long startTimeNs=-1;
  if (logger.isTraceEnabled())   startTimeNs=System.nanoTime();
  Cursor cursor=null;
  try {
    cursor=getBdbDatabase().openCursor(null,null);
    List<T> result=get(cursor,key,lockMode,serializer);
    if (result.size() == 0 && lockMode != LockMode.DEFAULT) {
      return get(cursor,key,LockMode.DEFAULT,serializer);
    }
 else {
      return result;
    }
  }
 catch (  DatabaseException e) {
    logger.error(e);
    throw new PersistenceFailureException(e);
  }
 finally {
    if (logger.isTraceEnabled()) {
      logger.trace("Completed GET from key " + key + " (keyRef: "+ System.identityHashCode(key)+ ") in "+ (System.nanoTime() - startTimeNs)+ " ns at "+ System.currentTimeMillis());
    }
    attemptClose(cursor);
  }
}
