{
  if (!isOpen)   throw new PersistenceFailureException("Call to next() on a closed iterator.");
  DatabaseEntry keyEntry=new DatabaseEntry();
  DatabaseEntry valueEntry=new DatabaseEntry();
  try {
    cursor.getNext(keyEntry,valueEntry,LockMode.READ_UNCOMMITTED);
  }
 catch (  DatabaseException e) {
    logger.error(e);
    throw new PersistenceFailureException(e);
  }
  Pair<ByteArray,Versioned<byte[]>> previous=current;
  if (keyEntry.getData() == null)   current=null;
 else   current=getPair(keyEntry,valueEntry);
  return previous;
}
