{
  if (!isOpen)   throw new PersistenceFailureException("Call to next() on a closed iterator.");
  DatabaseEntry keyEntry=new DatabaseEntry();
  DatabaseEntry valueEntry=new DatabaseEntry();
  valueEntry.setPartial(true);
  try {
    cursor.getNextNoDup(keyEntry,valueEntry,LockMode.READ_UNCOMMITTED);
  }
 catch (  DatabaseException e) {
    logger.error(e);
    throw new PersistenceFailureException(e);
  }
  byte[] previous=current;
  if (keyEntry.getData() == null)   current=null;
 else   current=keyEntry.getData();
  return new ByteArray(previous);
}
