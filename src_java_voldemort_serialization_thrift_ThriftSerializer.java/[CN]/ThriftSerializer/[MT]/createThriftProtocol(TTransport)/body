{
  if (this.protocol == ThriftProtocol.BINARY) {
    return new TBinaryProtocol(transport);
  }
 else   if (this.protocol == ThriftProtocol.JSON) {
    return new TJSONProtocol(transport);
  }
 else   if (this.protocol == ThriftProtocol.JSON) {
    return new TSimpleJSONProtocol(transport);
  }
 else {
    throw new IllegalArgumentException("Unknown Thrift Protocol.");
  }
}
