{
  try {
    int partitionId=ByteUtils.readInt(value,ByteUtils.SIZE_OF_INT);
    int chunkId=ReadOnlyUtils.chunk(key,getNumChunks());
    if (getSaveKeys()) {
      int replicaType=(int)ByteUtils.readBytes(value,2 * ByteUtils.SIZE_OF_INT,ByteUtils.SIZE_OF_BYTE);
      if (getReducerPerBucket()) {
        return (partitionId * getStoreDef().getReplicationFactor() + replicaType) % numReduceTasks;
      }
 else {
        return ((partitionId * getStoreDef().getReplicationFactor() * getNumChunks()) + (replicaType * getNumChunks()) + chunkId) % numReduceTasks;
      }
    }
 else {
      if (getReducerPerBucket()) {
        return partitionId % numReduceTasks;
      }
 else {
        return (partitionId * getNumChunks() + chunkId) % numReduceTasks;
      }
    }
  }
 catch (  Exception e) {
    throw new VoldemortException("Caught exception in getPartition()!" + " key: " + ByteUtils.toHexString(key) + ", value: "+ ByteUtils.toHexString(value)+ ", numReduceTasks: "+ numReduceTasks,e);
  }
}
