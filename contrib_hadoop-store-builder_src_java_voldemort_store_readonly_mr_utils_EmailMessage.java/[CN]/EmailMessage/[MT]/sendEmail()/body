{
  checkSettings();
  Properties props=new Properties();
  props.setProperty("mail.transport.protocol","smtp");
  props.put("mail.host",_mailHost);
  props.put("mail.user",_mailUser);
  props.put("mail.password",_mailPassword);
  Session session=Session.getDefaultInstance(props);
  Message message=new MimeMessage(session);
  InternetAddress from=new InternetAddress(_fromAddress,false);
  message.setFrom(from);
  for (  String toAddr : _toAddress)   message.addRecipient(Message.RecipientType.TO,new InternetAddress(toAddr,false));
  message.setSubject(_subject);
  message.setSentDate(new Date());
  if (_attachments.size() > 0) {
    MimeMultipart multipart=new MimeMultipart("related");
    for (    BodyPart part : _attachments) {
      multipart.addBodyPart(part);
    }
    BodyPart messageBodyPart=new MimeBodyPart();
    messageBodyPart.setContent(_body.toString(),_mimeType);
    multipart.addBodyPart(messageBodyPart);
    message.setContent(multipart);
  }
 else {
    message.setContent(_body.toString(),_mimeType);
  }
  Transport transport=session.getTransport();
  transport.connect();
  transport.sendMessage(message,message.getRecipients(Message.RecipientType.TO));
  transport.close();
}
