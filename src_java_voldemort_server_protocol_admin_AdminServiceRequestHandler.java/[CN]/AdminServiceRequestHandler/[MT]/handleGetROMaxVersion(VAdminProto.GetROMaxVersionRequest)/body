{
  final String storeName=request.getStoreName();
  VAdminProto.GetROMaxVersionResponse.Builder response=VAdminProto.GetROMaxVersionResponse.newBuilder();
  try {
    ReadOnlyStorageEngine store=(ReadOnlyStorageEngine)getStorageEngine(storeRepository,storeName);
    File storeDirPath=new File(store.getStoreDirPath());
    if (!storeDirPath.exists())     throw new VoldemortException("Unable to locate the directory of the read-only store " + storeName);
    File[] versionDirs=ReadOnlyUtils.getVersionDirs(storeDirPath);
    File[] kthDir=ReadOnlyUtils.findKthVersionedDir(versionDirs,versionDirs.length - 1,versionDirs.length - 1);
    response.setPushVersion(ReadOnlyUtils.getVersionId(kthDir[0]));
  }
 catch (  VoldemortException e) {
    response.setError(ProtoUtils.encodeError(errorCodeMapper,e));
    logger.error("handleGetROMaxVersion failed for request(" + request.toString() + ")",e);
  }
  return response.build();
}
