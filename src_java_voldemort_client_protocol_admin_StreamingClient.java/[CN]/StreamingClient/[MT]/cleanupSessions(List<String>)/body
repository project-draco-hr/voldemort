{
  commitActionLock.lock();
  logger.info("Performing cleanup");
  for (  String store : storeNamesToCleanUp) {
    for (    Node node : nodesToStream) {
      SocketAndStreams sands=nodeIdStoreToSocketAndStreams.get(new Pair(store,node.getId()));
      close(sands.getSocket());
      SocketDestination destination=nodeIdStoreToSocketRequest.get(new Pair(store,node.getId()));
      streamingSocketPool.checkin(destination,sands);
    }
  }
  cleanedUp=true;
  commitActionLock.unlock();
}
