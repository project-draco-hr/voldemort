{
  if (urlPieces.length < 2) {
    throw new VoldemortException("Invalid request for " + Join.join(".",urlPieces) + ": must specify both a store and key.");
  }
 else   if (urlPieces.length == 2) {
    return Pair.create(ByteArray.EMPTY,urlPieces[urlPieces.length - 1]);
  }
 else {
    String keyStr=urlPieces[urlPieces.length - 1];
    String store=urlPieces[urlPieces.length - 2];
    try {
      byte[] key=ByteUtils.getBytes(keyStr,"UTF-8");
      return Pair.create(new ByteArray(urlCodec.decode(key)),store);
    }
 catch (    DecoderException e) {
      throw new VoldemortException("Corrupt key format.",e);
    }
  }
}
