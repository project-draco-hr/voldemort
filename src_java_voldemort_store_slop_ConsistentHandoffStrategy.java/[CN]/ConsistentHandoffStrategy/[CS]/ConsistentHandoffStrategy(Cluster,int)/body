{
  int nodesInCluster=cluster.getNumberOfNodes();
  if (prefListSize < nodesInCluster - 1)   throw new IllegalArgumentException("Preference list size must be less than " + "number of nodes in the cluster - 1");
  this.random=new Random();
  this.routeToMap=Maps.newHashMapWithExpectedSize(cluster.getNumberOfNodes());
  for (  Node node : cluster.getNodes()) {
    List<Node> prefList=Lists.newArrayListWithCapacity(prefListSize);
    int i=node.getId();
    int n=0;
    while (n < prefListSize) {
      i=(i + 1) % cluster.getNumberOfNodes();
      if (i != node.getId()) {
        prefList.add(cluster.getNodeById(i));
        n++;
      }
    }
    routeToMap.put(i,prefList);
  }
}
