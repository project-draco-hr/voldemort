{
  List<Integer> preferenceList=new ArrayList<Integer>(numReplicas);
  int index=Math.abs(hash.hash(key)) % (Math.max(1,this.partitionToNode.length));
  for (int i=0; i < partitionToNode.length; i++) {
    if (!preferenceList.contains(index))     preferenceList.add(index);
    if (preferenceList.size() >= numReplicas)     return preferenceList;
    index=(index + 1) % partitionToNode.length;
  }
  return preferenceList;
}
