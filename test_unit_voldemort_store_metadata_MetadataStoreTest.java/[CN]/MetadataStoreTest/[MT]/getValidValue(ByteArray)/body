{
  String keyString=ByteUtils.getString(key.get(),"UTF-8");
  if (MetadataStore.CLUSTER_KEY.equals(keyString)) {
    return ByteUtils.getBytes(new ClusterMapper().writeCluster(ServerTestUtils.getLocalCluster(1)),"UTF-8");
  }
 else   if (MetadataStore.STORES_KEY.equals(keyString)) {
    return ByteUtils.getBytes(new StoreDefinitionsMapper().writeStoreList(ServerTestUtils.getStoreDefs(1)),"UTF-8");
  }
 else   if (MetadataStore.SERVER_STATE_KEY.equals(keyString)) {
    int i=(int)(Math.random() * ServerState.values().length);
    return ByteUtils.getBytes(ServerState.values()[i].toString(),"UTF-8");
  }
 else   if (MetadataStore.REBALANCING_PARTITIONS_LIST.equals(keyString)) {
    int size=(int)(Math.random() * 10);
    String partitionsList="";
    for (int i=0; i < size; i++) {
      partitionsList+="" + ((int)Math.random() * 100);
      if (i < size - 1)       partitionsList+=",";
    }
    return ByteUtils.getBytes(partitionsList,"UTF-8");
  }
 else   if (MetadataStore.REBALANCING_PROXY_DEST.equals(keyString)) {
    return ByteUtils.getBytes("" + ((int)Math.random() * 100),"UTF-8");
  }
  throw new RuntimeException("Unhandled key:" + keyString + " passed");
}
