{
  incrementVersionAndPut(metadataStore,MetadataStore.SERVER_STATE_KEY,MetadataStore.VoldemortState.REBALANCING_MASTER_SERVER);
  assertEquals("Values should match.",metadataStore.getServerState(),VoldemortState.REBALANCING_MASTER_SERVER);
  metadataStore.cleanAllRebalancingState();
  assertEquals("Values should match.",metadataStore.getServerState(),VoldemortState.NORMAL_SERVER);
  incrementVersionAndPut(metadataStore,MetadataStore.SERVER_STATE_KEY,MetadataStore.VoldemortState.REBALANCING_MASTER_SWAP_SERVER);
  assertEquals("Values should match.",metadataStore.getServerState(),VoldemortState.REBALANCING_MASTER_SWAP_SERVER);
  metadataStore.cleanAllRebalancingState();
  assertEquals("Values should match.",metadataStore.getServerState(),VoldemortState.NORMAL_SERVER);
}
