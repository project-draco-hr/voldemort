{
  incrementVersionAndPut(metadataStore,MetadataStore.CLUSTER_STATE_KEY,MetadataStore.VoldemortState.REBALANCING_CLUSTER);
  incrementVersionAndPut(metadataStore,MetadataStore.SERVER_STATE_KEY,MetadataStore.VoldemortState.REBALANCING_MASTER_SERVER);
  assertEquals("Values should match.",metadataStore.getClusterState(),VoldemortState.REBALANCING_CLUSTER);
  assertEquals("Values should match.",metadataStore.getServerState(),VoldemortState.REBALANCING_MASTER_SERVER);
  metadataStore.cleanAllRebalancingState();
  assertEquals("Values should match.",metadataStore.getClusterState(),VoldemortState.NORMAL_CLUSTER);
  assertEquals("Values should match.",metadataStore.getServerState(),VoldemortState.NORMAL_SERVER);
}
