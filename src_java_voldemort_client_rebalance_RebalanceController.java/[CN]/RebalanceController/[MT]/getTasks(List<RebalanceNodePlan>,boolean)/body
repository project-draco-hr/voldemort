{
  List<RebalancePartitionsInfo> list=new ArrayList<RebalancePartitionsInfo>();
  for (  RebalanceNodePlan rebalanceNodePlan : rebalanceNodePlanList) {
    for (    final RebalancePartitionsInfo stealInfo : rebalanceNodePlan.getRebalanceTaskList()) {
      List<Integer> stealMasterPartitions=stealInfo.getStealMasterPartitions();
      if (stealMasterPartitions == null) {
        continue;
      }
      if (!stealMasterPartitions.isEmpty() == primaryOnly) {
        list.add(stealInfo);
      }
    }
  }
  return list;
}
