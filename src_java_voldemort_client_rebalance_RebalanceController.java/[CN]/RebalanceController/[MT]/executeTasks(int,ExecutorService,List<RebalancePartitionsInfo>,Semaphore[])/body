{
  List<RebalanceTask> taskList=Lists.newArrayList();
  if (stealerBasedRebalancing) {
    for (    RebalancePartitionsInfo partitionsInfo : rebalancePartitionPlanList) {
      StealerBasedRebalanceTask rebalanceTask=new StealerBasedRebalanceTask(taskId,partitionsInfo,maxTriesRebalancing,donorPermits[partitionsInfo.getDonorId()],adminClient);
      taskList.add(rebalanceTask);
      service.execute(rebalanceTask);
    }
  }
 else {
    HashMap<Integer,List<RebalancePartitionsInfo>> donorNodeBasedPartitionsInfo=RebalanceUtils.groupPartitionsInfoByNode(rebalancePartitionPlanList,false);
    for (    Entry<Integer,List<RebalancePartitionsInfo>> entries : donorNodeBasedPartitionsInfo.entrySet()) {
      DonorBasedRebalanceTask rebalanceTask=new DonorBasedRebalanceTask(taskId,entries.getValue(),donorPermits[entries.getValue().get(0).getDonorId()],adminClient);
      taskList.add(rebalanceTask);
      service.execute(rebalanceTask);
    }
  }
  return taskList;
}
