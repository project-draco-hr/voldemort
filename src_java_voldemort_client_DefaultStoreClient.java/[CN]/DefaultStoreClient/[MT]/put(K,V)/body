{
  Versioned<V> versioned;
  if (inconsistencyResolverRequiresValue) {
    versioned=get(key);
    if (versioned == null)     versioned=new Versioned<V>(value,new VectorClock());
    versioned.setObject(value);
  }
 else {
    Version version=getVersion(key);
    if (version == null)     version=new VectorClock();
    versioned=Versioned.value(value,version);
  }
  put(key,versioned);
}
