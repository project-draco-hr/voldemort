{
  this.storeName=Utils.notNull(storeName);
  this.resolver=resolver;
  this.storeFactory=Utils.notNull(storeFactory);
  this.metadataRefreshAttempts=maxMetadataRefreshAttempts;
  this.clientId=AbstractStoreClientFactory.generateClientId(storeName,clientContext,clientSequence);
  this.config=config;
  JmxUtils.registerMbean(this,JmxUtils.createObjectName(JmxUtils.getPackageName(this.getClass()),JmxUtils.getClassName(this.getClass()) + "." + clientContext+ "."+ storeName+ "."+ clientId.toString()));
  bootStrap();
  sysStoreMap=new HashMap<String,SystemStore>();
  initializeSystemStores();
  if (config != null) {
    SystemStore versionStore=this.sysStoreMap.get(METADATA_VERSION_STORE);
    if (versionStore == null)     logger.info("Metadata version system store not found. Cannot run Metadata version check thread.");
 else {
      Callable<Void> bootstrapCallback=new Callable<Void>(){
        public Void call() throws Exception {
          bootStrap();
          return null;
        }
      }
;
      asyncCheckMetadata=new AsyncMetadataVersionManager(versionStore,config.getAsyncCheckMetadataInterval(),bootstrapCallback);
      logger.info("Metadata version check thread started. Frequency = Every " + config.getAsyncCheckMetadataInterval() + " ms");
    }
  }
  logger.info("Voldemort client created: clientContext=" + clientContext + " clientSequence="+ clientSequence+ " clientId="+ clientId.toString());
}
