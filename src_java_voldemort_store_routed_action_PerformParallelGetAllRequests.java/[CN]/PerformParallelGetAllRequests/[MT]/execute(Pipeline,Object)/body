{
  pipelineData.setAttempts(pipelineData.getNodeToKeysMap().size());
  if (logger.isTraceEnabled())   logger.trace("Attempting " + pipelineData.getAttempts() + " "+ pipeline.getOperation().getSimpleName()+ " operations in parallel");
  if (preferred <= 0 && completeEvent != null)   pipeline.addEvent(completeEvent);
  for (  Map.Entry<Node,List<ByteArray>> entry : pipelineData.getNodeToKeysMap().entrySet()) {
    Node node=entry.getKey();
    Collection<ByteArray> keys=entry.getValue();
    NonblockingStoreCallback callback=new BasicResponseCallback<Iterable<ByteArray>>(pipeline,node,keys);
    if (logger.isTraceEnabled())     logger.trace("Submitting request to getAll on node " + node.getId());
    NonblockingStore store=nonblockingStores.get(node.getId());
    store.submitGetAllRequest(keys,callback);
  }
}
