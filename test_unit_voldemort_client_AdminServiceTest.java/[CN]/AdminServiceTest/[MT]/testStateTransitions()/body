{
  AdminClientRequestFormat client=getAdminClient();
  client.changeServerState(server.getIdentityNode().getId(),VoldemortMetadata.ServerState.REBALANCING_STEALER_STATE);
  VoldemortMetadata.ServerState state=server.getVoldemortMetadata().getServerState();
  assertEquals("State should be changed correctly to rebalancing state",VoldemortMetadata.ServerState.REBALANCING_STEALER_STATE,state);
  client.changeServerState(server.getIdentityNode().getId(),VoldemortMetadata.ServerState.NORMAL_STATE);
  state=server.getVoldemortMetadata().getServerState();
  assertEquals("State should be changed correctly to rebalancing state",VoldemortMetadata.ServerState.NORMAL_STATE,state);
  client.changeServerState(server.getIdentityNode().getId(),VoldemortMetadata.ServerState.REBALANCING_DONOR_STATE);
  state=server.getVoldemortMetadata().getServerState();
  assertEquals("State should be changed correctly to rebalancing state",VoldemortMetadata.ServerState.REBALANCING_DONOR_STATE,state);
  try {
    client.changeServerState(server.getIdentityNode().getId(),VoldemortMetadata.ServerState.REBALANCING_STEALER_STATE);
    fail("We should not be able to change state from DONATE to Stealer");
  }
 catch (  VoldemortException e) {
  }
  client.changeServerState(server.getIdentityNode().getId(),VoldemortMetadata.ServerState.NORMAL_STATE);
  state=server.getVoldemortMetadata().getServerState();
  assertEquals("State should be changed correctly to rebalancing state",VoldemortMetadata.ServerState.NORMAL_STATE,state);
}
