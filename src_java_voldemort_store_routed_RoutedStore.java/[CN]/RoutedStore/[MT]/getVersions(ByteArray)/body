{
  StoreUtils.assertValidKey(key);
  BasicPipelineData pipelineData=new BasicPipelineData();
  final Pipeline pipeline=new Pipeline(Operation.GET_VERSIONS);
  NonblockingStoreRequest storeRequest=new NonblockingStoreRequest(){
    public void request(    Node node,    NonblockingStore store){
      final NonblockingStoreCallback callback=new PipelineEventNonblockingStoreCallback(pipeline,node,key);
      store.submitGetVersionsRequest(key,callback);
    }
  }
;
  Action configureNodes=new ConfigureNodes(pipelineData,Event.CONFIGURED,failureDetector,storeDef.getRequiredReads(),routingStrategy,key);
  Action performRequests=new PerformParallelRequests(pipelineData,Event.NOP,storeDef.getPreferredReads(),nonblockingStores,storeRequest);
  Action acknowledgeResponse=new AcknowledgeResponse(pipelineData,Event.COMPLETED,failureDetector,storeDef.getPreferredReads(),storeDef.getRequiredReads(),null);
  Action updateResults=new UpdateResults(pipelineData);
  Map<Event,Action> eventActions=new HashMap<Event,Action>();
  eventActions.put(Event.STARTED,configureNodes);
  eventActions.put(Event.CONFIGURED,performRequests);
  eventActions.put(Event.RESPONSE_RECEIVED,acknowledgeResponse);
  eventActions.put(Event.COMPLETED,updateResults);
  pipeline.setEventActions(eventActions);
  pipeline.addEvent(Event.STARTED);
  pipeline.processEvents(timeoutMs,TimeUnit.MILLISECONDS);
  List<Version> results=pipelineData.get();
  return results;
}
