{
  StoreUtils.assertValidKey(key);
  BasicPipelineData<List<Versioned<byte[]>>> pipelineData=new BasicPipelineData<List<Versioned<byte[]>>>();
  final Pipeline pipeline=new Pipeline(Operation.GET);
  NonblockingStoreRequest nonblockingStoreRequest=new NonblockingStoreRequest(){
    public void request(    Node node,    NonblockingStore store){
      NonblockingStoreCallback callback=new BasicResponseCallback<ByteArray>(pipeline,node,key);
      store.submitGetRequest(key,callback);
    }
  }
;
  StoreRequest<List<Versioned<byte[]>>> blockingStoreRequest=new StoreRequest<List<Versioned<byte[]>>>(){
    public List<Versioned<byte[]>> request(    Store<ByteArray,byte[]> store){
      return store.get(key);
    }
  }
;
  Action configureNodes=new ConfigureNodes<List<Versioned<byte[]>>,BasicPipelineData<List<Versioned<byte[]>>>>(pipelineData,Event.CONFIGURED,failureDetector,storeDef.getRequiredReads(),routingStrategy,key);
  Action performRequests=new PerformParallelRequests<List<Versioned<byte[]>>,BasicPipelineData<List<Versioned<byte[]>>>>(pipelineData,Event.COMPLETED,storeDef.getPreferredReads(),nonblockingStores,nonblockingStoreRequest);
  Action acknowledgeResponse=new AcknowledgeResponse<List<Versioned<byte[]>>,BasicPipelineData<List<Versioned<byte[]>>>>(pipelineData,repairReads ? Event.RESPONSES_RECEIVED : Event.COMPLETED,failureDetector,storeDef.getPreferredReads(),storeDef.getRequiredReads(),Event.INSUFFICIENT_SUCCESSES);
  Action performSerialRequests=new PerformSerialRequests<List<Versioned<byte[]>>,BasicPipelineData<List<Versioned<byte[]>>>>(pipelineData,repairReads ? Event.RESPONSES_RECEIVED : Event.COMPLETED,key,failureDetector,innerStores,storeDef.getPreferredReads(),storeDef.getRequiredReads(),blockingStoreRequest,null);
  Map<Event,Action> eventActions=new HashMap<Event,Action>();
  eventActions.put(Event.STARTED,configureNodes);
  eventActions.put(Event.CONFIGURED,performRequests);
  eventActions.put(Event.RESPONSE_RECEIVED,acknowledgeResponse);
  if (repairReads) {
    Action readRepair=new ReadRepair<BasicPipelineData<List<Versioned<byte[]>>>>(pipelineData,Event.COMPLETED,storeDef.getPreferredReads(),nonblockingStores,readRepairer);
    eventActions.put(Event.RESPONSES_RECEIVED,readRepair);
  }
  eventActions.put(Event.INSUFFICIENT_SUCCESSES,performSerialRequests);
  pipeline.setEventActions(eventActions);
  pipeline.addEvent(Event.STARTED);
  pipeline.processEvents(timeoutMs,TimeUnit.MILLISECONDS);
  if (pipelineData.getFatalError() != null)   throw pipelineData.getFatalError();
  List<Versioned<byte[]>> results=new ArrayList<Versioned<byte[]>>();
  for (  Response<ByteArray,List<Versioned<byte[]>>> response : pipelineData.getResponses()) {
    List<Versioned<byte[]>> value=response.getValue();
    if (value != null)     results.addAll(value);
  }
  return results;
}
