{
  StoreUtils.assertValidKey(key);
  BasicPipelineData<Boolean> pipelineData=new BasicPipelineData<Boolean>();
  final Pipeline pipeline=new Pipeline(Operation.DELETE);
  NonblockingStoreRequest nonblockingDelete=new NonblockingStoreRequest(){
    public void request(    Node node,    NonblockingStore store){
      NonblockingStoreCallback callback=new BasicResponseCallback<ByteArray>(pipeline,node,key);
      store.submitDeleteRequest(key,version,callback);
    }
  }
;
  BlockingStoreRequest<Boolean> blockingDelete=new BlockingStoreRequest<Boolean>(){
    public Boolean request(    Node node,    Store<ByteArray,byte[]> store){
      return store.delete(key,version);
    }
  }
;
  Action configureNodes=new ConfigureNodes<Boolean,BasicPipelineData<Boolean>>(pipelineData,Event.CONFIGURED,failureDetector,storeDef.getRequiredWrites(),routingStrategy,key);
  Action performRequests=new PerformParallelRequests<Boolean,BasicPipelineData<Boolean>>(pipelineData,Event.NOP,storeDef.getPreferredWrites(),nonblockingStores,nonblockingDelete);
  Action acknowledgeResponse=new AcknowledgeResponse<Boolean,BasicPipelineData<Boolean>>(pipelineData,Event.COMPLETED,failureDetector,storeDef.getPreferredWrites(),storeDef.getRequiredWrites(),Event.INSUFFICIENT_SUCCESSES);
  Action performSerialRequests=new PerformSerialRequests<Boolean,BasicPipelineData<Boolean>>(pipelineData,Event.COMPLETED,key,failureDetector,innerStores,storeDef.getPreferredWrites(),storeDef.getRequiredWrites(),blockingDelete,null);
  Map<Event,Action> eventActions=new HashMap<Event,Action>();
  eventActions.put(Event.STARTED,configureNodes);
  eventActions.put(Event.CONFIGURED,performRequests);
  eventActions.put(Event.RESPONSE_RECEIVED,acknowledgeResponse);
  eventActions.put(Event.INSUFFICIENT_SUCCESSES,performSerialRequests);
  pipeline.setEventActions(eventActions);
  pipeline.addEvent(Event.STARTED);
  pipeline.processEvents(timeoutMs,TimeUnit.MILLISECONDS);
  if (pipelineData.getFatalError() != null)   throw pipelineData.getFatalError();
  for (  Response<ByteArray,Boolean> response : pipelineData.getResponses()) {
    if (response.getValue().booleanValue())     return true;
  }
  return false;
}
