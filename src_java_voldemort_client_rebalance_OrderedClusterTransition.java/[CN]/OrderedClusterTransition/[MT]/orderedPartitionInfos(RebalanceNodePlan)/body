{
  List<RebalancePartitionsInfo> listPrimaries=new ArrayList<RebalancePartitionsInfo>();
  List<RebalancePartitionsInfo> listReplicas=new ArrayList<RebalancePartitionsInfo>();
  List<RebalancePartitionsInfo> partitionInfos=rebalanceNodePlan.getRebalanceTaskList();
  for (  RebalancePartitionsInfo partitionInfo : partitionInfos) {
    List<Integer> stealMasterPartitions=partitionInfo.getStealMasterPartitions();
    if (stealMasterPartitions != null && !stealMasterPartitions.isEmpty()) {
      listPrimaries.add(partitionInfo);
    }
 else {
      listReplicas.add(partitionInfo);
    }
  }
  listPrimaries.addAll(listReplicas);
  return listPrimaries;
}
