{
  Queue<RebalanceNodePlan> rebalancingTaskQueue=rebalanceClusterPlan.getRebalancingTaskQueue();
  RebalanceNodePlan[] array=new RebalanceNodePlan[rebalancingTaskQueue.size()];
  rebalancingTaskQueue.toArray(array);
  List<RebalanceNodePlan> plans=new ArrayList<RebalanceNodePlan>();
  for (  RebalanceNodePlan rebalanceNodePlan : rebalancingTaskQueue) {
    List<RebalancePartitionsInfo> orderedRebalancePartitionsInfos=orderedPartitionInfos(rebalanceNodePlan);
    plans.add(new RebalanceNodePlan(rebalanceNodePlan.getStealerNode(),orderedRebalancePartitionsInfos));
  }
  return orderedNodePlans(plans);
}
