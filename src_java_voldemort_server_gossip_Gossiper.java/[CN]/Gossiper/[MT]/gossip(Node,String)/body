{
  if (logger.isDebugEnabled())   logger.debug(metadataStore.getNodeId() + " pulling " + key+ " from "+ node);
  Versioned<String> remoteVersioned=adminClient.getRemoteMetadata(node.getId(),key);
  Versioned<String> localVersioned=adminClient.getRemoteMetadata(metadataStore.getNodeId(),key);
  Version localVersion=localVersioned.getVersion();
  Version remoteVersion=remoteVersioned.getVersion();
switch (remoteVersion.compare(localVersion)) {
case AFTER:
{
      VectorClock remoteVectorClock=(VectorClock)remoteVersion;
      VectorClock localVectorClock=(VectorClock)localVersion;
      adminClient.updateRemoteMetadata(metadataStore.getNodeId(),key,remoteVersioned);
      logger.info("My " + key + " occured BEFORE the key from "+ node+ ". Accepted theirs.");
      break;
    }
case BEFORE:
{
    break;
  }
case CONCURRENTLY:
{
  logger.error("My " + key + " occured CONCURRENTLY. My value: "+ localVersioned+ "; Their value "+ remoteVersioned);
  break;
}
}
}
