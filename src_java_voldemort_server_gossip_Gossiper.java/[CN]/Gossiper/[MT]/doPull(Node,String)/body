{
  logger.info(metadataStore.getNodeId() + " pulling " + key+ " from "+ node);
  Versioned<String> remoteVersioned=adminClient.getRemoteMetadata(node.getId(),key);
  Versioned<String> localVersioned=adminClient.getRemoteMetadata(metadataStore.getNodeId(),key);
  Version localVersion=localVersioned.getVersion();
  Version remoteVersion=remoteVersioned.getVersion();
switch (localVersion.compare(remoteVersion)) {
case BEFORE:
{
      VectorClock remoteVectorClock=(VectorClock)remoteVersion;
      VectorClock localVectorClock=(VectorClock)localVersion;
      if (localVectorClock.getTimestamp() < remoteVectorClock.getTimestamp()) {
        adminClient.updateRemoteMetadata(metadataStore.getNodeId(),key,remoteVersioned);
        logger.info("My " + key + " occured BEFORE the key from "+ node+ ". Accepted theirs.");
      }
      break;
    }
case AFTER:
{
    break;
  }
case CONCURRENTLY:
{
  logger.error("My " + key + " occured CONCURRENTLY. My value: "+ localVersioned+ "; Their value "+ remoteVersioned);
  break;
}
}
}
