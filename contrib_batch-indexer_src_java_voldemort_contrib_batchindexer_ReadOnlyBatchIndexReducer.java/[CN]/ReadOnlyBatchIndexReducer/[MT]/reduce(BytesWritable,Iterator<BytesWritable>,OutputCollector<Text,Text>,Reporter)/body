{
  byte[] keyBytes=ByteUtils.copy(key.get(),0,key.getSize());
  while (values.hasNext()) {
    BytesWritable value=values.next();
    byte[] valBytes=ByteUtils.copy(value.get(),0,value.getSize());
    if (nodeId == -1) {
      DataInputStream buffer=new DataInputStream(new ByteArrayInputStream(valBytes));
      nodeId=buffer.readInt();
    }
    byte[] value1=ByteUtils.copy(valBytes,4,valBytes.length);
    indexFileStream.write(keyBytes);
    indexFileStream.writeLong(position);
    valueFileStream.writeInt(value1.length);
    valueFileStream.write(value1);
    position+=value1.length + 4;
    if (position < 0) {
      throw new RuntimeException("Position bigger than Integer size, split input files.");
    }
  }
}
