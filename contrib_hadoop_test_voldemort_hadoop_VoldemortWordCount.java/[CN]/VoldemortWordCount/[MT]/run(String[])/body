{
  if (args.length != 2) {
    Utils.croak("USAGE: java VoldemortWordCount store_name adminclient_bootstrap_url");
  }
  Configuration conf=getConf();
  Class[] deps=new Class[]{voldemort.cluster.Node.class,voldemort.hadoop.VoldemortInputSplit.class,voldemort.hadoop.VoldemortInputFormat.class,voldemort.hadoop.VoldemortHadoopConfig.class,com.google.protobuf.Message.class,org.jdom.Content.class,com.google.common.collect.ImmutableList.class,org.apache.commons.io.IOUtils.class,org.apache.hadoop.mapreduce.RecordReader.class};
  String storeName=args[0];
  String url=args[1];
  Job job=new Job(conf,"wordcount");
  job.setJarByClass(getClass());
  job.setMapperClass(SimpleTokenizer.class);
  job.setCombinerClass(IntSumReducer.class);
  job.setReducerClass(IntSumReducer.class);
  job.setOutputKeyClass(Text.class);
  job.setOutputValueClass(IntWritable.class);
  addDepJars(job.getConfiguration(),deps);
  job.setInputFormatClass(VoldemortInputFormat.class);
  FileOutputFormat.setOutputPath(job,new Path("wordcount" + System.nanoTime()));
  VoldemortHadoopConfig.setVoldemortURL(job.getConfiguration(),url);
  VoldemortHadoopConfig.setVoldemortStoreName(job.getConfiguration(),storeName);
  job.waitForCompletion(true);
  return 0;
}
