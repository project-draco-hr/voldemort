{
  ByteBuffer buffer=inputStream.getBuffer();
  if (logger.isTraceEnabled())   logInputBufferState("Incomplete read request detected, before update");
  if (newPosition != -1)   buffer.position(newPosition);
  buffer.limit(buffer.capacity());
  if (logger.isTraceEnabled())   logInputBufferState("Incomplete read request detected, after update");
  if (!buffer.hasRemaining()) {
    inputStream.setBuffer(ByteUtils.expand(buffer,buffer.capacity() * 2));
    if (logger.isTraceEnabled())     logInputBufferState("Expanded input buffer");
  }
}
