{
  Accumulator accum=values.get();
  long now=System.currentTimeMillis();
  if (now - accum.startTimeMS > durationMS) {
    Accumulator newWithTotal=accum.newWithTotal();
    while (true) {
      if (values.compareAndSet(accum,newWithTotal)) {
        return newWithTotal;
      }
    }
  }
 else {
    return accum;
  }
}
