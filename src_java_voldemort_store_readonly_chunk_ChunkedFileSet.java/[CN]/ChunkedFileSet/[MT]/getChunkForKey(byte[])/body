{
switch (storageFormat) {
case READONLY_V0:
{
      return ReadOnlyUtils.chunk(ByteUtils.md5(key),numChunks);
    }
case READONLY_V1:
{
    List<Integer> routingPartitionList=routingStrategy.getPartitionList(key);
    routingPartitionList.retainAll(partitionIds);
    if (routingPartitionList.size() != 1) {
      return -1;
    }
    return chunkIdToChunkStart.get(routingPartitionList.get(0)) + ReadOnlyUtils.chunk(ByteUtils.md5(key),chunkIdToNumChunks.get(routingPartitionList.get(0)));
  }
case READONLY_V2:
{
  List<Integer> routingPartitionList=routingStrategy.getPartitionList(key);
  int replicaType=-1, partitionIdsIndex=-1;
  for (int index=0; index < partitionIds.size(); index++) {
    int partition=partitionIds.get(index);
    if (routingPartitionList.contains(partition)) {
      if (replicaType == -1) {
        partitionIdsIndex=index;
        replicaType=routingPartitionList.indexOf(partition);
      }
 else {
        return -1;
      }
    }
  }
  if (replicaType == -1)   return -1;
  return chunkIdToChunkStart.get(partitionIdsIndex * routingStrategy.getNumReplicas() + replicaType) + ReadOnlyUtils.chunk(ByteUtils.md5(key),chunkIdToNumChunks.get(partitionIdsIndex * routingStrategy.getNumReplicas() + replicaType));
}
default :
{
return -1;
}
}
}
