{
  byte[] keyBytes=keySerializer.toBytes(makeKey(key,value));
  byte[] valBytes=valueSerializer.toBytes(makeValue(key,value));
  byte[] nodeIdAndValue=new byte[valBytes.length + 4];
  System.arraycopy(valBytes,0,nodeIdAndValue,4,valBytes.length);
  BytesWritable outputKey=new BytesWritable(md5er.digest(keyBytes));
  List<Node> nodes=routingStrategy.routeRequest(keyBytes);
  for (  Node node : nodes) {
    ByteUtils.writeInt(nodeIdAndValue,node.getId(),0);
    BytesWritable outputVal=new BytesWritable(nodeIdAndValue);
    output.collect(outputKey,outputVal);
  }
  md5er.reset();
}
