{
  byte[] keyBytes=keySerializer.toBytes(makeKey(key,value));
  byte[] valBytes=valueSerializer.toBytes(makeValue(key,value));
  List<Node> nodes=routingStrategy.routeRequest(keyBytes);
  for (  Node node : nodes) {
    ByteArrayOutputStream versionedValue=new ByteArrayOutputStream(keyBytes.length + 4);
    DataOutputStream valueStream=new DataOutputStream(versionedValue);
    valueStream.writeInt(node.getId());
    valueStream.write(valBytes);
    valueStream.close();
    BytesWritable outputKey=new BytesWritable(ByteUtils.md5(keyBytes));
    BytesWritable outputVal=new BytesWritable(versionedValue.toByteArray());
    output.collect(outputKey,outputVal);
  }
}
