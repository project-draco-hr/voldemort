{
  byte[] keyBytes=keySerializer.toBytes(makeKey(key,value));
  byte[] valBytes=valueSerializer.toBytes(makeValue(key,value));
  MapperKeyValueWriter mapWriter=new MapperKeyValueWriter();
  List mapperList=mapWriter.map(routingStrategy,keySerializer,valueSerializer,valueCompressor,keyCompressor,keySerializerDefinition,valueSerializerDefinition,keyBytes,valBytes,getSaveKeys(),md5er);
  for (int i=0; i < mapperList.size(); i++) {
    voldemort.utils.Pair<BytesWritable,BytesWritable> pair=(voldemort.utils.Pair<BytesWritable,BytesWritable>)mapperList.get(i);
    BytesWritable outputKey=pair.getFirst();
    BytesWritable outputVal=pair.getSecond();
    output.collect(outputKey,outputVal);
  }
  md5er.reset();
}
