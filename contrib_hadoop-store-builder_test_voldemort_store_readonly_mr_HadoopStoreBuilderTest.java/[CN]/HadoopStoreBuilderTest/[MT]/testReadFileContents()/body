{
  Path testPath=new Path(TestUtils.createTempDir().getAbsolutePath(),"tempFile");
  FileSystem fs=testPath.getFileSystem(new Configuration());
  fs.create(testPath);
  String emptyString=ReadOnlyUtils.readFileContents(fs,testPath,1024);
  Assert.assertEquals(emptyString.length(),0);
  byte[] randomBytes=TestUtils.randomBytes(10);
  FileOutputStream stream=new FileOutputStream(testPath.toString());
  stream.write(randomBytes);
  stream.close();
  Assert.assertEquals(ReadOnlyUtils.readFileContents(fs,testPath,1024),new String(randomBytes));
  fs.delete(testPath,true);
  fs.create(testPath);
  ReadOnlyStorageMetadata metadata=new ReadOnlyStorageMetadata();
  metadata.add(ReadOnlyStorageMetadata.FORMAT,ReadOnlyStorageFormat.READONLY_V2.getCode());
  stream=new FileOutputStream(testPath.toString());
  stream.write(metadata.toJsonString().getBytes());
  stream.close();
  ReadOnlyStorageMetadata readMetadata=new ReadOnlyStorageMetadata(ReadOnlyUtils.readFileContents(fs,testPath,1024));
  Assert.assertEquals(readMetadata.get(ReadOnlyStorageMetadata.FORMAT),ReadOnlyStorageFormat.READONLY_V2.getCode());
}
