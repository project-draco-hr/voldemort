{
  this.storeRepository=storeRepository;
  performanceStats=new StoreStats();
  this.threadPoolExecutor=new ThreadPoolExecutor(numStorageThreads,numStorageThreads,0L,TimeUnit.MILLISECONDS,new LinkedBlockingQueue<Runnable>(threadPoolQueueSize),threadFactory);
  storageExecutionHandler=new StorageExecutionHandler(threadPoolExecutor,performanceStats,localZoneId);
  connectionStats=new NettyConnectionStats();
  connectionStatsHandler=new NettyConnectionStatsHandler(connectionStats);
  if (jmxEnabled) {
    JmxUtils.registerMbean(this.storageExecutionHandler,JmxUtils.createObjectName(JmxUtils.getPackageName(this.storageExecutionHandler.getClass()),JmxUtils.getClassName(this.storageExecutionHandler.getClass())));
    JmxUtils.registerMbean(this.connectionStats,JmxUtils.createObjectName(JmxUtils.getPackageName(this.connectionStats.getClass()),JmxUtils.getClassName(this.connectionStats.getClass())));
    JmxUtils.registerMbean(new StoreStatsJmx(this.performanceStats),JmxUtils.createObjectName(JmxUtils.getPackageName(this.performanceStats.getClass()),JmxUtils.getClassName(this.performanceStats.getClass())));
  }
}
