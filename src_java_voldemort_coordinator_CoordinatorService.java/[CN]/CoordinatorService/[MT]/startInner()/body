{
  ClientConfig clientConfig=new ClientConfig();
  clientConfig.setBootstrapUrls(this.config.getBootstrapURLs());
  storeClientFactory=new SocketStoreClientFactory(clientConfig);
  initializeFatClients();
  SystemStoreRepository sysRepository=new SystemStoreRepository();
  String clusterXml=storeClientFactory.bootstrapMetadataWithRetries(MetadataStore.CLUSTER_KEY);
  sysRepository.createSystemStores(clientConfig,clusterXml,storeClientFactory.getFailureDetector());
  Callable<Void> rebootstrapCallback=new Callable<Void>(){
    @Override public Void call() throws Exception {
      initializeFatClients();
      return null;
    }
  }
;
  asyncMetadataManager=new AsyncMetadataVersionManager(sysRepository,rebootstrapCallback,null);
  schedulerService=new SchedulerService(1,SystemTime.INSTANCE,true);
  schedulerService.schedule(asyncMetadataManager.getClass().getName(),asyncMetadataManager,new Date(),this.config.getMetadataCheckIntervalInMs());
  ServerBootstrap bootstrap=new ServerBootstrap(new NioServerSocketChannelFactory(Executors.newCachedThreadPool(),Executors.newCachedThreadPool()));
  bootstrap.setOption("backlog",1000);
  bootstrap.setPipelineFactory(new CoordinatorPipelineFactory(fatClientMap,noop));
  bootstrap.bind(new InetSocketAddress(8080));
}
