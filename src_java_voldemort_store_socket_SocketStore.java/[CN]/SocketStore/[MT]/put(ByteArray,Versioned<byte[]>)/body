{
  StoreUtils.assertValidKey(key);
  SocketAndStreams sands=pool.checkout(destination);
  try {
    DataOutputStream outputStream=sands.getOutputStream();
    outputStream.writeByte(VoldemortOpCode.PUT_OP_CODE);
    outputStream.writeUTF(name);
    outputStream.writeInt(key.length());
    outputStream.write(key.get());
    VectorClock clock=(VectorClock)value.getVersion();
    outputStream.writeInt(value.getValue().length + clock.sizeInBytes());
    outputStream.write(clock.toBytes());
    outputStream.write(value.getValue());
    outputStream.flush();
    DataInputStream inputStream=sands.getInputStream();
    checkException(inputStream);
  }
 catch (  IOException e) {
    close(sands.getSocket());
    throw new UnreachableStoreException("Failure in put on " + destination + ": "+ e.getMessage(),e);
  }
 finally {
    pool.checkin(destination,sands);
  }
}
