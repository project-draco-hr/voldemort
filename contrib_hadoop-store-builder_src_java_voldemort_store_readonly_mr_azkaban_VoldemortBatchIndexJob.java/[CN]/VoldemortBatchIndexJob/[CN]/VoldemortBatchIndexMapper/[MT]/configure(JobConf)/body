{
  Props props=HadoopUtils.getPropsFromJob(conf);
  try {
    _cluster=HadoopUtils.readCluster(props.get("voldemort.cluster.file"),conf);
    _storeDef=HadoopUtils.readStoreDef(props.get("voldemort.store.file"),props.get("voldemort.store.name"),conf);
    _checkPercent=conf.getInt("input.data.check.percent",0);
    _routingStrategy=new ConsistentRoutingStrategy(_cluster,_storeDef.getReplicationFactor());
    _keySerializer=(Serializer<Object>)new DefaultSerializerFactory().getSerializer(_storeDef.getKeySerializer());
    _valueSerializer=(Serializer<Object>)new DefaultSerializerFactory().getSerializer(_storeDef.getValueSerializer());
    _version=_storeDef.getKeySerializer().getCurrentSchemaVersion();
    _routingStrategy=new ConsistentRoutingStrategy(_cluster,_storeDef.getReplicationFactor());
    if (_routingStrategy == null) {
      throw new RuntimeException("Failed to create routing strategy");
    }
  }
 catch (  Exception e) {
    logger.error("Failed to read Voldemort cluster/storeDef details",e);
    throw new RuntimeException("",e);
  }
}
