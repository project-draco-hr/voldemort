{
  while (true) {
    if (stack.size() > 0)     return stack.pop();
    if (!iter.hasNext())     return endOfData();
    File file=iter.next();
    try {
synchronized (lockFor(file.getAbsolutePath())) {
        FsKeyAndValues kv=FsKeyAndValues.read(file);
        if (kv != null) {
          for (          Versioned<byte[]> v : kv.getValues())           stack.push(Pair.create(kv.getKey(),v));
        }
      }
    }
 catch (    IOException e) {
      throw new VoldemortException("Error in iteration.",e);
    }
  }
}
