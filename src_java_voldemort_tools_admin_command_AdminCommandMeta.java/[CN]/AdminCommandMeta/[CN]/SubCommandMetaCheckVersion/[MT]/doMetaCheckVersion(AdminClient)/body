{
  Map<Properties,List<Integer>> versionsNodeMap=new HashMap<Properties,List<Integer>>();
  for (  Integer nodeId : adminClient.getAdminClientCluster().getNodeIds()) {
    Properties props=doMetaGetVersionsForNode_ExitOnError(adminClient,nodeId);
    if (versionsNodeMap.containsKey(props) == false) {
      versionsNodeMap.put(props,new ArrayList<Integer>());
    }
    versionsNodeMap.get(props).add(nodeId);
  }
  if (versionsNodeMap.keySet().size() <= 0) {
    System.err.println("No Versions found in the system store... something seriously wrong");
  }
 else   if (versionsNodeMap.keySet().size() == 1) {
    System.err.println("All the nodes have the same metadata versions.");
    printProperties(versionsNodeMap.keySet().iterator().next());
  }
 else {
    System.err.println("Mismatching versions detected !!!");
    for (    Entry<Properties,List<Integer>> entry : versionsNodeMap.entrySet()) {
      System.out.println("**************************** Node(s): " + Arrays.toString(entry.getValue().toArray()) + " ****************************");
      printProperties(entry.getKey());
    }
  }
}
