{
  Map<Properties,Integer> versionsNodeMap=new HashMap<Properties,Integer>();
  for (  Integer nodeId : adminClient.getAdminClientCluster().getNodeIds()) {
    Properties props=null;
    try {
      props=doMetaGetVersionsForNode(adminClient,nodeId);
    }
 catch (    IOException e) {
      System.err.println("Error while retrieving Metadata versions from node : " + nodeId + ". Exception = "+ e.getMessage()+ " \n");
      e.printStackTrace();
      System.exit(-1);
    }
    versionsNodeMap.put(props,nodeId);
  }
  if (versionsNodeMap.keySet().size() > 1) {
    System.err.println("Mismatching versions detected !!!");
    for (    Entry<Properties,Integer> entry : versionsNodeMap.entrySet()) {
      System.out.println("**************************** Node: " + entry.getValue() + " ****************************");
      System.out.println(entry.getKey());
    }
  }
 else {
    System.err.println("All the nodes have the same metadata versions." + Arrays.toString(versionsNodeMap.keySet().toArray()));
  }
}
