{
  Node node=this.getAdminClientCluster().getNodeById(nodeId);
  ClientConfig clientConfig=new ClientConfig();
  final Store<ByteArray,byte[],byte[]> store;
  final ClientRequestExecutorPool clientPool=new ClientRequestExecutorPool(clientConfig.getSelectors(),clientConfig.getMaxConnectionsPerNode(),clientConfig.getConnectionTimeout(TimeUnit.MILLISECONDS),clientConfig.getSocketTimeout(TimeUnit.MILLISECONDS),clientConfig.getSocketBufferSize(),clientConfig.getSocketKeepAlive());
  try {
    store=clientPool.create(storeName,node.getHost(),node.getSocketPort(),clientConfig.getRequestFormatType(),RequestRoutingType.IGNORE_CHECKS);
  }
 catch (  Exception e) {
    clientPool.close();
    throw new VoldemortException(e);
  }
  return new AbstractIterator<Pair<ByteArray,Pair<List<Versioned<byte[]>>,Exception>>>(){
    @Override public Pair<ByteArray,Pair<List<Versioned<byte[]>>,Exception>> computeNext(){
      ByteArray key;
      Exception exception=null;
      List<Versioned<byte[]>> value=null;
      if (!keys.hasNext()) {
        clientPool.close();
        return endOfData();
      }
 else {
        key=keys.next();
      }
      try {
        value=store.get(key,null);
      }
 catch (      Exception e) {
        exception=e;
      }
      return Pair.create(key,Pair.create(value,exception));
    }
  }
;
}
