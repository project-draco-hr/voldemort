{
  Map<Integer,Integer> partitionToNodeId=RebalanceUtils.getCurrentPartitionMapping(cluster);
  int nodeId=-1;
  int replicaType=-1;
  int partition=-1;
  boolean found=false;
  int index=0;
  while (!found && index < remainderPartitions.size()) {
    replicaType=originalPartitions.indexOf(remainderPartitions.get(index));
    partition=originalPartitions.get(0);
    nodeId=partitionToNodeId.get(remainderPartitions.get(index));
    if (-1 == zoneId || cluster.getNodeById(nodeId).getZoneId() == zoneId) {
      found=true;
    }
 else {
      index++;
    }
  }
  if (!found) {
    throw new VoldemortException("unable to find a node to fetch partition " + partition + " of replica type "+ replicaType+ " for store "+ storeDef.getName());
  }
  HashMap<Integer,List<Integer>> replicaToPartitionList=null;
  if (donorMap.containsKey(nodeId)) {
    replicaToPartitionList=donorMap.get(nodeId);
  }
 else {
    replicaToPartitionList=Maps.newHashMap();
    donorMap.put(nodeId,replicaToPartitionList);
  }
  List<Integer> partitions=null;
  if (replicaToPartitionList.containsKey(replicaType)) {
    partitions=replicaToPartitionList.get(replicaType);
  }
 else {
    partitions=Lists.newArrayList();
    replicaToPartitionList.put(replicaType,partitions);
  }
  partitions.add(partition);
}
