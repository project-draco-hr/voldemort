{
  VAdminProto.GetROMetadataRequest.Builder getROMaxVersionDirRequest=VAdminProto.GetROMetadataRequest.newBuilder().addAllStoreName(storeNames).setType(type);
  VAdminProto.VoldemortAdminRequest adminRequest=VAdminProto.VoldemortAdminRequest.newBuilder().setGetRoMetadata(getROMaxVersionDirRequest).setType(VAdminProto.AdminRequestType.GET_RO_METADATA).build();
  VAdminProto.GetROMetadataResponse.Builder response=sendAndReceive(nodeId,adminRequest,VAdminProto.GetROMetadataResponse.newBuilder());
  if (response.hasError()) {
    throwException(response.getError());
  }
  Map<String,String> storeToValues=ProtoUtils.encodeROMetadataMap(response.getRoStoreMetadataList());
  if (storeToValues.size() != storeNames.size()) {
    storeNames.removeAll(storeToValues.keySet());
    throw new VoldemortException("Did not retrieve values for " + storeNames);
  }
  return storeToValues;
}
