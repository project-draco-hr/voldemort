{
  VAdminProto.DeletePartitionEntriesRequest.Builder deleteRequest=VAdminProto.DeletePartitionEntriesRequest.newBuilder().addAllReplicaToPartition(ProtoUtils.encodePartitionTuple(replicaToPartitionList)).setStore(storeName);
  try {
    if (filter != null) {
      deleteRequest.setFilter(encodeFilter(filter));
    }
  }
 catch (  IOException e) {
    throw new VoldemortException(e);
  }
  if (initialCluster != null) {
    deleteRequest.setInitialCluster(new ClusterMapper().writeCluster(initialCluster));
  }
  VAdminProto.VoldemortAdminRequest request=VAdminProto.VoldemortAdminRequest.newBuilder().setType(VAdminProto.AdminRequestType.DELETE_PARTITION_ENTRIES).setDeletePartitionEntries(deleteRequest).build();
  VAdminProto.DeletePartitionEntriesResponse.Builder response=sendAndReceive(nodeId,request,VAdminProto.DeletePartitionEntriesResponse.newBuilder());
  if (response.hasError())   throwException(response.getError());
  return response.getCount();
}
