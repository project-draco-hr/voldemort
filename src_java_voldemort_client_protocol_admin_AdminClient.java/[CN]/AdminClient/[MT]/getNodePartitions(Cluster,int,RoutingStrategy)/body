{
  List<Integer> partitionsList=new ArrayList<Integer>(cluster.getNodeById(nodeId).getPartitionIds());
  Map<Integer,Integer> partitionsToNodeMapping=RebalanceUtils.getCurrentPartitionMapping(cluster);
  for (  Node node : cluster.getNodes()) {
    if (node.getId() != nodeId) {
      for (      int partition : node.getPartitionIds()) {
        List<Integer> replicatedPartitions=strategy.getReplicatingPartitionList(partition);
        for (        int replicationPartition : replicatedPartitions) {
          if (partitionsToNodeMapping.get(replicationPartition) == nodeId) {
            partitionsList.add(partition);
          }
        }
      }
    }
  }
  return partitionsList;
}
