{
  long delay=INITIAL_DELAY;
  long waitUntil=System.currentTimeMillis() + timeUnit.toMillis(maxWait);
  String description=null;
  while (System.currentTimeMillis() < waitUntil) {
    try {
      AsyncOperationStatus status=getAsyncRequestStatus(nodeId,requestId);
      logger.info("Status for async task " + requestId + " at node "+ nodeId+ " is "+ status);
      description=status.getDescription();
      if (status.hasException())       throw status.getException();
      if (status.isComplete())       return status.getStatus();
      if (delay < MAX_DELAY)       delay<<=1;
      try {
        Thread.sleep(delay);
      }
 catch (      InterruptedException e) {
        Thread.currentThread().interrupt();
      }
    }
 catch (    Exception e) {
      throw new VoldemortException("Failed while waiting for async task " + description + " at node "+ nodeId+ " to finish",e);
    }
  }
  throw new VoldemortException("Failed to finish task requestId: " + requestId + " in maxWait "+ maxWait+ " "+ timeUnit.toString());
}
