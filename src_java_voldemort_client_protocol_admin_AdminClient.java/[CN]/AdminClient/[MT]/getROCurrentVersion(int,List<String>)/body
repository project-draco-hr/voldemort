{
  VAdminProto.GetROCurrentVersionRequest.Builder getROCurrentVersionRequest=VAdminProto.GetROCurrentVersionRequest.newBuilder().addAllStoreName(storeNames);
  VAdminProto.VoldemortAdminRequest adminRequest=VAdminProto.VoldemortAdminRequest.newBuilder().setGetRoCurrentVersion(getROCurrentVersionRequest).setType(VAdminProto.AdminRequestType.GET_RO_CURRENT_VERSION).build();
  VAdminProto.GetROCurrentVersionResponse.Builder response=sendAndReceive(nodeId,adminRequest,VAdminProto.GetROCurrentVersionResponse.newBuilder());
  if (response.hasError()) {
    throwException(response.getError());
  }
  Map<String,Long> storeToVersion=encodeROStoreVersionMap(response.getRoStoreVersionsList());
  if (storeToVersion.size() != storeNames.size()) {
    storeNames.removeAll(storeToVersion.keySet());
    throw new VoldemortException("Did not retrieve current version id for " + storeNames);
  }
  return storeToVersion;
}
