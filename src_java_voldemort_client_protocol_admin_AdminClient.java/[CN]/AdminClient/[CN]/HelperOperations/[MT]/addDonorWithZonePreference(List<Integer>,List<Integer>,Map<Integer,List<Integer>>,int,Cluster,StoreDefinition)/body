{
  Map<Integer,Integer> partitionToNodeId=ClusterUtils.getCurrentPartitionMapping(cluster);
  int nodeId=-1;
  int replicaType=-1;
  int partition=-1;
  boolean found=false;
  int index=0;
  while (!found && index < remainderPartitions.size()) {
    replicaType=originalPartitions.indexOf(remainderPartitions.get(index));
    nodeId=partitionToNodeId.get(remainderPartitions.get(index));
    if (-1 == zoneId || cluster.getNodeById(nodeId).getZoneId() == zoneId) {
      found=true;
    }
 else {
      index++;
    }
  }
  if (!found) {
    throw new VoldemortException("unable to find a node to fetch partition " + partition + " of replica type "+ replicaType+ " for store "+ storeDef.getName());
  }
  partition=originalPartitions.get(0);
  List<Integer> partitionIds=null;
  if (donorMap.containsKey(nodeId)) {
    partitionIds=donorMap.get(nodeId);
  }
 else {
    partitionIds=Collections.emptyList();
    donorMap.put(nodeId,partitionIds);
  }
}
