{
  HashMap<Integer,List<Integer>> numPartitionsPerNodePerZone=Maps.newHashMap();
  for (  Integer zoneId : targetCluster.getZoneIds()) {
    int numNodesInZone=targetCluster.getNumberOfNodesInZone(zoneId);
    int numPartitionsInZone=targetCluster.getNumberOfPartitionsInZone(zoneId);
    int floorPartitionsPerNodeInZone=numPartitionsInZone / numNodesInZone;
    int numNodesInZoneWithCeil=numPartitionsInZone - (numNodesInZone * floorPartitionsPerNodeInZone);
    ArrayList<Integer> partitionsOnNode=new ArrayList<Integer>(numNodesInZone);
    for (int i=0; i < numNodesInZoneWithCeil; i++) {
      partitionsOnNode.add(i,floorPartitionsPerNodeInZone + 1);
    }
    for (int i=numNodesInZoneWithCeil; i < numNodesInZone; i++) {
      partitionsOnNode.add(i,floorPartitionsPerNodeInZone);
    }
    numPartitionsPerNodePerZone.put(zoneId,partitionsOnNode);
  }
  return numPartitionsPerNodePerZone;
}
