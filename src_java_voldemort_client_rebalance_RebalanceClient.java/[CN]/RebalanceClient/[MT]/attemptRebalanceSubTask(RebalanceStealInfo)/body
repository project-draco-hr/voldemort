{
  boolean success=true;
  List<String> rebalanceStoreList=ImmutableList.copyOf(rebalanceSubTask.getUnbalancedStoreList());
  List<String> unbalancedStoreList=new ArrayList<String>(rebalanceStoreList);
  for (  String storeName : rebalanceStoreList) {
    try {
      int rebalanceAsyncId=adminClient.rebalanceNode(storeName,rebalanceSubTask);
      adminClient.waitForCompletion(rebalanceSubTask.getStealerId(),rebalanceAsyncId,24 * 60 * 60,TimeUnit.SECONDS);
      unbalancedStoreList.remove(storeName);
      rebalanceSubTask.setUnbalancedStoreList(unbalancedStoreList);
    }
 catch (    Exception e) {
      logger.warn("rebalanceSubTask:" + rebalanceSubTask + " failed for store:"+ storeName,e);
      success=false;
    }
  }
  if (!success)   throw new VoldemortException("rebalanceSubTask:" + rebalanceSubTask + " failed incomplete.");
}
