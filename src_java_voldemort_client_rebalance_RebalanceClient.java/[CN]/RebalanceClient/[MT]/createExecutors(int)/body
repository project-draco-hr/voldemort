{
  return Executors.newFixedThreadPool(numThreads,new ThreadFactory(){
    public Thread newThread(    Runnable r){
      Thread thread=new Thread(r);
      thread.setName(r.getClass().getName());
      thread.setUncaughtExceptionHandler(new UncaughtExceptionHandler(){
        public void uncaughtException(        Thread t,        Throwable e){
          logger.error("Rebalance task failed!",e);
        }
      }
);
      return thread;
    }
  }
);
}
