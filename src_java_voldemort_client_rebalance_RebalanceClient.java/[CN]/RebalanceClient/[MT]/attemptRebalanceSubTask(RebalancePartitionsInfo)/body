{
  List<String> rebalanceStoreList=ImmutableList.copyOf(rebalanceSubTask.getUnbalancedStoreList());
  List<String> unbalancedStoreList=new ArrayList<String>(rebalanceStoreList);
  for (  String storeName : rebalanceStoreList) {
    try {
      int rebalanceAsyncId=adminClient.rebalanceNode(storeName,rebalanceSubTask);
      adminClient.waitForCompletion(rebalanceSubTask.getStealerId(),rebalanceAsyncId,rebalanceConfig.getRebalancingClientTimeoutSeconds(),TimeUnit.SECONDS);
      unbalancedStoreList.remove(storeName);
      rebalanceSubTask.setUnbalancedStoreList(unbalancedStoreList);
    }
 catch (    Exception e) {
      throw new VoldemortException("rebalanceSubTask:" + rebalanceSubTask + " failed for store:"+ storeName,e);
    }
  }
}
