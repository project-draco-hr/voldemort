{
synchronized (adminClient) {
    VectorClock clock=getLatestClusterClock(Arrays.asList(stealerNode.getId(),rebalanceStealInfo.getDonorId()));
    Cluster oldCluster=adminClient.getCluster();
    try {
      Cluster newCluster=RebalanceUtils.createUpdatedCluster(oldCluster,stealerNode,oldCluster.getNodeById(rebalanceStealInfo.getDonorId()),rebalanceStealInfo.getPartitionList());
      clock.incrementVersion(stealerNode.getId(),System.currentTimeMillis());
      RebalanceUtils.propagateCluster(adminClient,newCluster,clock,Arrays.asList(stealerNode.getId(),rebalanceStealInfo.getDonorId()));
      adminClient.setCluster(newCluster);
    }
 catch (    Exception e) {
      logger.error("Failed to commit rebalance on node:" + stealerNode.getId() + " REVERTING cluster changes ...",e);
      clock.incrementVersion(stealerNode.getId(),System.currentTimeMillis());
      RebalanceUtils.propagateCluster(adminClient,oldCluster,clock,new ArrayList<Integer>());
      throw new VoldemortException(e);
    }
  }
}
