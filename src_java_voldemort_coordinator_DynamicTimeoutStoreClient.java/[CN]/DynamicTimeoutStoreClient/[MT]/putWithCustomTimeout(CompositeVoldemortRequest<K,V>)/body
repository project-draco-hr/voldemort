{
  validateTimeout(requestWrapper.getRoutingTimeoutInMs());
  Versioned<V> versioned;
  long startTime=System.currentTimeMillis();
  versioned=getWithCustomTimeout(requestWrapper);
  long endTime=System.currentTimeMillis();
  if (versioned == null)   versioned=Versioned.value(requestWrapper.getRawValue(),new VectorClock());
 else   versioned.setObject(requestWrapper.getRawValue());
  long timeLeft=requestWrapper.getRoutingTimeoutInMs() - (endTime - startTime);
  if (timeLeft <= 0) {
    throw new StoreTimeoutException("PUT request timed out");
  }
  return putVersionedWithCustomTimeout(new CompositeVersionedPutVoldemortRequest<K,V>(requestWrapper.getKey(),versioned,timeLeft));
}
