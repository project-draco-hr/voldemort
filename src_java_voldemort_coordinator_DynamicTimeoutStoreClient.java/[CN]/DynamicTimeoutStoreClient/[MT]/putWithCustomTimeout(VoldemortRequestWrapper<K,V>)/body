{
  validateTimeout(requestWrapper.getRoutingTimeout());
  Versioned<V> versioned;
  long startTime=System.currentTimeMillis();
  versioned=getWithCustomTimeout(new VoldemortRequestWrapper<K,V>(requestWrapper.getKey(),requestWrapper.getRoutingTimeout(),true));
  long endTime=System.currentTimeMillis();
  if (versioned == null)   versioned=Versioned.value(requestWrapper.getRawValue(),new VectorClock());
 else   versioned.setObject(requestWrapper.getRawValue());
  if ((endTime - startTime) > requestWrapper.getRoutingTimeout()) {
    throw new StoreTimeoutException("PUT request timed out");
  }
  return putVersionedWithCustomTimeout(new VoldemortRequestWrapper<K,V>(requestWrapper.getKey(),versioned,(requestWrapper.getRoutingTimeout() - (endTime - startTime))));
}
