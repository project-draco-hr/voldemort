{
  if (logger.isDebugEnabled())   logger.debug("Deleting instances for hosts: " + hostNames);
  List<String> instanceIds=new ArrayList<String>();
  for (  ReservationDescription res : ec2.describeInstances(Collections.<String>emptyList())) {
    if (res.getInstances() != null) {
      for (      Instance instance : res.getInstances()) {
        String externalHostName=instance.getDnsName() != null ? instance.getDnsName().trim() : "";
        if (!hostNames.contains(externalHostName))         continue;
        String state=String.valueOf(instance.getState()).toLowerCase();
        String instanceId=instance.getInstanceId();
        if (state.equals("shutting-down") || state.equals("terminated")) {
          if (logger.isWarnEnabled())           logger.warn("Instance " + instanceId + " in state \""+ instance.getState()+ "\" - ignoring");
          continue;
        }
        instanceIds.add(instanceId);
        if (logger.isInfoEnabled())         logger.info("Instance " + instanceId + " ("+ externalHostName+ ") to be terminated");
      }
    }
  }
  deleteInstancesByInstanceId(instanceIds);
}
