{
  List<String> instanceIds=launch(ami,keypairId,instanceSize,instanceCount);
  Map<String,String> hostNameMap=new HashMap<String,String>();
  while (!instanceIds.isEmpty()) {
    try {
      if (logger.isDebugEnabled())       logger.debug("Sleeping for " + POLL_INTERVAL + " seconds...");
      Thread.sleep(POLL_INTERVAL * 1000);
    }
 catch (    InterruptedException e) {
      break;
    }
    waitForInstances(instanceIds,hostNameMap);
  }
  return hostNameMap;
}
