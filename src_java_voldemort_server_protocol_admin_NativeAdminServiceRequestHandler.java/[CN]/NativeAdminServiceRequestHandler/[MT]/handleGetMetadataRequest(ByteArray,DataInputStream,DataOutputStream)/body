{
  try {
    String keyString=ByteUtils.getString(key.get(),"UTF-8");
    if (MetadataStore.METADATA_KEYS.contains(keyString)) {
      List<Versioned<byte[]>> versionedValueList=getMetadataStore().get(new ByteArray(ByteUtils.getBytes(keyString,"UTF-8")));
      int size=(versionedValueList.size() > 0) ? 1 : 0;
      outputStream.writeInt(size);
      outputStream.flush();
      if (size > 0) {
        Versioned<byte[]> versionedValue=versionedValueList.get(0);
        byte[] clock=((VectorClock)versionedValue.getVersion()).toBytes();
        byte[] value=versionedValue.getValue();
        outputStream.writeInt(clock.length + value.length);
        outputStream.write(clock);
        outputStream.write(value);
        outputStream.flush();
      }
      outputStream.writeShort(0);
      outputStream.flush();
    }
 else {
      throw new VoldemortException("Metadata Key passed " + keyString + " is not handled yet ...");
    }
  }
 catch (  VoldemortException e) {
    writeException(outputStream,e);
  }
}
