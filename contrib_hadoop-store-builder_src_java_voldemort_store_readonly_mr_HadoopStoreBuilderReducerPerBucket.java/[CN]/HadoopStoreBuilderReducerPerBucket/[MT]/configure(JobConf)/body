{
  try {
    keyValueWriterClass=job.get("writer.class");
    if (keyValueWriterClass != null)     writer=(KeyValueWriter)Utils.callConstructor(keyValueWriterClass);
 else     writer=new HadoopStoreWriterPerBucket();
    writer.conf(job);
  }
 catch (  Exception e) {
    throw new RuntimeException("Failed to open Input/OutputStream",e);
  }
}
