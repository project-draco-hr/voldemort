{
  super.configure(job);
  try {
    this.conf=job;
    this.outputDir=job.get("final.output.dir");
    this.taskId=job.get("mapred.task.id");
    this.checkSumType=CheckSum.fromString(job.get("checksum.type"));
    this.checkSumDigestIndex=new CheckSum[getNumChunks()];
    this.checkSumDigestValue=new CheckSum[getNumChunks()];
    this.position=new int[getNumChunks()];
    this.taskIndexFileName=new Path[getNumChunks()];
    this.taskValueFileName=new Path[getNumChunks()];
    this.indexFileStream=new DataOutputStream[getNumChunks()];
    this.valueFileStream=new DataOutputStream[getNumChunks()];
    for (int chunkId=0; chunkId < getNumChunks(); chunkId++) {
      this.checkSumDigestIndex[chunkId]=CheckSum.getInstance(checkSumType);
      this.checkSumDigestValue[chunkId]=CheckSum.getInstance(checkSumType);
      this.position[chunkId]=0;
      this.taskIndexFileName[chunkId]=new Path(FileOutputFormat.getOutputPath(job),getStoreName() + "." + Integer.toString(chunkId)+ "_"+ this.taskId+ ".index");
      this.taskValueFileName[chunkId]=new Path(FileOutputFormat.getOutputPath(job),getStoreName() + "." + Integer.toString(chunkId)+ "_"+ this.taskId+ ".data");
      if (this.fs == null)       this.fs=this.taskIndexFileName[chunkId].getFileSystem(job);
      this.indexFileStream[chunkId]=fs.create(this.taskIndexFileName[chunkId]);
      this.valueFileStream[chunkId]=fs.create(this.taskValueFileName[chunkId]);
      logger.info("Opening " + this.taskIndexFileName[chunkId] + " and "+ this.taskValueFileName[chunkId]+ " for writing.");
    }
  }
 catch (  IOException e) {
    throw new RuntimeException("Failed to open Input/OutputStream",e);
  }
}
