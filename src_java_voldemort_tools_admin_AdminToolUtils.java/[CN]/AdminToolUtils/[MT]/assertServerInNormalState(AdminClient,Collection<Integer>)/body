{
  for (  Integer nodeId : nodeIds) {
    Versioned<String> versioned=adminClient.metadataMgmtOps.getRemoteMetadata(nodeId,MetadataStore.SERVER_STATE_KEY);
    VoldemortState state=VoldemortState.valueOf(versioned.getValue());
    if (!state.equals(VoldemortState.NORMAL_SERVER)) {
      throw new VoldemortException("Cannot execute admin operation: " + nodeId + " ("+ adminClient.getAdminClientCluster().getNodeById(nodeId).getHost()+ ") is not in normal state, but in "+ versioned.getValue());
    }
  }
}
