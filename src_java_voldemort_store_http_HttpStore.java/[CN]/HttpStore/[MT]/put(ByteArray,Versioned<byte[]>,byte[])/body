{
  StoreUtils.assertValidKey(key);
  PostMethod method=null;
  try {
    method=new PostMethod(this.storeUrl);
    ByteArrayOutputStream outputBytes=new ByteArrayOutputStream();
    requestFormat.writePutRequest(new DataOutputStream(outputBytes),storeName,key,versioned.getValue(),transforms,(VectorClock)versioned.getVersion(),reroute);
    DataInputStream input=executeRequest(method,outputBytes);
    requestFormat.readPutResponse(input);
  }
 catch (  IOException e) {
    throw new UnreachableStoreException("Could not connect to " + storeUrl + " for "+ storeName,e);
  }
 finally {
    if (method != null)     method.releaseConnection();
  }
}
