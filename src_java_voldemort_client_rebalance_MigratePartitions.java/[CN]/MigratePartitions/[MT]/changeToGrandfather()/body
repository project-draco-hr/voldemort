{
  for (  int donorNodeId : donorNodePlans.keySet()) {
    logger.info("Transitioning " + donorNodeId + " to grandfathering state");
    Versioned<String> serverState=adminClient.updateGrandfatherMetadata(donorNodeId,donorNodePlans.get(donorNodeId));
    if (!serverState.getValue().equals(MetadataStore.VoldemortState.GRANDFATHERING_SERVER)) {
      throw new VoldemortException("Node " + donorNodeId + " is not in normal state to perform grandfathering");
    }
    donorStates.put(donorNodeId,serverState);
    logger.info("Successfully transitioned " + donorNodeId + " to grandfathering state");
  }
}
