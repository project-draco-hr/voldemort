{
  RebalanceClusterPlan plan=new RebalanceClusterPlan(currentCluster,targetCluster,storeDefs,false,null);
  List<String> storeNames=Lists.newArrayList();
  for (  StoreDefinition storeDef : storeDefs)   storeNames.add(storeDef.getName());
  List<RebalancePartitionsInfo> infoList=plan.getRebalanceNodeTask(currentCluster,targetCluster,storeNames,stealerId,false);
  for (  String storeName : storeNames) {
    for (    RebalancePartitionsInfo r : infoList) {
      int requestId=adminClient.migratePartitions(r.getDonorId(),stealerId,storeName,r.getPartitionList(),null);
      adminClient.waitForCompletion(stealerId,requestId,24 * 60 * 60,TimeUnit.SECONDS);
    }
  }
}
