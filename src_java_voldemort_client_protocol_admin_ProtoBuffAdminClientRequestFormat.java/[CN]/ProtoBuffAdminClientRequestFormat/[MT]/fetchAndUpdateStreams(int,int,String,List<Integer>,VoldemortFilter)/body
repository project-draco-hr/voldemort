{
  VAdminProto.InitiateFetchAndUpdateRequest.Builder initiateFetchAndUpdateRequest=VAdminProto.InitiateFetchAndUpdateRequest.newBuilder().setNodeId(donorNodeId).addAllPartitions(stealList).setStore(storeName);
  try {
    if (filter != null) {
      initiateFetchAndUpdateRequest.setFilter(encodeFilter(filter));
    }
  }
 catch (  IOException e) {
    throw new VoldemortException(e);
  }
  VAdminProto.VoldemortAdminRequest adminRequest=VAdminProto.VoldemortAdminRequest.newBuilder().setInitiateFetchAndUpdate(initiateFetchAndUpdateRequest).setType(VAdminProto.AdminRequestType.INITIATE_FETCH_AND_UPDATE).build();
  VAdminProto.AsyncOperationStatusResponse.Builder response=sendAndReceive(stealerNodeId,adminRequest,VAdminProto.AsyncOperationStatusResponse.newBuilder());
  if (response.hasError()) {
    throwException(response.getError());
  }
  long delay=250;
  long maxDelay=1000 * 60;
  int requestId=response.getRequestId();
  while (true) {
    Pair<String,Boolean> status=getAsyncRequestStatus(stealerNodeId,requestId);
    if (status.getSecond())     break;
    if (delay < maxDelay)     delay*=2;
    try {
      Thread.sleep(delay);
    }
 catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
    }
  }
}
