{
  Map<String,Long> storeToVersion=Maps.newHashMap();
  if (storeNames == null) {
    storeNames=Lists.newArrayList();
    for (    StoreDefinition storeDef : adminClient.getRemoteStoreDefList(nodeId > 0 ? nodeId : 0).getValue()) {
      if (storeDef.getType().compareTo(ReadOnlyStorageConfiguration.TYPE_NAME) == 0) {
        storeNames.add(storeDef.getName());
      }
    }
  }
  if (nodeId < 0) {
    if (versionType.compareTo("max") != 0) {
      System.err.println("Unsupported operation, only max allowed for all nodes");
      return;
    }
    storeToVersion=adminClient.getROMaxVersion(storeNames);
  }
 else {
    if (versionType.compareTo("max") == 0) {
      storeToVersion=adminClient.getROMaxVersion(nodeId,storeNames);
    }
 else     if (versionType.compareTo("current") == 0) {
      storeToVersion=adminClient.getROCurrentVersion(nodeId,storeNames);
    }
 else {
      System.err.println("Unsupported operation, only max OR current allowed for individual nodes");
      return;
    }
  }
  for (  String storeName : storeToVersion.keySet()) {
    System.out.println(storeName + ":" + storeToVersion.get(storeName));
  }
}
