{
  Map<String,Long> storeToValue=Maps.newHashMap();
  if (storeNames == null) {
    storeNames=Lists.newArrayList();
    for (    StoreDefinition storeDef : adminClient.getRemoteStoreDefList(nodeId > 0 ? nodeId : 0).getValue()) {
      if (storeDef.getType().compareTo(ReadOnlyStorageConfiguration.TYPE_NAME) == 0) {
        storeNames.add(storeDef.getName());
      }
    }
  }
  if (nodeId < 0) {
    if (type.compareTo("max") != 0) {
      System.err.println("Unsupported operation, only max allowed for all nodes");
      return;
    }
    storeToValue=adminClient.getROMaxVersion(storeNames);
  }
 else {
    if (type.compareTo("max") == 0) {
      storeToValue=adminClient.getROMaxVersion(nodeId,storeNames);
    }
 else     if (type.compareTo("current") == 0) {
      storeToValue=adminClient.getROCurrentVersion(nodeId,storeNames);
    }
 else     if (type.compareTo("storage-format") == 0) {
      Map<String,String> storeToStorageFormat=adminClient.getROStorageFormat(nodeId,storeNames);
      for (      String storeName : storeToStorageFormat.keySet()) {
        System.out.println(storeName + ":" + storeToStorageFormat.get(storeName));
      }
      return;
    }
 else {
      System.err.println("Unsupported operation, only max, current or storage-format allowed for individual nodes");
      return;
    }
  }
  for (  String storeName : storeToValue.keySet()) {
    System.out.println(storeName + ":" + storeToValue.get(storeName));
  }
}
