{
  logger.info("Swapping files for store '" + getName() + "' to "+ newStoreDirectory);
  File newDataDir=new File(newStoreDirectory);
  if (!newDataDir.exists())   throw new VoldemortException("File " + newDataDir.getAbsolutePath() + " does not exist.");
  if (!newDataDir.getName().startsWith("version-"))   throw new VoldemortException("Invalid version folder name '" + newDataDir.getName() + "'. Should be of the format 'version-n'");
  logger.info("Acquiring write lock on '" + getName() + "':");
  fileModificationLock.writeLock().lock();
  boolean success=false;
  try {
    close();
    logger.info("Opening primary files for store '" + getName() + "' at "+ newStoreDirectory);
    open(newDataDir);
    success=true;
  }
  finally {
    try {
      if (!success)       rollback();
    }
  finally {
      fileModificationLock.writeLock().unlock();
      if (success)       logger.info("Swap operation completed successfully on store " + getName() + ", releasing lock.");
 else       logger.error("Swap operation failed.");
    }
  }
  File extraBackup=new File(storeDir,"version-" + (maxVersion - numBackups - 1));
  if (extraBackup.exists())   deleteAsync(extraBackup);
}
