{
  logger.info("Swapping files for store '" + getName() + "' from "+ newStoreDirectory);
  File newDataDir=new File(newStoreDirectory);
  if (!newDataDir.exists())   throw new VoldemortException("File " + newDataDir.getAbsolutePath() + " does not exist.");
  logger.info("Acquiring write lock on '" + getName() + "':");
  fileModificationLock.writeLock().lock();
  boolean success=false;
  try {
    close();
    logger.info("Renaming data and index files for '" + getName() + "':");
    shiftBackupsRight();
    logger.info("Setting primary files for store '" + getName() + "' to "+ newStoreDirectory);
    File destDir=new File(storeDir,"version-0");
    if (!newDataDir.renameTo(destDir))     throw new VoldemortException("Renaming " + newDataDir.getAbsolutePath() + " to "+ destDir.getAbsolutePath()+ " failed!");
    open();
    success=true;
  }
  finally {
    try {
      if (!success)       rollback();
    }
  finally {
      fileModificationLock.writeLock().unlock();
      if (success)       logger.info("Swap operation completed successfully on store " + getName() + ", releasing lock.");
 else       logger.error("Swap operation failed.");
    }
  }
  File extraBackup=new File(storeDir,"version-" + (numBackups + 1));
  if (extraBackup.exists())   deleteAsync(extraBackup);
}
