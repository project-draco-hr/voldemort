{
  fileModificationLock.writeLock().lock();
  try {
    if (isOpen)     throw new IllegalStateException("Attempt to open already open store.");
    File version0=new File(storeDir,"version-0");
    version0.mkdirs();
    this.fileSet=new ChunkedFileSet(version0,this.numFileHandles,this.bufferWaitTimeoutMs);
    isOpen=true;
  }
  finally {
    fileModificationLock.writeLock().unlock();
  }
}
