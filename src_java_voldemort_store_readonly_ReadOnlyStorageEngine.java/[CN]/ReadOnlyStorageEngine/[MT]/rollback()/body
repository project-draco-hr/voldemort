{
  logger.info("Rolling back store '" + getName() + "'");
  fileModificationLock.writeLock().lock();
  try {
    if (isOpen)     close();
    File[] storeDirList=ReadOnlyUtils.versionDirs(storeDir);
    File backup=ReadOnlyUtils.findKthVersionedDir(storeDirList,storeDirList.length - 1);
    if (backup == null || !backup.exists())     throw new VoldemortException("Previous version does not exists, nothing to roll back to.");
    File primary=new File(storeDir,"version-" + maxVersionId);
    DateFormat df=new SimpleDateFormat("MM-dd-yyyy");
    if (primary.exists())     Utils.move(primary,new File(storeDir,"version-" + maxVersionId + "."+ df.format(new Date())+ ".bak"));
    open(backup);
  }
  finally {
    fileModificationLock.writeLock().unlock();
    logger.info("Rollback operation completed on '" + getName() + "', releasing lock.");
  }
}
