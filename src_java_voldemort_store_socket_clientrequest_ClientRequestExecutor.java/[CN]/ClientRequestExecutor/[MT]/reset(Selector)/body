{
  this.selector=selector;
  if (logger.isTraceEnabled())   traceInputBufferState("About to clear read buffer");
  if (inputStream.getBuffer().capacity() >= resizeThreshold)   inputStream.setBuffer(ByteBuffer.allocate(socketBufferSize));
 else   inputStream.getBuffer().clear();
  if (logger.isTraceEnabled())   traceInputBufferState("Cleared read buffer");
  outputStream.getBuffer().flip();
  SelectionKey selectionKey=socketChannel.keyFor(selector);
  selectionKey.interestOps(SelectionKey.OP_WRITE);
}
