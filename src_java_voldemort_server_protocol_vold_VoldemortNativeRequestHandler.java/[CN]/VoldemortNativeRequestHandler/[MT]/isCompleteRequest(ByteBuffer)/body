{
  DataInputStream inputStream=new DataInputStream(new ByteBufferBackedInputStream(buffer));
  try {
    byte opCode=inputStream.readByte();
    inputStream.readUTF();
    if (protocolVersion > 0)     inputStream.readBoolean();
switch (opCode) {
case VoldemortOpCode.GET_OP_CODE:
case VoldemortOpCode.GET_VERSION_OP_CODE:
      readKey(inputStream);
    break;
case VoldemortOpCode.GET_ALL_OP_CODE:
  int numKeys=inputStream.readInt();
for (int i=0; i < numKeys; i++) readKey(inputStream);
break;
case VoldemortOpCode.PUT_OP_CODE:
readKey(inputStream);
int dataSize=inputStream.readInt();
buffer.position(buffer.position() + dataSize);
break;
case VoldemortOpCode.DELETE_OP_CODE:
readKey(inputStream);
int versionSize=inputStream.readShort();
buffer.position(buffer.position() + versionSize);
break;
default :
}
return !buffer.hasRemaining();
}
 catch (Exception e) {
if (logger.isDebugEnabled()) logger.debug("Probable partial read occurred causing exception",e);
return false;
}
}
