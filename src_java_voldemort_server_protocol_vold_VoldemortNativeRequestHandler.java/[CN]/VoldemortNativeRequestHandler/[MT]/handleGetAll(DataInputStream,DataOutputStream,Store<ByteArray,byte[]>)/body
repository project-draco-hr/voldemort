{
  int numKeys=inputStream.readInt();
  List<ByteArray> keys=new ArrayList<ByteArray>(numKeys);
  for (int i=0; i < numKeys; i++)   keys.add(readKey(inputStream));
  Map<ByteArray,List<Versioned<byte[]>>> results=null;
  try {
    results=store.getAll(keys);
    outputStream.writeShort(0);
  }
 catch (  VoldemortException e) {
    writeException(outputStream,e);
    return;
  }
  outputStream.writeInt(results.size());
  for (  Map.Entry<ByteArray,List<Versioned<byte[]>>> entry : results.entrySet()) {
    outputStream.writeInt(entry.getKey().length());
    outputStream.write(entry.getKey().get());
    writeResults(outputStream,entry.getValue());
  }
}
