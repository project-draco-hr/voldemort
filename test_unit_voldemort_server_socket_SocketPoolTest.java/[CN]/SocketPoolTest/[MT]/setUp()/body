{
  int[] ports=ServerTestUtils.findFreePorts(2);
  this.port1=ports[0];
  this.port2=ports[1];
  this.pool=new SocketPool(maxConnectionsPerNode,maxTotalConnections,1000,32 * 1024);
  this.dest1=new SocketDestination("localhost",port1);
  this.dest2=new SocketDestination("localhost",port2);
  this.server1=new SocketServer(new ConcurrentHashMap<String,Store<ByteArray,byte[]>>(),port1,maxTotalConnections,maxTotalConnections + 3,10000);
  this.server2=new SocketServer(new ConcurrentHashMap<String,Store<ByteArray,byte[]>>(),port2,maxTotalConnections,maxTotalConnections + 3,10000);
  this.server1.start();
  this.server1.awaitStartupCompletion();
  this.server2.start();
  this.server2.awaitStartupCompletion();
}
