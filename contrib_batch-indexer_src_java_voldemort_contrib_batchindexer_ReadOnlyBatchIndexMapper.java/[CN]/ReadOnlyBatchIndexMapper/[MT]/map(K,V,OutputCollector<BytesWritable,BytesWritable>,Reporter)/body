{
  byte[] keyBytes=keySerializer.toBytes(getKeyBytes(key,value));
  byte[] valBytes=valueSerializer.toBytes(getValueBytes(key,value));
  List<Node> nodes=routingStrategy.routeRequest(keyBytes);
  for (  Node node : nodes) {
    ByteArrayOutputStream versionedValue=new ByteArrayOutputStream();
    DataOutputStream valueDin=new DataOutputStream(versionedValue);
    valueDin.writeInt(node.getId());
    valueDin.write(valBytes);
    valueDin.close();
    BytesWritable outputKey=new BytesWritable(ByteUtils.md5(keyBytes));
    BytesWritable outputVal=new BytesWritable(versionedValue.toByteArray());
    output.collect(outputKey,outputVal);
  }
}
