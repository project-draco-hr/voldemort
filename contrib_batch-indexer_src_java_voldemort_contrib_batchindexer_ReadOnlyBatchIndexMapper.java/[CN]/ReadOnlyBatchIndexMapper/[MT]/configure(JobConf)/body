{
  try {
    String clusterFilePath=ContribUtils.getFileFromCache(conf,"cluster.xml");
    String storeFilePath=ContribUtils.getFileFromCache(conf,"store.xml");
    if (null == clusterFilePath || null == storeFilePath) {
      throw new RuntimeException("Mapper expects cluster.xml / stores.xml passed through Distributed cache.");
    }
    _cluster=ContribUtils.getVoldemortClusterDetails(clusterFilePath);
    _storeDef=ContribUtils.getVoldemortStoreDetails(storeFilePath,conf.get("voldemort.store.name"));
    SerializerDefinition serDef=new SerializerDefinition("string","UTF-8");
    _keySerializer=(Serializer<Object>)new DefaultSerializerFactory().getSerializer(_storeDef.getKeySerializer());
    _valueSerializer=(Serializer<Object>)new DefaultSerializerFactory().getSerializer(_storeDef.getValueSerializer());
    _routingStrategy=new ConsistentRoutingStrategy(_cluster.getNodes(),_storeDef.getReplicationFactor());
    if (_routingStrategy == null) {
      throw new RuntimeException("Failed to create routing strategy");
    }
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
