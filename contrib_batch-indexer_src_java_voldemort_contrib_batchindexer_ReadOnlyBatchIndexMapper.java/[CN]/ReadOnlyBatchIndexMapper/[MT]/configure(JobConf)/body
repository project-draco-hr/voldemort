{
  try {
    String clusterFilePath=ContribUtils.getFileFromCache(conf,"cluster.xml");
    String storeFilePath=ContribUtils.getFileFromCache(conf,"store.xml");
    if (null == clusterFilePath || null == storeFilePath) {
      throw new RuntimeException("Mapper expects cluster.xml / stores.xml passed through Distributed cache.");
    }
    cluster=ContribUtils.getVoldemortClusterDetails(clusterFilePath);
    storeDef=ContribUtils.getVoldemortStoreDetails(storeFilePath,conf.get("voldemort.store.name"));
    keySerializer=(Serializer<Object>)new DefaultSerializerFactory().getSerializer(storeDef.getKeySerializer());
    valueSerializer=(Serializer<Object>)new DefaultSerializerFactory().getSerializer(storeDef.getValueSerializer());
    routingStrategy=new ConsistentRoutingStrategy(cluster.getNodes(),storeDef.getReplicationFactor());
    if (routingStrategy == null) {
      throw new RuntimeException("Failed to create routing strategy");
    }
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
