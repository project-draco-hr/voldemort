{
  List<StoreDefinition> storeDefinitionList=adminClient.metadataMgmtOps.getRemoteStoreDefList(node.getId()).getValue();
  if (allStores) {
    storeNames=Lists.newArrayList();
    for (    StoreDefinition storeDefinition : storeDefinitionList) {
      storeNames.add(storeDefinition.getName());
    }
  }
 else {
    for (    String storeName : storeNames) {
      if (!storeDefinitionList.contains(storeName))       Utils.croak("Store " + storeName + " does not exist!");
    }
  }
  return storeNames;
}
