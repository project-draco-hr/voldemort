{
  Map<ByteArray,byte[]> keyValMap=populateTestKeys(1000,storeName);
  checkAllKeysArePresent(server0,Arrays.asList(0,1),keyValMap);
  checkAllKeysArePresent(server1,Arrays.asList(2,3),keyValMap);
  Node node0=server0.getVoldemortMetadata().getCurrentCluster().getNodeById(0);
  Node node1=server0.getVoldemortMetadata().getCurrentCluster().getNodeById(1);
  Cluster targetCluster=new Cluster("rebalancing-client-test-donate",Arrays.asList(new Node[]{new Node(node0.getId(),node0.getHost(),node0.getHttpPort(),node0.getSocketPort(),node0.getAdminPort(),Arrays.asList(0)),new Node(node1.getId(),node1.getHost(),node1.getHttpPort(),node1.getSocketPort(),node1.getAdminPort(),Arrays.asList(1,2,3))}));
  rebalanceClient.donatePartitions(0,storeName,server0.getVoldemortMetadata().getCurrentCluster(),targetCluster);
  checkAllKeysArePresent(server0,Arrays.asList(0),keyValMap);
  checkAllKeysArePresent(server1,Arrays.asList(1,2,3),keyValMap);
  checkNoKeyReturns(server0,Arrays.asList(1,2,3),keyValMap);
  checkNoKeyReturns(server1,Arrays.asList(0),keyValMap);
}
