{
  if (HintedHandoffStrategyType.CONSISTENT_STRATEGY.equals(storeDef.getHintedHandoffStrategyType())) {
    Integer hintPrefListSize=storeDef.getHintPrefListSize();
    if (null == hintPrefListSize) {
      if (cluster.getNumberOfNodes() > 6)       hintPrefListSize=cluster.getNumberOfNodes() / 2;
 else       hintPrefListSize=cluster.getNumberOfNodes();
    }
    return new ConsistentHandoffStrategy(cluster,hintPrefListSize,enableZoneRouting,clientZoneId);
  }
 else   if (HintedHandoffStrategyType.TO_ALL_STRATEGY.equals(storeDef.getHintedHandoffStrategyType())) {
    return new HandoffToAllStrategy(cluster,enableZoneRouting,clientZoneId);
  }
 else {
    throw new VoldemortException("HintedHandoffStrategyType:" + storeDef.getHintedHandoffStrategyType() + " not handled by "+ this.getClass());
  }
}
