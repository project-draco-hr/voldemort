{
  int limit=spareNode ? nodes - 1 : nodes;
  int[][] partitionMap=new int[nodes][];
  int i, k;
  for (i=0, k=0; i < limit; i++) {
    partitionMap[i]=new int[perNode];
    for (int j=0; j < perNode; j++)     partitionMap[i][j]=k++;
  }
  if (spareNode)   partitionMap[limit]=new int[]{};
  return partitionMap;
}
