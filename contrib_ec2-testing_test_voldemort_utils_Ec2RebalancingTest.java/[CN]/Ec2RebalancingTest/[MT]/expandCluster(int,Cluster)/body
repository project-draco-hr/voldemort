{
  assert(newNodes > 0);
  List<HostNamePair> newInstances=createInstances(newNodes,ec2RebalancingTestConfig);
  List<String> newHostnames=toHostNames(newInstances);
  if (logger.isInfoEnabled())   logger.info("Sleeping for 30 seconds to let new instances startup");
  Thread.sleep(30000);
  hostNamePairs.addAll(newInstances);
  hostNames=toHostNames(hostNamePairs);
  nodeIds=generateClusterDescriptor(hostNamePairs,newCluster,ec2RebalancingTestConfig);
  deploy(newHostnames,ec2RebalancingTestConfig);
  startClusterAsync(newHostnames,ec2RebalancingTestConfig,nodeIds);
  if (logger.isInfoEnabled()) {
    logger.info("Expanded the cluster. New layout: " + nodeIds);
    logger.info("Sleeping for 10 seconds to let voldemort start");
  }
  Thread.sleep(10000);
  return updateCluster(newCluster,nodeIds);
}
