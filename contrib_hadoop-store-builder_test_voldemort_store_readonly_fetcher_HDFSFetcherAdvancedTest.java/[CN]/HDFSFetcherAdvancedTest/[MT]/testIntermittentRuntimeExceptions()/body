{
  setUp();
  FileSystem spyfs=Mockito.spy(fs);
  Mockito.doThrow(new RuntimeException()).doAnswer(Mockito.CALLS_REAL_METHODS).when(spyfs).open(source);
  Object[] params={spyfs,source,copyLocation,stats,CheckSumType.MD5,buffer};
  CheckSum ckSum=(CheckSum)this.invokePrivateMethod(fetcher,"copyFileWithCheckSum",params);
  assertEquals(Arrays.equals(ckSum.getCheckSum(),checksumCalculated),true);
  cleanUp();
}
