{
  bytesReadInInterval+=bytesRead;
  long now=time.getNanoseconds();
  long ellapsedNs=now - startTime;
  if (ellapsedNs > intervalMs * Time.NS_PER_MS && bytesReadInInterval > 0) {
    long bytesPerSec=(bytesReadInInterval * Time.NS_PER_SECOND) / ellapsedNs;
    if (bytesPerSec > maxBytesPerSecond) {
      double maxBytesPerMs=maxBytesPerSecond / (double)Time.MS_PER_SECOND;
      long ellapsedMs=ellapsedNs / Time.NS_PER_MS;
      long sleepTime=Math.round(bytesReadInInterval / maxBytesPerMs - ellapsedMs);
      if (logger.isDebugEnabled())       logger.debug("Natural I/O rate is " + bytesPerSec + " bytes/sec, sleeping for "+ sleepTime+ " ms to compensate.");
      if (sleepTime > 0) {
        try {
          time.sleep(sleepTime);
        }
 catch (        InterruptedException e) {
          throw new VoldemortException(e);
        }
      }
    }
    startTime=now;
    bytesReadInInterval=0;
  }
}
