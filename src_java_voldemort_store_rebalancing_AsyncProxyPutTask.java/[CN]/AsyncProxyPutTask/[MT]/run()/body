{
  MetadataStore metadata=redirectingStore.getMetadataStore();
  Node donorNode=metadata.getCluster().getNodeById(destinationNode);
  long startNs=System.nanoTime();
  try {
    redirectingStore.checkNodeAvailable(donorNode);
    Store<ByteArray,byte[],byte[]> socketStore=redirectingStore.getRedirectingSocketStore(redirectingStore.getName(),destinationNode);
    socketStore.put(key,value,transforms);
    redirectingStore.recordSuccess(donorNode,startNs);
    if (logger.isTraceEnabled()) {
      logger.trace("Proxy write for store " + redirectingStore.getName() + " key "+ ByteUtils.toBinaryString(key.get())+ " to destinationNode:"+ destinationNode);
    }
  }
 catch (  UnreachableStoreException e) {
    redirectingStore.recordException(donorNode,startNs,e);
    logger.error("Failed to reach proxy node " + donorNode,e);
    redirectingStore.reporteProxyPutFailure();
  }
catch (  ObsoleteVersionException ove) {
    if (logger.isTraceEnabled()) {
      logger.trace("OVE in proxy put for destinationNode: " + destinationNode + " from node:"+ metadata.getNodeId()+ " on key "+ ByteUtils.toHexString(key.get())+ " Version:"+ value.getVersion(),ove);
    }
    redirectingStore.reporteProxyPutFailure();
  }
catch (  Exception e) {
    logger.error("Unexpected exception in proxy put for destinationNode: " + destinationNode + " from node:"+ metadata.getNodeId()+ " on key "+ ByteUtils.toHexString(key.get())+ " Version:"+ value.getVersion(),e);
    redirectingStore.reporteProxyPutFailure();
  }
}
