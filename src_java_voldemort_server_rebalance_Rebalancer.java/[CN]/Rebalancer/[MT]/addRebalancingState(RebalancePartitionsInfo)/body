{
  metadataStore.writeLock.lock();
  try {
    if (ByteUtils.getString(metadataStore.get(MetadataStore.SERVER_STATE_KEY,null).get(0).getValue(),"UTF-8").compareTo(VoldemortState.NORMAL_SERVER.toString()) == 0) {
      metadataStore.put(MetadataStore.SERVER_STATE_KEY,VoldemortState.REBALANCING_MASTER_SERVER);
    }
    RebalancerState rebalancerState=metadataStore.getRebalancerState();
    if (!rebalancerState.update(stealInfo)) {
      throw new VoldemortException("Could not add steal information since a plan for the same donor node " + stealInfo.getDonorId() + " already exists");
    }
    metadataStore.put(MetadataStore.REBALANCING_STEAL_INFO,rebalancerState);
  }
  finally {
    metadataStore.writeLock.unlock();
  }
}
