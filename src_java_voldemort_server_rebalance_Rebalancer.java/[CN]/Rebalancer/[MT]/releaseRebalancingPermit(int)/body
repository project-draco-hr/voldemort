{
synchronized (rebalancePermitMap) {
    if (!rebalancePermitMap.get(donorNodeId).compareAndSet(true,false))     throw new VoldemortException("Invalid state rebalancePermit must be true here.");
  }
}
