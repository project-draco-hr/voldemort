{
  final RebalancePartitionsInfo stealInfo=stealInfoLiveCycle.getRebalancePartitionsInfo();
  if (!acquireRebalancingPermit(stealInfo.getDonorId())) {
    final RebalancerState rebalancerState=metadataStore.getRebalancerState();
    final RebalancePartitionsInfoLiveCycle info=rebalancerState.find(stealInfo.getDonorId());
    if (info != null && RebalancePartitionsInfoLifeCycleStatus.RUNNING.equals(info.getStatus())) {
      throw new AlreadyRebalancingException("Node " + metadataStore.getCluster().getNodeById(info.getRebalancePartitionsInfo().getStealerId()) + " is already rebalancing from "+ info.getRebalancePartitionsInfo().getDonorId()+ " rebalanceInfo:"+ info);
    }
  }
  checkCurrentState(stealInfoLiveCycle);
  setRebalancingState(stealInfo,RebalancePartitionsInfoLifeCycleStatus.NEW);
  final int maxParallelStoresRebalancing=(-1 != voldemortConfig.getMaxParallelStoresRebalancing()) ? voldemortConfig.getMaxParallelStoresRebalancing() : stealInfo.getUnbalancedStoreList().size();
  int requestId=asyncService.getUniqueRequestId();
  asyncService.submitOperation(requestId,new RebalanceAsyncOperation(this,voldemortConfig,metadataStore,requestId,stealInfo,maxParallelStoresRebalancing));
  return requestId;
}
