{
  if (!acquireRebalancingPermit(stealInfo.getDonorId())) {
    RebalancerState rebalancerState=metadataStore.getRebalancerState();
    RebalancePartitionsInfo info=rebalancerState.find(stealInfo.getDonorId());
    if (info != null) {
      throw new AlreadyRebalancingException("Node " + metadataStore.getCluster().getNodeById(info.getStealerId()) + " is already rebalancing from "+ info.getDonorId()+ " rebalanceInfo:"+ info);
    }
  }
  checkCurrentState(stealInfo);
  setRebalancingState(stealInfo);
  final int maxParallelStoresRebalancing=(-1 != voldemortConfig.getMaxParallelStoresRebalancing()) ? voldemortConfig.getMaxParallelStoresRebalancing() : stealInfo.getUnbalancedStoreList().size();
  int requestId=asyncService.getUniqueRequestId();
  asyncService.submitOperation(requestId,new RebalanceAsyncOperation(this,voldemortConfig,metadataStore,requestId,stealInfo,maxParallelStoresRebalancing));
  return requestId;
}
