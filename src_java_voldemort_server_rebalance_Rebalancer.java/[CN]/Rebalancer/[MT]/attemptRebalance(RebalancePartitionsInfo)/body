{
  stealInfo.setAttempt(stealInfo.getAttempt() + 1);
  List<String> unbalanceStoreList=ImmutableList.copyOf(stealInfo.getUnbalancedStoreList());
  for (  String storeName : unbalanceStoreList) {
    AdminClient adminClient=RebalanceUtils.createTempAdminClient(voldemortConfig,metadataStore.getCluster());
    try {
      int rebalanceAsyncId=rebalanceLocalNode(storeName,stealInfo);
      if (-1 == rebalanceAsyncId) {
        logger.warn("rebalancer is already running, aborting this rebalanceService run() ..");
        return;
      }
      adminClient.waitForCompletion(stealInfo.getStealerId(),rebalanceAsyncId,voldemortConfig.getAdminSocketTimeout(),TimeUnit.SECONDS);
      stealInfo.getUnbalancedStoreList().remove(storeName);
    }
 catch (    Exception e) {
      logger.warn("rebalanceSubTask:" + stealInfo + " failed for store:"+ storeName,e);
    }
 finally {
      adminClient.stop();
    }
  }
}
