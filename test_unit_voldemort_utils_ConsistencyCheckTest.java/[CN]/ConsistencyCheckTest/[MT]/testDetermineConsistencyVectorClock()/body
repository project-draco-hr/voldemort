{
  Map<ConsistencyCheck.Value,Set<ConsistencyCheck.ClusterNode>> versionNodeSetMap=new HashMap<ConsistencyCheck.Value,Set<ConsistencyCheck.ClusterNode>>();
  int replicationFactor=4;
  VectorClock vc1=new VectorClock();
  vc1.incrementVersion(1,100000001);
  vc1.incrementVersion(2,100000003);
  VectorClock vc2=new VectorClock();
  vc2.incrementVersion(1,100000001);
  vc2.incrementVersion(3,100000002);
  VectorClock vc3=new VectorClock();
  vc3.incrementVersion(1,100000001);
  vc3.incrementVersion(4,100000001);
  ConsistencyCheck.Value v1=new ConsistencyCheck.VersionValue(new Versioned<byte[]>(value1,vc1));
  ConsistencyCheck.Value v2=new ConsistencyCheck.VersionValue(new Versioned<byte[]>(value2,vc2));
  ConsistencyCheck.Value v3=new ConsistencyCheck.VersionValue(new Versioned<byte[]>(value3,vc3));
  versionNodeSetMap.put(v1,setFourNodes);
  assertEquals(ConsistencyCheck.ConsistencyLevel.FULL,ConsistencyCheck.determineConsistency(versionNodeSetMap,replicationFactor));
  versionNodeSetMap.clear();
  versionNodeSetMap.put(v1,setFourNodes);
  versionNodeSetMap.put(v2,setFourNodes);
  versionNodeSetMap.put(v3,setFourNodes);
  assertEquals(ConsistencyCheck.ConsistencyLevel.FULL,ConsistencyCheck.determineConsistency(versionNodeSetMap,replicationFactor));
  versionNodeSetMap.clear();
  versionNodeSetMap.put(v1,setFourNodes);
  versionNodeSetMap.put(v2,setThreeNodes);
  assertEquals(ConsistencyCheck.ConsistencyLevel.LATEST_CONSISTENT,ConsistencyCheck.determineConsistency(versionNodeSetMap,replicationFactor));
  versionNodeSetMap.clear();
  versionNodeSetMap.put(v1,setThreeNodes);
  assertEquals(ConsistencyCheck.ConsistencyLevel.INCONSISTENT,ConsistencyCheck.determineConsistency(versionNodeSetMap,replicationFactor));
  versionNodeSetMap.clear();
  versionNodeSetMap.put(v1,setThreeNodes);
  versionNodeSetMap.put(v2,setFourNodes);
  assertEquals(ConsistencyCheck.ConsistencyLevel.INCONSISTENT,ConsistencyCheck.determineConsistency(versionNodeSetMap,replicationFactor));
  versionNodeSetMap.clear();
  versionNodeSetMap.put(v1,setThreeNodes);
  versionNodeSetMap.put(v2,setFourNodes);
  versionNodeSetMap.put(v3,setThreeNodes);
  assertEquals(ConsistencyCheck.ConsistencyLevel.INCONSISTENT,ConsistencyCheck.determineConsistency(versionNodeSetMap,replicationFactor));
}
