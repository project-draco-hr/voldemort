{
  if (logger.isTraceEnabled())   logger.trace(pipeline.getOperation().getSimpleName() + " response received (" + requestTime+ " ms.) from node "+ node.getId());
  Response<ByteArray,Object> response=new Response<ByteArray,Object>(node,key,result,requestTime);
  if (logger.isDebugEnabled())   logger.debug("Finished " + pipeline.getOperation().getSimpleName() + " for key "+ ByteUtils.toHexString(key.get())+ " (keyRef: "+ System.identityHashCode(key)+ "); took "+ requestTime+ " ms on node "+ node.getId()+ "("+ node.getHost()+ ")");
  responses.put(node.getId(),response);
  attemptsLatch.countDown();
  if (pipeline.isFinished() && response.getValue() instanceof Exception) {
    if (response.getValue() instanceof InvalidMetadataException) {
      pipelineData.reportException((InvalidMetadataException)response.getValue());
      logger.warn("Received invalid metadata problem after a successful " + pipeline.getOperation().getSimpleName() + " call on node "+ node.getId()+ ", store '"+ pipelineData.getStoreName()+ "'");
    }
 else {
      handleResponseError(response,pipeline,failureDetector);
    }
  }
}
