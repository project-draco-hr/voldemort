{
  currentCluster=ServerTestUtils.getLocalCluster(2,new int[][]{{0,1,2,3,4,5,6,7,8},{}});
  targetCluster=ServerTestUtils.getLocalCluster(2,new int[][]{{0,1,4,5,6,7,8},{2,3}});
  System.out.println("testRebalancePlan() running...");
  RebalanceClusterPlan rebalancePlan=new RebalanceClusterPlan(currentCluster,targetCluster,storeDefList,true);
  System.out.println("Plan partition distribution: " + rebalancePlan.printPartitionDistribution());
  System.out.println("Plan: " + rebalancePlan);
  assertEquals("There should have exactly one rebalancing node",1,rebalancePlan.getRebalancingTaskQueue().size());
  for (  RebalanceNodePlan rebalanceNodeInfo : rebalancePlan.getRebalancingTaskQueue()) {
    assertEquals("rebalanceInfo should have exactly one item",1,rebalanceNodeInfo.getRebalanceTaskList().size());
    RebalancePartitionsInfo expected=new RebalancePartitionsInfo(rebalanceNodeInfo.getStealerNode(),0,Arrays.asList(0,1,2,3,4,5,6,7,8),empty,Arrays.asList(2,3),RebalanceUtils.getStoreNames(storeDefList),0);
    assertEquals("rebalanceStealInfo should match",expected.toJsonString(),rebalanceNodeInfo.getRebalanceTaskList().get(0).toJsonString());
  }
}
