{
  System.out.println("testRebalanceDeletingOnePartition() running...");
  currentCluster=ServerTestUtils.getLocalCluster(4,new int[][]{{0,4,8},{1,5,9},{2,6,10},{3,7,11}});
  targetCluster=ServerTestUtils.getLocalCluster(4,new int[][]{{0,1,4,8},{9},{2,5,6,10},{3,7,11}});
  RebalanceClusterPlan rebalancePlan=new RebalanceClusterPlan(currentCluster,targetCluster,storeDefList2,true);
  System.out.println("Plan partition distribution: " + rebalancePlan.printPartitionDistribution());
  System.out.println("Plan: " + rebalancePlan);
  assertEquals("There should have exactly 3 rebalancing node",3,rebalancePlan.getRebalancingTaskQueue().size());
{
    RebalanceNodePlan nodePlan=rebalancePlan.getRebalancingTaskQueue().poll();
    assertEquals("Stealer 0 should have 1 entry",1,nodePlan.getRebalanceTaskList().size());
    RebalancePartitionsInfo a=new RebalancePartitionsInfo(0,1,Arrays.asList(1,5),Arrays.asList(1),Arrays.asList(1),RebalanceUtils.getStoreNames(storeDefList2),0);
    checkAllRebalanceInfoPresent(nodePlan,Arrays.asList(a));
  }
{
    RebalanceNodePlan nodePlan=rebalancePlan.getRebalancingTaskQueue().poll();
    assertEquals("Stealer 2 should have 1 entry",1,nodePlan.getRebalanceTaskList().size());
    RebalancePartitionsInfo a=new RebalancePartitionsInfo(2,1,Arrays.asList(3,5,11),Arrays.asList(3,5,11),Arrays.asList(5),RebalanceUtils.getStoreNames(storeDefList2),0);
    checkAllRebalanceInfoPresent(nodePlan,Arrays.asList(a));
  }
{
    RebalanceNodePlan nodePlan=rebalancePlan.getRebalancingTaskQueue().poll();
    assertEquals("Stealer 3 should have 1 entry",1,nodePlan.getRebalanceTaskList().size());
    RebalancePartitionsInfo a=new RebalancePartitionsInfo(3,1,Arrays.asList(0,4),Arrays.asList(0,4),empty,RebalanceUtils.getStoreNames(storeDefList2),0);
    checkAllRebalanceInfoPresent(nodePlan,Arrays.asList(a));
  }
}
