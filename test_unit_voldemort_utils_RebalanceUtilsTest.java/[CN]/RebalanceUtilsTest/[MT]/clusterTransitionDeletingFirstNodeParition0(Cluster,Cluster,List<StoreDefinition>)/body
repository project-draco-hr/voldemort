{
  OrderedClusterTransition orderedClusterTransition=createOrderedClusterTransition(currentCluster,targetCluster,storeDef);
  List<RebalanceNodePlan> orderedRebalanceNodePlanList=orderedClusterTransition.getOrderedRebalanceNodePlanList();
  assertEquals("There should have exactly 3 rebalancing node",3,orderedRebalanceNodePlanList.size());
{
    RebalanceNodePlan rebalanceNodePlan=orderedRebalanceNodePlanList.get(0);
    assertEquals("Stealer 1 should have 1 entry",1,rebalanceNodePlan.getRebalanceTaskList().size());
    RebalancePartitionsInfo a=new RebalancePartitionsInfo(1,0,Arrays.asList(0,6),Arrays.asList(6),Arrays.asList(0),RebalanceUtils.getStoreNames(storeDef),new HashMap<String,String>(),new HashMap<String,String>(),0);
    checkAllRebalanceInfoPresent(rebalanceNodePlan,Arrays.asList(a));
  }
{
    RebalanceNodePlan rebalanceNodePlan=orderedRebalanceNodePlanList.get(1);
    assertEquals("Stealer 2 should have 1 entry",1,rebalanceNodePlan.getRebalanceTaskList().size());
    RebalancePartitionsInfo a=new RebalancePartitionsInfo(2,0,Arrays.asList(7),Arrays.asList(7),empty,RebalanceUtils.getStoreNames(storeDef),new HashMap<String,String>(),new HashMap<String,String>(),0);
    checkAllRebalanceInfoPresent(rebalanceNodePlan,Arrays.asList(a));
  }
{
    RebalanceNodePlan rebalanceNodePlan=orderedRebalanceNodePlanList.get(2);
    assertEquals("Stealer 3 should have 1 entry",1,rebalanceNodePlan.getRebalanceTaskList().size());
    RebalancePartitionsInfo a=new RebalancePartitionsInfo(3,0,Arrays.asList(0),Arrays.asList(0),empty,RebalanceUtils.getStoreNames(storeDef),new HashMap<String,String>(),new HashMap<String,String>(),0);
    checkAllRebalanceInfoPresent(rebalanceNodePlan,Arrays.asList(a));
  }
}
