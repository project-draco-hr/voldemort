{
  Map<Integer,Map<Integer,List<Integer>>> map=new HashMap<Integer,Map<Integer,List<Integer>>>();
  if (currentCluster.getNumberOfPartitions() != targetCluster.getNumberOfPartitions())   throw new VoldemortException("Total number of partitions should not change !!");
  for (  Node node : targetCluster.getNodes()) {
    Map<Integer,List<Integer>> stealPartitionMap=getStealPartitionsMap(currentCluster,targetCluster,node.getId());
    if (!stealPartitionMap.isEmpty())     map.put(node.getId(),stealPartitionMap);
  }
  return map;
}
