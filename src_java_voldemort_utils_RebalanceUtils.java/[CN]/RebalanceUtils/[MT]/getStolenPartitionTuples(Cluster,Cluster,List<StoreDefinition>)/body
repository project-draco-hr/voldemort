{
  Map<Integer,Set<Pair<Integer,Integer>>> currentNodeIdToReplicas=getNodeIdToAllPartitions(currentCluster,storeDefs,true);
  Map<Integer,Set<Pair<Integer,Integer>>> targetNodeIdToReplicas=getNodeIdToAllPartitions(targetCluster,storeDefs,true);
  Map<Integer,Set<Pair<Integer,Integer>>> stealerNodeToStolenPartitionTuples=Maps.newHashMap();
  for (  int stealerId : RebalanceUtils.getNodeIds(Lists.newArrayList(targetCluster.getNodes()))) {
    Set<Pair<Integer,Integer>> clusterStealerReplicas=currentNodeIdToReplicas.get(stealerId);
    Set<Pair<Integer,Integer>> targetStealerReplicas=targetNodeIdToReplicas.get(stealerId);
    Set<Pair<Integer,Integer>> diff=RebalanceUtils.getAddedInTarget(clusterStealerReplicas,targetStealerReplicas);
    if (diff != null && diff.size() > 0) {
      stealerNodeToStolenPartitionTuples.put(stealerId,diff);
    }
  }
  return stealerNodeToStolenPartitionTuples;
}
