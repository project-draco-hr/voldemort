{
  List<Integer> optimizedPartitionIds=Lists.newArrayList();
  RoutingStrategy strategy=new RoutingStrategyFactory().updateRoutingStrategy(storeDef,cluster);
  List<Integer> partitionList=Lists.newArrayList();
  for (  Integer partition : partitionIds) {
    List<Integer> preferenceList=strategy.getReplicatingPartitionList(partition);
    if (!ClusterUtils.containsPreferenceList(cluster,preferenceList,stealerNodeId)) {
      partitionList.add(partition);
    }
  }
  if (partitionList.size() > 0) {
    optimizedPartitionIds.addAll(partitionList);
  }
  return optimizedPartitionIds;
}
