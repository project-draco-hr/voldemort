{
  Queue<Pair<Integer,List<RebalancePartitionsInfo>>> rebalanceTaskQueue=new ConcurrentLinkedQueue<Pair<Integer,List<RebalancePartitionsInfo>>>();
  if (currentCluster.getNumberOfPartitions() != targetCluster.getNumberOfPartitions())   throw new VoldemortException("Total number of partitions should not change !!");
  for (  Node node : targetCluster.getNodes()) {
    List<RebalancePartitionsInfo> rebalanceNodeList=getRebalanceNodeTask(currentCluster,targetCluster,storeList,node.getId());
    if (rebalanceNodeList.size() > 0) {
      rebalanceTaskQueue.offer(new Pair<Integer,List<RebalancePartitionsInfo>>(node.getId(),rebalanceNodeList));
    }
  }
  return rebalanceTaskQueue;
}
