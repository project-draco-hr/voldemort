{
  Map<Integer,Set<Integer>> nodeIdToReplicas=getNodeIdToAllPartitions(cluster,storeDefs,false);
  Map<Integer,Set<Integer>> targetNodeIdToReplicas=getNodeIdToAllPartitions(target,storeDefs,false);
  Set<Integer> clusterStealerReplicas=nodeIdToReplicas.get(stealerId);
  Set<Integer> targetStealerReplicas=targetNodeIdToReplicas.get(stealerId);
  Set<Integer> replicasAddedInTarget=RebalanceUtils.getAddedInTarget(clusterStealerReplicas,targetStealerReplicas);
  if (RebalanceUtils.containsNode(cluster,stealerId)) {
    replicasAddedInTarget.removeAll(cluster.getNodeById(stealerId).getPartitionIds());
  }
  return replicasAddedInTarget;
}
