{
  int crossZoneMoves=0;
  for (  RebalanceNodePlan nodePlan : plan.getRebalancingTaskQueue()) {
    List<RebalancePartitionsInfo> infos=nodePlan.getRebalanceTaskList();
    for (    RebalancePartitionsInfo info : infos) {
      Node donorNode=targetCluster.getNodeById(info.getDonorId());
      Node stealerNode=targetCluster.getNodeById(info.getStealerId());
      if (donorNode.getZoneId() != stealerNode.getZoneId()) {
        crossZoneMoves++;
      }
    }
  }
  return crossZoneMoves;
}
