{
synchronized (adminClient) {
    Cluster currentCluster=adminClient.getCluster();
    List<Integer> stealerPartitionList=new ArrayList<Integer>(stealerNode.getPartitionIds());
    stealerPartitionList.addAll(rebalanceNodeInfo.getPartitionList());
    stealerNode=updateNode(stealerNode,stealerPartitionList);
    List<Integer> donorPartitionList=new ArrayList<Integer>(adminClient.getCluster().getNodeById(rebalanceNodeInfo.getDonorId()).getPartitionIds());
    stealerPartitionList.removeAll(rebalanceNodeInfo.getPartitionList());
    Node donorNode=updateNode(adminClient.getCluster().getNodeById(rebalanceNodeInfo.getDonorId()),donorPartitionList);
    currentCluster=updateCluster(currentCluster,Arrays.asList(stealerNode,donorNode));
    VectorClock clock=(VectorClock)adminClient.getRemoteCluster(donorNode.getId()).getVersion();
    clock=clock.incremented(stealerNode.getId(),System.currentTimeMillis());
    propagateCluster(adminClient,currentCluster,clock,Arrays.asList(stealerNode.getId(),donorNode.getId()));
    return currentCluster;
  }
}
