{
synchronized (stealPartitionsMap) {
    VectorClock clock=(VectorClock)adminClient.getRemoteCluster(rebalanceStealInfo.getDonorId()).getVersion();
    Cluster oldCluster=adminClient.getCluster();
    try {
      Cluster newCluster=RebalanceUtils.createUpdatedCluster(oldCluster,stealerNode,oldCluster.getNodeById(rebalanceStealInfo.getDonorId()),rebalanceStealInfo.getPartitionList());
      clock.incrementVersion(stealerNode.getId(),System.currentTimeMillis());
      RebalanceUtils.propagateCluster(adminClient,newCluster,clock,Arrays.asList(stealerNode.getId(),rebalanceStealInfo.getDonorId()));
      adminClient.setCluster(newCluster);
      return true;
    }
 catch (    Exception e) {
      logger.warn("Failed to commit rebalance on node:" + stealerNode.getId(),e);
      RebalanceUtils.revertStealPartitionsMap(stealPartitionsMap,stealerNode.getId(),rebalanceStealInfo);
      clock.incrementVersion(stealerNode.getId(),System.currentTimeMillis());
      RebalanceUtils.propagateCluster(adminClient,oldCluster,clock,new ArrayList<Integer>());
    }
    return false;
  }
}
