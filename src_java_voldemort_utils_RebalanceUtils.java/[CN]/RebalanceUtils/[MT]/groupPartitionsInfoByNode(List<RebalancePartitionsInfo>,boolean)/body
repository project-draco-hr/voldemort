{
  HashMap<Integer,List<RebalancePartitionsInfo>> stealerNodeToPlan=Maps.newHashMap();
  if (rebalancePartitionPlanList != null) {
    for (    RebalancePartitionsInfo partitionInfo : rebalancePartitionPlanList) {
      int nodeId=groupByStealerNode ? partitionInfo.getStealerId() : partitionInfo.getDonorId();
      List<RebalancePartitionsInfo> partitionInfos=stealerNodeToPlan.get(nodeId);
      if (partitionInfos == null) {
        partitionInfos=Lists.newArrayList();
        stealerNodeToPlan.put(nodeId,partitionInfos);
      }
      partitionInfos.add(partitionInfo);
    }
  }
  return stealerNodeToPlan;
}
