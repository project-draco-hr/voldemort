{
  StreamRequestHandlerState handlerState=StreamRequestHandlerState.WRITING;
switch (fetchStatus) {
case next_partition:
    handlerState=handleNextPartition();
  break;
case send_data_file:
handleSendDataFile(outputStream);
break;
case send_index_file:
handleSendIndexFile();
break;
default :
throw new VoldemortException("Invalid fetch status: " + fetchStatus);
}
return handlerState;
}
