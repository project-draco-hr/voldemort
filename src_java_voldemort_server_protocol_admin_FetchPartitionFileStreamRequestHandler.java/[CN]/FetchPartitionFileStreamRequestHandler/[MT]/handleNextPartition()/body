{
  StreamRequestHandlerState handlerState=StreamRequestHandlerState.WRITING;
  if (partitionIterator.hasNext()) {
    currentPair=partitionIterator.next();
    currentChunkId=0;
    dataFile=indexFile=null;
    fetchStatus=FetchStatus.SEND_DATA_FILE;
  }
 else {
    logger.info("Finished streaming files for partitions: " + replicaToPartitionList);
    stats.closeHandle(handle);
    handlerState=StreamRequestHandlerState.COMPLETE;
  }
  return handlerState;
}
