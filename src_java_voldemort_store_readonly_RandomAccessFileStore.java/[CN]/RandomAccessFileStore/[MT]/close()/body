{
  logger.debug("Close called for read-only store.");
  this.fileModificationLock.writeLock().lock();
  if (!isOpen)   throw new IllegalStateException("Attempt to close non-open store.");
  try {
    while (this.indexFiles.size() > 0) {
      RandomAccessFile f=this.indexFiles.take();
      f.close();
    }
    while (this.dataFiles.size() > 0) {
      RandomAccessFile f=this.dataFiles.poll();
      f.close();
    }
    this.isOpen=false;
  }
 catch (  IOException e) {
    throw new VoldemortException("Error while closing store.",e);
  }
catch (  InterruptedException e) {
    throw new VoldemortException("Interrupted while waiting for file descriptor.",e);
  }
 finally {
    this.fileModificationLock.writeLock().unlock();
  }
}
