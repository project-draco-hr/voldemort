{
  fileModificationLock.writeLock().lock();
  try {
    if (isOpen)     throw new IllegalStateException("Attempt to open already open store.");
    this.indexFiles=new ArrayBlockingQueue<RandomAccessFile>(numFileHandles);
    this.dataFiles=new ArrayBlockingQueue<RandomAccessFile>(numFileHandles);
    for (int i=0; i < numFileHandles; i++) {
      indexFiles.add(new RandomAccessFile(indexFile,"r"));
      dataFiles.add(new RandomAccessFile(dataFile,"r"));
    }
    this.indexFileSize=getFileSize(indexFiles);
    long dataFileSize=getFileSize(dataFiles);
    if (indexFileSize % INDEX_ENTRY_SIZE != 0L)     throw new VoldemortException("Invalid index file, file length must be a multiple of " + (KEY_HASH_SIZE + POSITION_SIZE) + " but is only "+ indexFileSize+ " bytes.");
    if (dataFileSize < 4 * indexFileSize / INDEX_ENTRY_SIZE)     throw new VoldemortException("Invalid data file, file length must not be less than num_index_entries * 4 bytes, but data file is only " + dataFileSize + " bytes.");
    clearCache();
    isOpen=true;
  }
 catch (  FileNotFoundException e) {
    throw new VoldemortException("Could not open store.",e);
  }
 finally {
    fileModificationLock.writeLock().unlock();
  }
}
