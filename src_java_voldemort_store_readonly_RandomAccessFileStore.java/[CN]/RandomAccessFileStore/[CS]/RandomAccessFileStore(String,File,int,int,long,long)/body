{
  this.storageDir=storageDir;
  this.numBackups=numBackups;
  this.indexFile=new File(storageDir,name + ".index");
  this.dataFile=new File(storageDir,name + ".data");
  this.name=Utils.notNull(name);
  this.fdWaitTimeoutMs=fdWaitTimeoutMs;
  this.dataFiles=new ArrayBlockingQueue<RandomAccessFile>(numFileHandles);
  this.indexFiles=new ArrayBlockingQueue<RandomAccessFile>(numFileHandles);
  this.numFileHandles=numFileHandles;
  this.fileModificationLock=new ReentrantReadWriteLock();
  int cacheElements=(int)floor(maxCacheSizeBytes / (KEY_HASH_SIZE + 24));
  this.maxCacheDepth=(int)floor(log(cacheElements) / log(2));
  this.keyCache=new byte[(int)pow(2,maxCacheDepth)][];
  this.isOpen=new AtomicBoolean(false);
  open();
}
