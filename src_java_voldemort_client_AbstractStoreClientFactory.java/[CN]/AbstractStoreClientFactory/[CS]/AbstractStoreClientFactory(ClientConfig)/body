{
  this.config=config;
  this.threadPool=new ClientThreadPool(config.getMaxThreads(),config.getThreadIdleTime(TimeUnit.MILLISECONDS),config.getMaxQueuedRequests());
  this.serializerFactory=config.getSerializerFactory();
  this.bootstrapUrls=validateUrls(config.getBootstrapUrls());
  this.isJmxEnabled=config.isJmxEnabled();
  this.requestFormatType=config.getRequestFormatType();
  this.jmxId=getNextJmxId();
  this.maxBootstrapRetries=config.getMaxBootstrapRetries();
  this.aggregateStats=new StoreStats();
  this.clientFactoryStats=new StoreClientFactoryStats();
  this.clientContextName=config.getClientContextName();
  this.routedStoreConfig=new RoutedStoreConfig(config);
  this.routedStoreConfig.setJmxId(this.jmxId);
  this.routedStoreFactory=new RoutedStoreFactory();
  this.routedStoreFactory.setThreadPool(this.threadPool);
  this.clientSequencer=new AtomicInteger(0);
  this.clientAsyncServiceRepo=new HashSet<SchedulerService>();
  if (this.isJmxEnabled) {
    JmxUtils.registerMbean(threadPool,JmxUtils.createObjectName(JmxUtils.getPackageName(threadPool.getClass()),JmxUtils.getClassName(threadPool.getClass()) + JmxUtils.getJmxId(jmxId)));
    JmxUtils.registerMbean(new StoreStatsJmx(aggregateStats),JmxUtils.createObjectName("voldemort.store.stats.aggregate","aggregate-perf" + JmxUtils.getJmxId(jmxId)));
    JmxUtils.registerMbean(new StoreClientFactoryStatsJmx(clientFactoryStats),JmxUtils.createObjectName("voldemort.store.client.factory.stats",JmxUtils.getJmxId(jmxId)));
  }
}
