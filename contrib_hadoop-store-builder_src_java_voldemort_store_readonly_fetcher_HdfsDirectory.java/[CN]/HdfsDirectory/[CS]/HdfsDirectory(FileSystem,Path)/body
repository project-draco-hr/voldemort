{
  this.fs=fs;
  this.source=source;
  FileStatus[] files=fs.listStatus(source);
  if (files == null) {
    throw new VoldemortApplicationException(source + " is empty");
  }
  for (  FileStatus file : files) {
    String fileName=file.getPath().getName();
    if (fileName.contains(CHECKSUM_FILE) || (!fileName.contains(HdfsFetcher.METADATA_FILE_EXTENSION) && fileName.startsWith("."))) {
      continue;
    }
    HdfsFile hdfsFile=new HdfsFile(file);
    if (hdfsFile.getFileType() == FileType.METADATA) {
      setMetadataFile(hdfsFile);
    }
 else {
      allFiles.add(hdfsFile);
    }
  }
  Collections.sort(allFiles);
}
