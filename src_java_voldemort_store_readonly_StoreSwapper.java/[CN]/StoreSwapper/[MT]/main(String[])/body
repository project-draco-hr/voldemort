{
  if (args.length != 4)   Utils.croak("USAGE: cluster.xml store_name mgmtpath file_path");
  String clusterXml=args[0];
  String storeName=args[1];
  String mgmtPath=args[2];
  String filePath=args[3];
  String clusterStr=FileUtils.readFileToString(new File(clusterXml));
  Cluster cluster=new ClusterMapper().readCluster(new StringReader(clusterStr));
  ExecutorService executor=Executors.newFixedThreadPool(10);
  HttpConnectionManager manager=new MultiThreadedHttpConnectionManager();
  HttpClient client=new HttpClient(manager);
  StoreSwapper swapper=new StoreSwapper(cluster,executor,client,mgmtPath,filePath);
  swapper.swapStoreData(storeName);
  logger.info("Swap succeeded on all nodes.");
  executor.shutdownNow();
  executor.awaitTermination(1,TimeUnit.SECONDS);
  System.exit(0);
}
