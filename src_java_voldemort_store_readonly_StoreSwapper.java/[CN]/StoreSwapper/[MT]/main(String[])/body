{
  if (args.length != 4)   Utils.croak("USAGE: cluster.xml store_name mgmtpath store_file_path");
  String clusterXml=args[0];
  String storeName=args[1];
  String mgmtPath=args[2];
  String filePath=args[3];
  String clusterStr=FileUtils.readFileToString(new File(clusterXml));
  Cluster cluster=new ClusterMapper().readCluster(new StringReader(clusterStr));
  ExecutorService executor=Executors.newFixedThreadPool(10);
  HttpConnectionManager manager=new MultiThreadedHttpConnectionManager();
  int numConnections=cluster.getNumberOfNodes() + 3;
  manager.getParams().setMaxTotalConnections(numConnections);
  manager.getParams().setMaxConnectionsPerHost(HostConfiguration.ANY_HOST_CONFIGURATION,numConnections);
  HttpClient client=new HttpClient(manager);
  client.getParams().setParameter("http.socket.timeout",3 * 60 * 60* 1000);
  StoreSwapper swapper=new StoreSwapper(cluster,executor,client,mgmtPath);
  swapper.swapStoreData(storeName,filePath);
  logger.info("Swap succeeded on all nodes.");
  executor.shutdownNow();
  executor.awaitTermination(1,TimeUnit.SECONDS);
  System.exit(0);
}
