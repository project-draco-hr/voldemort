{
  int successes=0;
  Exception exception=null;
  for (int nodeId=0; nodeId < cluster.getNumberOfNodes(); nodeId++) {
    try {
      Node node=cluster.getNodeById(nodeId);
      String url=node.getHttpUrl() + "/" + readOnlyMgmtPath;
      PostMethod post=new PostMethod(url);
      post.addParameter("operation","swap");
      String indexFile=fetchFiles.get(nodeId)[0];
      String dataFile=fetchFiles.get(nodeId)[1];
      logger.info("Swapping for node " + nodeId + " index = "+ indexFile+ ", data = "+ dataFile);
      post.addParameter("index",indexFile);
      post.addParameter("data",dataFile);
      post.addParameter("store",storeName);
      int responseCode=httpClient.executeMethod(post);
      String response=post.getStatusText();
      if (responseCode == 200)       successes++;
 else       throw new VoldemortException(response);
    }
 catch (    Exception e) {
      exception=e;
      logger.error("Exception thrown during swap operation on node " + nodeId + ": ",e);
    }
  }
  if (exception != null)   throw new VoldemortException(exception);
}
