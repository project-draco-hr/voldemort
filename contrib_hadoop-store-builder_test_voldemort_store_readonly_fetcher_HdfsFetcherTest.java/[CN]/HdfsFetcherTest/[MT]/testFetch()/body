{
  File testDirectory=TestUtils.createTempDir();
  File testFile=File.createTempFile("test",".dat",testDirectory);
  testFile.createNewFile();
  HdfsFetcher fetcher=new HdfsFetcher();
  File fetchedFile=fetcher.fetch(testDirectory.getAbsolutePath(),"storeName");
  assertNotNull(fetchedFile);
  File checkSumFile=new File(testDirectory,"blahcheckSum.txt");
  checkSumFile.createNewFile();
  fetchedFile=fetcher.fetch(testDirectory.getAbsolutePath(),"storeName");
  assertNotNull(fetchedFile);
  checkSumFile.delete();
  checkSumFile=new File(testDirectory,"adler32checkSum.txt");
  checkSumFile.createNewFile();
  fetchedFile=fetcher.fetch(testDirectory.getAbsolutePath(),"storeName");
  assertNull(fetchedFile);
  byte[] checkSumBytes=CheckSumTests.calculateCheckSum(testDirectory.listFiles(),CheckSumType.CRC32);
  DataOutputStream os=new DataOutputStream(new FileOutputStream(checkSumFile));
  os.write(checkSumBytes);
  os.close();
  fetchedFile=fetcher.fetch(testDirectory.getAbsolutePath(),"storeName");
  assertNull(fetchedFile);
  checkSumFile.delete();
  checkSumFile=new File(testDirectory,"md5checkSum.txt");
  byte[] checkSumBytes2=CheckSumTests.calculateCheckSum(testDirectory.listFiles(),CheckSumType.MD5);
  os=new DataOutputStream(new FileOutputStream(checkSumFile));
  os.write(checkSumBytes2);
  os.close();
  fetchedFile=fetcher.fetch(testDirectory.getAbsolutePath(),"storeName");
  assertNotNull(fetchedFile);
  checkSumFile.delete();
  checkSumFile=new File(testDirectory,"adler32checkSum.txt");
  byte[] checkSumBytes3=CheckSumTests.calculateCheckSum(testDirectory.listFiles(),CheckSumType.ADLER32);
  os=new DataOutputStream(new FileOutputStream(checkSumFile));
  os.write(checkSumBytes3);
  os.close();
  fetchedFile=fetcher.fetch(testDirectory.getAbsolutePath(),"storeName");
  assertNotNull(fetchedFile);
  checkSumFile.delete();
  checkSumFile=new File(testDirectory,"crc32checkSum.txt");
  byte[] checkSumBytes4=CheckSumTests.calculateCheckSum(testDirectory.listFiles(),CheckSumType.CRC32);
  os=new DataOutputStream(new FileOutputStream(checkSumFile));
  os.write(checkSumBytes4);
  os.close();
  fetchedFile=fetcher.fetch(testDirectory.getAbsolutePath(),"storeName");
  assertNotNull(fetchedFile);
  checkSumFile.delete();
}
