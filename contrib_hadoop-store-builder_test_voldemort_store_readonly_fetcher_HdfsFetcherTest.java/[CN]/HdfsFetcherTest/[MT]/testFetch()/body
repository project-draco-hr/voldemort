{
  File testSourceDirectory=TestUtils.createTempDir();
  File testDestinationDirectory=TestUtils.createTempDir();
  File testFile=File.createTempFile("test",".dat",testSourceDirectory);
  testFile.createNewFile();
  HdfsFetcher fetcher=new HdfsFetcher();
  File fetchedFile=fetcher.fetch(testSourceDirectory.getAbsolutePath(),testDestinationDirectory.getAbsolutePath() + "1");
  assertNotNull(fetchedFile);
  File checkSumFile=new File(testSourceDirectory,"blahcheckSum.txt");
  checkSumFile.createNewFile();
  fetchedFile=fetcher.fetch(testSourceDirectory.getAbsolutePath(),testDestinationDirectory.getAbsolutePath() + "2");
  assertNotNull(fetchedFile);
  checkSumFile.delete();
  checkSumFile=new File(testSourceDirectory,"adler32checkSum.txt");
  checkSumFile.createNewFile();
  fetchedFile=fetcher.fetch(testSourceDirectory.getAbsolutePath(),testDestinationDirectory.getAbsolutePath() + "3");
  assertNull(fetchedFile);
  byte[] checkSumBytes=CheckSumTests.calculateCheckSum(testSourceDirectory.listFiles(),CheckSumType.CRC32);
  FileUtils.writeByteArrayToFile(checkSumFile,checkSumBytes);
  fetchedFile=fetcher.fetch(testSourceDirectory.getAbsolutePath(),testDestinationDirectory.getAbsolutePath() + "4");
  assertNull(fetchedFile);
  checkSumFile.delete();
  checkSumFile=new File(testSourceDirectory,"md5checkSum.txt");
  byte[] checkSumBytes2=CheckSumTests.calculateCheckSum(testSourceDirectory.listFiles(),CheckSumType.MD5);
  FileUtils.writeByteArrayToFile(checkSumFile,checkSumBytes2);
  fetchedFile=fetcher.fetch(testSourceDirectory.getAbsolutePath(),testDestinationDirectory.getAbsolutePath() + "5");
  assertNotNull(fetchedFile);
  checkSumFile.delete();
  checkSumFile=new File(testSourceDirectory,"adler32checkSum.txt");
  byte[] checkSumBytes3=CheckSumTests.calculateCheckSum(testSourceDirectory.listFiles(),CheckSumType.ADLER32);
  FileUtils.writeByteArrayToFile(checkSumFile,checkSumBytes3);
  fetchedFile=fetcher.fetch(testSourceDirectory.getAbsolutePath(),testDestinationDirectory.getAbsolutePath() + "6");
  assertNotNull(fetchedFile);
  assertEquals(fetchedFile.getAbsolutePath(),testDestinationDirectory.getAbsolutePath() + "6");
  checkSumFile.delete();
  checkSumFile=new File(testSourceDirectory,"crc32checkSum.txt");
  byte[] checkSumBytes4=CheckSumTests.calculateCheckSum(testSourceDirectory.listFiles(),CheckSumType.CRC32);
  FileUtils.writeByteArrayToFile(checkSumFile,checkSumBytes4);
  fetchedFile=fetcher.fetch(testSourceDirectory.getAbsolutePath(),testDestinationDirectory.getAbsolutePath() + "7");
  assertNotNull(fetchedFile);
  assertEquals(fetchedFile.getAbsolutePath(),testDestinationDirectory.getAbsolutePath() + "7");
  checkSumFile.delete();
}
