{
  Store<byte[],byte[]> store1=server1.getStoreMap().get(storeName);
  Store<byte[],byte[]> store2=server2.getStoreMap().get(storeName);
  SerializerDefinition serDef=new SerializerDefinition("json","'string'");
  Serializer<Object> serializer=(Serializer<Object>)new DefaultSerializerFactory().getSerializer(serDef);
  for (int i=1; i < 1000; i++) {
    byte[] key=serializer.toBytes("key" + i);
    byte[] value=serializer.toBytes("value" + i);
    System.out.println("checking key:" + i);
    assertEquals("either store1 or store2 will have the key:'key-" + i + "'",true,store1.get(key).size() > 0 || store2.get(key).size() > 0);
  }
  final String newIndexDir=makeReadOnlyIndex(2000,3000);
  ReadOnlyBatchIndexHadoopSwapper indexSwapper=new ReadOnlyBatchIndexHadoopSwapper(){
    @Override public void configure(    JobConf conf){
      conf.set("voldemort.cluster.local.filePath",clusterFile);
      conf.set("voldemort.store.name",storeName);
      conf.set("source.HDFS.path",newIndexDir);
      conf.set("destination.remote.path",baseDir + File.separatorChar + (int)(Math.random() * 1000));
    }
    @Override public boolean copyRemoteFile(    String hostname,    String source,    String destination){
      System.out.println("copy Remote Files called host:" + hostname + " source:"+ source+ " destination:"+ destination);
      int i=0;
      while (i++ < 5)       try {
        FileUtils.copyFile(new File(source),new File(destination));
        if (new File(destination).exists()) {
          return true;
        }
      }
 catch (      IOException e) {
      }
      return false;
    }
  }
;
  indexSwapper.run(null);
  for (int i=1; i < 1000; i++) {
    byte[] key=serializer.toBytes("key" + i);
    byte[] value=serializer.toBytes("value" + i);
    assertEquals("store 1 get for key:" + i + " should be empty",0,store1.get(key).size());
    assertEquals("store 2 get for key:" + i + " should be empty",0,store2.get(key).size());
  }
  for (int i=2000; i < 3000; i++) {
    byte[] key=serializer.toBytes("key" + i);
    byte[] value=serializer.toBytes("value" + i);
    assertEquals("either store1 or store2 will have the key:'key-" + i + "'",true,store1.get(key).size() > 0 || store2.get(key).size() > 0);
  }
}
