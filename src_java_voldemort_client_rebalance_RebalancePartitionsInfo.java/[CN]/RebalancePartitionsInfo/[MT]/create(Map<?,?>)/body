{
  int stealerId=(Integer)map.get("stealerId");
  int donorId=(Integer)map.get("donorId");
  List<String> unbalancedStoreList=Utils.uncheckedCast(map.get("unbalancedStoreList"));
  int attempt=(Integer)map.get("attempt");
  int maxReplicas=(Integer)map.get("maxReplicas");
  boolean deletePartitions=(Boolean)map.get("deletePartitions");
  Cluster initialCluster=new ClusterMapper().readCluster(new StringReader((String)map.get("initialCluster")));
  HashMap<Integer,List<Integer>> partitionMap=Maps.newHashMap();
  for (int replicaNo=0; replicaNo <= maxReplicas; replicaNo++) {
    List<Integer> partitionList=Utils.uncheckedCast(map.get("replicaToPartitionList" + Integer.toString(replicaNo)));
    if (partitionList.size() > 0)     partitionMap.put(replicaNo,partitionList);
  }
  return new RebalancePartitionsInfo(stealerId,donorId,partitionMap,unbalancedStoreList,initialCluster,deletePartitions,attempt);
}
