{
  OptionSet options=null;
  try {
    options=parser.parse(args);
  }
 catch (  OptionException oe) {
    printUsageAndDie("Exception when parsing arguments : " + oe.getMessage());
  }
  if (options.has("help")) {
    printUsage();
    System.exit(0);
  }
  Set<String> missing=CmdUtils.missing(options,"current-cluster","current-stores");
  if (missing.size() > 0) {
    printUsageAndDie("Missing required arguments: " + Joiner.on(", ").join(missing));
  }
  if (options.has("target-stores") && !options.has("target-cluster")) {
    printUsageAndDie("target-stores specified, but target-cluster not specified.");
  }
  if (options.has("stealer-based") && options.has("donor-based")) {
    printUsageAndDie("stealer-based and donor-based are mutually exclusive options.");
  }
  return options;
}
