{
  byte[] keyBytes=null, valueBytes;
  keyBytes=new byte[key.datum().remaining()];
  key.datum().get(keyBytes);
  valueBytes=new byte[value.datum().remaining()];
  value.datum().get(valueBytes);
  ByteBuffer keyBuffer=null, valueBuffer=null;
  keyBuffer=ByteBuffer.allocate(keyBytes.length);
  keyBuffer.put(keyBytes);
  keyBuffer.rewind();
  valueBuffer=ByteBuffer.allocate(valueBytes.length);
  valueBuffer.put(valueBytes);
  valueBuffer.rewind();
  key.datum(keyBuffer);
  value.datum(valueBuffer);
  KeyValuePartitioner partitioner=new KeyValuePartitioner();
  return partitioner.getPartition(keyBytes,valueBytes,saveKeys,reducerPerBucket,storeDef,numReduceTasks,numReduceTasks);
}
