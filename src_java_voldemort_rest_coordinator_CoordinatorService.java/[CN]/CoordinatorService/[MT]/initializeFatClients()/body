{
  StoreDefinitionsMapper storeMapper=new StoreDefinitionsMapper();
  String storesXml=storeClientFactory.bootstrapMetadataWithRetries(MetadataStore.STORES_KEY);
  String clusterXml=storeClientFactory.bootstrapMetadataWithRetries(MetadataStore.CLUSTER_KEY);
  List<StoreDefinition> storeDefList=storeMapper.readStoreList(new StringReader(storesXml),false);
  this.coordinatorMetadata.setMetadata(clusterXml,storeDefList);
  Map<String,SocketStoreClientFactory> fatClientFactoryMap=readClientConfig(this.coordinatorConfig.getFatClientConfigPath(),this.coordinatorConfig.getBootstrapURLs());
  if (this.fatClientMap == null) {
    this.fatClientMap=new HashMap<String,DynamicTimeoutStoreClient<ByteArray,byte[]>>();
  }
  for (  StoreDefinition storeDef : storeDefList) {
    String storeName=storeDef.getName();
    if (fatClientFactoryMap.get(storeName) != null) {
      DynamicTimeoutStoreClient<ByteArray,byte[]> storeClient=new DynamicTimeoutStoreClient<ByteArray,byte[]>(storeName,fatClientFactoryMap.get(storeName),1,storesXml,clusterXml);
      fatClientMap.put(storeName,storeClient);
    }
  }
}
