{
  if (!hasNext())   throw new VoldemortException("Reached the end");
  try {
    ByteBuffer sizeBuffer=ByteBuffer.allocate(2 * ByteUtils.SIZE_OF_INT);
    getCurrentChunk().read(sizeBuffer,getCurrentOffsetInChunk());
    int keySize=sizeBuffer.getInt(0);
    int valueSize=sizeBuffer.getInt(ByteUtils.SIZE_OF_INT);
    ByteBuffer keyBuffer=ByteBuffer.allocate(keySize);
    getCurrentChunk().read(keyBuffer,getCurrentOffsetInChunk() + (2 * ByteUtils.SIZE_OF_INT));
    ByteBuffer valueBuffer=ByteBuffer.allocate(valueSize);
    getCurrentChunk().read(valueBuffer,getCurrentOffsetInChunk() + (2 * ByteUtils.SIZE_OF_INT) + keySize);
    updateOffset(getCurrentOffsetInChunk() + (2 * ByteUtils.SIZE_OF_INT) + keySize+ valueSize);
    return Pair.create(new ByteArray(keyBuffer.array()),Versioned.value(valueBuffer.array()));
  }
 catch (  IOException e) {
    logger.error(e);
    throw new VoldemortException(e);
  }
}
