{
  FileChannel dataFile=dataFileFor(chunk);
  try {
switch (storageFormat) {
case READONLY_V0:
case READONLY_V1:
{
        ByteBuffer sizeBuffer=ByteBuffer.allocate(4);
        dataFile.read(sizeBuffer,valueLocation);
        int valueSize=sizeBuffer.getInt(0);
        ByteBuffer valueBuffer=ByteBuffer.allocate(valueSize);
        dataFile.read(valueBuffer,valueLocation + 4);
        return valueBuffer.array();
      }
case READONLY_V2:
{
      ByteBuffer numKeyValsBuffer=ByteBuffer.allocate(1);
      dataFile.read(numKeyValsBuffer,valueLocation);
      int numKeyVal=numKeyValsBuffer.get(0) & ByteUtils.MASK_11111111;
      if (numKeyVal == 1) {
        ByteBuffer sizeBuffer=ByteBuffer.allocate(4);
        dataFile.read(sizeBuffer,valueLocation + 1);
        int keySize=sizeBuffer.getInt(0);
        sizeBuffer.clear();
        dataFile.read(sizeBuffer,valueLocation + 1 + 4+ keySize);
        int valueSize=sizeBuffer.getInt(0);
        ByteBuffer valueBuffer=ByteBuffer.allocate(valueSize);
        dataFile.read(valueBuffer,valueLocation + 1 + 4+ 4+ keySize);
        return valueBuffer.array();
      }
 else {
        int currentPosition=valueLocation + 1;
        for (int keyId=0; keyId < numKeyVal; keyId++) {
          ByteBuffer sizeBuffer=ByteBuffer.allocate(4);
          dataFile.read(sizeBuffer,currentPosition);
          int keySize=sizeBuffer.getInt(0);
          sizeBuffer.clear();
          dataFile.read(sizeBuffer,currentPosition + 4 + keySize);
          int valueSize=sizeBuffer.getInt(0);
          ByteBuffer keyBuffer=ByteBuffer.allocate(keySize);
          dataFile.read(keyBuffer,currentPosition + 4);
          if (ByteUtils.compare(keyBuffer.array(),key) == 0) {
            ByteBuffer valueBuffer=ByteBuffer.allocate(valueSize);
            dataFile.read(valueBuffer,currentPosition + 4 + 4+ keySize);
            return valueBuffer.array();
          }
 else {
            currentPosition+=4 + 4 + keySize+ valueSize;
          }
        }
        throw new VoldemortException("Could not find key " + Arrays.toString(key));
      }
    }
default :
{
    throw new VoldemortException("Storage format not supported ");
  }
}
}
 catch (IOException e) {
throw new VoldemortException(e);
}
}
