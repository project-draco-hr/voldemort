{
  FileChannel dataFile=dataFileFor(chunk);
  try {
switch (storageFormat) {
case READONLY_V0:
case READONLY_V1:
{
        ByteBuffer sizeBuffer=ByteBuffer.allocate(4);
        dataFile.read(sizeBuffer,valueLocation);
        int valueSize=sizeBuffer.getInt(0);
        ByteBuffer valueBuffer=ByteBuffer.allocate(valueSize);
        dataFile.read(valueBuffer,valueLocation + 4);
        return valueBuffer.array();
      }
case READONLY_V2:
{
      ByteBuffer sizeBuffer=ByteBuffer.allocate(4);
      dataFile.read(sizeBuffer,valueLocation);
      int keySize=sizeBuffer.getInt(0);
      sizeBuffer.clear();
      dataFile.read(sizeBuffer,valueLocation + 4 + keySize);
      int valueSize=sizeBuffer.getInt(0);
      ByteBuffer valueBuffer=ByteBuffer.allocate(valueSize);
      dataFile.read(valueBuffer,valueLocation + 4 + 4+ keySize);
      return valueBuffer.array();
    }
default :
{
    throw new VoldemortException("Storage format not supported ");
  }
}
}
 catch (IOException e) {
throw new VoldemortException(e);
}
}
