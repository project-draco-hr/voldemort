{
switch (type) {
case VOLDEMORT_V1:
    return new VoldemortNativeClientRequestFormat();
case PROTOCOL_BUFFERS:
  return new ProtoBuffClientRequestFormat();
default :
throw new IllegalArgumentException("Unknown request format type: " + type);
}
}
