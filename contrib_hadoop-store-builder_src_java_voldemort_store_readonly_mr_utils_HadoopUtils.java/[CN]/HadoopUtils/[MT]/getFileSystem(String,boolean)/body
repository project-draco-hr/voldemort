{
  FileSystem fs;
  if (isLocal) {
    fs=FileSystem.getLocal(new Configuration());
  }
 else {
    fs=new DistributedFileSystem();
    try {
      fs.initialize(new URI(hdfsUrl),new Configuration());
    }
 catch (    URISyntaxException e) {
      throw new IllegalArgumentException(e);
    }
  }
  return fs;
}
