{
  if (backupNumber < 1) {
    logger.error("Number of versions must be 1 or greater");
    return;
  }
  PathFilter filter=new PathFilter(){
    @Override public boolean accept(    Path arg0){
      return !arg0.getName().startsWith("_") && Pattern.matches(acceptRegex,arg0.getName());
    }
  }
;
  FileStatus[] statuses=fs.listStatus(directory,filter);
  if (statuses == null) {
    logger.info("No backup files found");
    return;
  }
  Arrays.sort(statuses);
  int lastIndex=statuses.length - backupNumber;
  for (int i=0; i < lastIndex; ++i) {
    logger.info("Deleting " + statuses[i].getPath());
    fs.delete(statuses[i].getPath(),true);
  }
}
