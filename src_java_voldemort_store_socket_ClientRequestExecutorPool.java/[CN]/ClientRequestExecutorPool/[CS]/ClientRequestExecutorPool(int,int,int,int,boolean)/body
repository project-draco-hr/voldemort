{
  ResourcePoolConfig config=new ResourcePoolConfig().setIsFair(true).setMaxPoolSize(maxConnectionsPerNode).setMaxInvalidAttempts(maxConnectionsPerNode).setTimeout(connectionTimeoutMs,TimeUnit.MILLISECONDS);
  this.selectorManager=new ClientSelectorManager();
  this.socketFactory=new ClientRequestExecutorResourceFactory(selectorManager,soTimeoutMs,socketBufferSize,socketKeepAlive);
  this.pool=new KeyedResourcePool<SocketDestination,ClientRequestExecutor>(socketFactory,config);
  this.checkouts=new AtomicInteger(0);
  this.waitNs=new AtomicLong(0);
  this.avgWaitNs=new AtomicLong(0);
  new Thread(this.selectorManager,"ClientSelector").start();
}
