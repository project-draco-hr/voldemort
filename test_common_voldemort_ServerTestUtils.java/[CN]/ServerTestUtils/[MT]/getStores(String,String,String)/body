{
  ConcurrentMap<String,Store<ByteArray,byte[]>> stores=new ConcurrentHashMap<String,Store<ByteArray,byte[]>>(1);
  stores.put(storeName,new InMemoryStorageEngine<ByteArray,byte[]>(storeName));
  File metadataDir=TestUtils.createTempDir();
  try {
    FileUtils.writeStringToFile(new File(metadataDir,"cluster.xml"),clusterXml);
    FileUtils.writeStringToFile(new File(metadataDir,"stores.xml"),storesXml);
    MetadataStore metadata=new MetadataStore(metadataDir,stores);
    stores.put(MetadataStore.METADATA_STORE_NAME,metadata);
    return stores;
  }
 catch (  IOException e) {
    throw new VoldemortException("Error creating metadata directory:",e);
  }
}
