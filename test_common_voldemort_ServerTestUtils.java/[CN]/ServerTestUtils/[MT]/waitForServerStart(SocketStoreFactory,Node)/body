{
  boolean success=false;
  int retries=10;
  Store<ByteArray,?,?> store=null;
  while (retries-- > 0) {
    store=ServerTestUtils.getSocketStore(socketStoreFactory,MetadataStore.METADATA_STORE_NAME,node.getSocketPort());
    try {
      store.get(new ByteArray(MetadataStore.CLUSTER_KEY.getBytes()),null);
      success=true;
    }
 catch (    UnreachableStoreException e) {
      store.close();
      store=null;
      System.out.println("UnreachableSocketStore sleeping will try again " + retries + " times.");
      try {
        Thread.sleep(1000);
      }
 catch (      InterruptedException e1) {
      }
    }
  }
  store.close();
  if (!success)   throw new RuntimeException("Failed to connect with server:" + node);
}
