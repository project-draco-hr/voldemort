{
  RoutingStrategy routing=server.getMetadataStore().getRoutingStrategy(storeName);
  RedirectingStore redirectingStore=getRedirectingStore(server0.getMetadataStore(),storeName);
  for (  Entry<ByteArray,byte[]> entry : entryMap.entrySet()) {
    List<Integer> partitions=routing.getPartitionList(entry.getKey().get());
    if (unavailablePartitions.containsAll(partitions)) {
      assertEquals("Keys for partition:" + partitions + " should not be present.",0,redirectingStore.get(entry.getKey()).size());
    }
 else     if (availablePartitions.containsAll(partitions)) {
      assertEquals("Keys for partition:" + partitions + " should be present.",1,redirectingStore.get(entry.getKey()).size());
      assertEquals("Values should match.",new String(entry.getValue()),new String(redirectingStore.get(entry.getKey()).get(0).getValue()));
    }
 else {
      fail("This case should not come for this test partitions:" + partitions);
    }
  }
}
