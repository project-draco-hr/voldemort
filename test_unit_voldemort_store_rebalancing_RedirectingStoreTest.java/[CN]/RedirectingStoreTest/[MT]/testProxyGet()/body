{
  for (int i=100; i <= 1000; i++) {
    ByteArray key=new ByteArray(ByteUtils.getBytes("" + i,"UTF-8"));
    byte[] value=ByteUtils.getBytes("value-" + i,"UTF-8");
    Store<ByteArray,byte[]> store=server1.getStoreRepository().getStorageEngine(storeName);
    store.put(key,Versioned.value(value,new VectorClock().incremented(0,System.currentTimeMillis())));
  }
  VoldemortMetadata metadata=server0.getVoldemortMetadata();
  metadata.setDonorNode(1);
  metadata.setCurrentPartitionStealList(Arrays.asList(new Integer[]{2,3}));
  RedirectingStore RedirectingStore=getRedirectingStore(metadata);
  for (int i=100; i <= 1000; i++) {
    ByteArray key=new ByteArray(ByteUtils.getBytes("" + i,"UTF-8"));
    if (metadata.getRoutingStrategy(storeName).getPartitionList(key.get()).contains(new Integer(2)) || metadata.getRoutingStrategy(storeName).getPartitionList(key.get()).contains(new Integer(3))) {
      assertEquals("proxyGet should return emptys list",0,RedirectingStore.get(key).size());
    }
  }
  metadata.setServerState(VoldemortMetadata.ServerState.REBALANCING_STEALER_STATE);
  for (int i=100; i <= 1000; i++) {
    ByteArray key=new ByteArray(ByteUtils.getBytes("" + i,"UTF-8"));
    if (metadata.getRoutingStrategy(storeName).getPartitionList(key.get()).contains(new Integer(2)) || metadata.getRoutingStrategy(storeName).getPartitionList(key.get()).contains(new Integer(3))) {
      assertEquals("proxyGet should return actual value","value-" + i,new String(RedirectingStore.get(key).get(0).getValue()));
    }
  }
}
