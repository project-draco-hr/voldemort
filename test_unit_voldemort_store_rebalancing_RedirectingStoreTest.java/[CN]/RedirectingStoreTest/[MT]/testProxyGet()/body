{
  for (int i=100; i <= 1000; i++) {
    ByteArray key=new ByteArray(ByteUtils.getBytes("" + i,"UTF-8"));
    byte[] value=ByteUtils.getBytes("value-" + i,"UTF-8");
    Store<ByteArray,byte[]> store=server1.getStoreRepository().getStorageEngine(storeName);
    store.put(key,Versioned.value(value,new VectorClock().incremented(0,System.currentTimeMillis())));
  }
  MetadataStore metadata=server0.getMetadataStore();
  RedirectingStore RedirectingStore=getRedirectingStore(metadata);
  for (int i=100; i <= 1000; i++) {
    ByteArray key=new ByteArray(ByteUtils.getBytes("" + i,"UTF-8"));
    if (metadata.getRoutingStrategy(storeName).getPartitionList(key.get()).contains(new Integer(2)) || metadata.getRoutingStrategy(storeName).getPartitionList(key.get()).contains(new Integer(3))) {
      assertEquals("proxyGet should return emptys list",0,RedirectingStore.get(key).size());
    }
  }
  adminClient.updateRemoteServerState(0,MetadataStore.VoldemortState.REBALANCING_MASTER_SERVER);
  for (int i=100; i <= 1000; i++) {
    ByteArray key=new ByteArray(ByteUtils.getBytes("" + i,"UTF-8"));
    if (metadata.getRoutingStrategy(storeName).getPartitionList(key.get()).contains(new Integer(2)) || metadata.getRoutingStrategy(storeName).getPartitionList(key.get()).contains(new Integer(3))) {
      assertEquals("proxyGet should return actual value","value-" + i,new String(RedirectingStore.get(key).get(0).getValue()));
    }
  }
}
