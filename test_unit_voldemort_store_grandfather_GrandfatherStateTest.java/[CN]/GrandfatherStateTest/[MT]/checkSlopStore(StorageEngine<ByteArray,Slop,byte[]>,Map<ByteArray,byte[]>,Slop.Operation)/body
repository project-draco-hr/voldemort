{
  int count=0;
  ClosableIterator<Pair<ByteArray,Versioned<Slop>>> iterator=null;
  try {
    iterator=slopEngine.entries();
    while (iterator.hasNext()) {
      Pair<ByteArray,Versioned<Slop>> slopStored=iterator.next();
      Slop slop=slopStored.getSecond().getValue();
      Assert.assertEquals(slop.getNodeId(),NUM_NODES - 1);
      Assert.assertEquals(slop.getStoreName(),"consistent_to_zone_store");
      Assert.assertEquals(slop.getOperation(),operation);
      if (Slop.Operation.PUT.equals(operation))       Assert.assertEquals(ByteUtils.compare(slop.getValue(),entriesMigrating.get(slop.getKey())),0);
      count++;
      slopEngine.delete(slopStored.getFirst(),slopStored.getSecond().getVersion());
    }
    Assert.assertEquals(count,entriesMigrating.size());
  }
  finally {
    if (iterator != null)     iterator.close();
  }
}
