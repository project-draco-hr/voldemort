{
  HashMap<Integer,Double> overallDistributionCount=Maps.newHashMap();
  for (  Node node : cluster.getNodes()) {
    overallDistributionCount.put(node.getId(),0.0);
  }
  int totalStores=0;
  for (  Entry<StoreDefinition,Integer> entry : uniqueStoreDefsWithCount.entrySet()) {
    HashMap<Integer,Double> nodeDistribution=generateDistribution(cluster,entry.getKey(),keys);
    for (    int nodeId : nodeDistribution.keySet()) {
      overallDistributionCount.put(nodeId,overallDistributionCount.get(nodeId) + (nodeDistribution.get(nodeId) * entry.getValue()));
    }
    totalStores+=entry.getValue();
  }
  for (  int nodeId : overallDistributionCount.keySet()) {
    overallDistributionCount.put(nodeId,overallDistributionCount.get(nodeId) / (totalStores * 100.0) * 100.0);
  }
  return overallDistributionCount;
}
