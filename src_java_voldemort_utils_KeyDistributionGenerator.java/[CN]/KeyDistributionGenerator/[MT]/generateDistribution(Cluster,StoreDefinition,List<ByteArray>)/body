{
  RoutingStrategyFactory factory=new RoutingStrategyFactory();
  RoutingStrategy strategy=factory.updateRoutingStrategy(storeDef,cluster);
  HashMap<Integer,Long> requestRouting=Maps.newHashMap();
  Long total=new Long(0);
  for (  ByteArray key : keys) {
    List<Node> nodes=strategy.routeRequest(key.get());
    for (    Node node : nodes) {
      Long count=requestRouting.get(node.getId());
      if (count == null) {
        count=new Long(0);
      }
      count++;
      requestRouting.put(node.getId(),count);
      total++;
    }
  }
  HashMap<Integer,Double> finalDistribution=Maps.newHashMap();
  for (  int nodeId : requestRouting.keySet()) {
    finalDistribution.put(nodeId,new Double((requestRouting.get(nodeId) * 100.0) / total));
  }
  return finalDistribution;
}
