{
synchronized (lock) {
    File storeDir=new File(dataDirectory,storeName);
    if (!storeDir.exists()) {
      logger.info("Creating Krati data directory '" + storeDir.getAbsolutePath() + ".");
      storeDir.mkdirs();
    }
    SegmentFactory segmentFactory=(SegmentFactory)ReflectUtils.callConstructor(factoryClass);
    return new KratiStorageEngine(storeName,segmentFactory,segmentFileSizeMB,hashLoadFactor,initLevel,storeDir);
  }
}
