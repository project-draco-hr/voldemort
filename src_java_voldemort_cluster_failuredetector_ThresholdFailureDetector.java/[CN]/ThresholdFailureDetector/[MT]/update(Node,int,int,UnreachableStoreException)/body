{
  NodeStatus nodeStatus=getNodeStatus(node);
synchronized (nodeStatus) {
    nodeStatus.setLastChecked(getConfig().getTime().getMilliseconds());
    if (nodeStatus.getLastChecked() >= nodeStatus.getStartMillis() + getConfig().getThresholdInterval()) {
      nodeStatus.setStartMillis(nodeStatus.getLastChecked());
      nodeStatus.setSuccess(successDelta);
      nodeStatus.setTotal(totalDelta);
      setAvailable(node);
    }
 else {
      nodeStatus.incrementSuccess(successDelta);
      nodeStatus.incrementTotal(totalDelta);
      int thresholdCountMinimum=getConfig().getThresholdCountMinimum();
      if (nodeStatus.getTotal() >= thresholdCountMinimum) {
        long threshold=(nodeStatus.getSuccess() * 100) / nodeStatus.getTotal();
        if (threshold >= getConfig().getThreshold())         setAvailable(node);
 else         setUnavailable(node,e);
      }
    }
    return nodeStatus.isAvailable();
  }
}
