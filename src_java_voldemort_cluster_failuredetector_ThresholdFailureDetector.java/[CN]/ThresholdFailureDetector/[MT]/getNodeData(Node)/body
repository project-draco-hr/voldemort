{
  NodeData nodeData=nodeDataMap.get(node);
  if (nodeData == null)   throw new IllegalArgumentException(node.getId() + " is not a valid node for this cluster");
  return nodeData;
}
