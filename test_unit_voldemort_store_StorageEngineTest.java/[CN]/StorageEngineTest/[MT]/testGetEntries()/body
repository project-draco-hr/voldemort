{
  StorageEngine<byte[],byte[]> engine=getStorageEngine();
  int size=20;
  List<byte[]> values=getValues(size);
  for (int i=0; i < size; i++)   engine.put(Integer.toString(i).getBytes(),new Versioned<byte[]>(values.get(i)));
  ClosableIterator<Entry<byte[],Versioned<byte[]>>> it=engine.entries();
  for (int i=0; i < size; i++) {
    if (!it.hasNext())     fail("Expected " + size + " items but found only "+ i);
    Versioned<byte[]> versioned=it.next().getValue();
    assertTrue("Found value that wasn't put!",remove(values,versioned.getValue()));
  }
  assertEquals("Failed to remove all values!",0,values.size());
  it.close();
}
