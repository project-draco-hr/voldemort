{
  Cluster cluster=new ClusterMapper().readCluster(new FileReader(propsA.getString("metadata.directory") + File.separator + "/cluster.xml"));
  Map<Integer,Store<ByteArray,byte[]>> clientMapping=Maps.newHashMap();
  VoldemortConfig voldemortConfig=new VoldemortConfig(propsA);
  StorageConfiguration conf=new BdbStorageConfiguration(voldemortConfig);
  for (  Node node : cluster.getNodes())   clientMapping.put(node.getId(),conf.getStore("test" + node.getId()));
  InconsistencyResolver<Versioned<String>> resolver=new VectorClockInconsistencyResolver<String>();
  FailureDetectorConfig config=new BasicFailureDetectorConfig(voldemortConfig.getFailureDetector(),voldemortConfig.getClientNodeBannageMs(),clientMapping);
  FailureDetector failureDetector=FailureDetectorUtils.create(config);
  Store<ByteArray,byte[]> store=new RoutedStore("test",clientMapping,cluster,ServerTestUtils.getStoreDef("test",1,1,1,1,1,RoutingStrategyType.CONSISTENT_STRATEGY),10,true,10000L,failureDetector);
  Store<String,String> serializingStore=new SerializingStore<String,String>(store,new StringSerializer(),new StringSerializer());
  Store<String,String> resolvingStore=new InconsistencyResolvingStore<String,String>(serializingStore,resolver);
  StoreClientFactory factory=new StaticStoreClientFactory(resolvingStore);
  return new DefaultStoreClient<String,String>(store.getName(),resolver,factory,1);
}
